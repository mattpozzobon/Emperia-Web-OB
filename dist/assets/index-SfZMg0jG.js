var hm=Object.defineProperty;var Fd=o=>{throw TypeError(o)};var pm=(o,n,i)=>n in o?hm(o,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[n]=i;var $=(o,n,i)=>pm(o,typeof n!="symbol"?n+"":n,i),Al=(o,n,i)=>n.has(o)||Fd("Cannot "+i);var C=(o,n,i)=>(Al(o,n,"read from private field"),i?i.call(o):n.get(o)),Wr=(o,n,i)=>n.has(o)?Fd("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(o):n.set(o,i),_i=(o,n,i,a)=>(Al(o,n,"write to private field"),a?a.call(o,i):n.set(o,i),i),fe=(o,n,i)=>(Al(o,n,"access private method"),i);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const d of l)if(d.type==="childList")for(const m of d.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function i(l){const d={};return l.integrity&&(d.integrity=l.integrity),l.referrerPolicy&&(d.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?d.credentials="include":l.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(l){if(l.ep)return;l.ep=!0;const d=i(l);fetch(l.href,d)}})();function Sf(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Il={exports:{}},fs={},Tl={exports:{}},Re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pd;function mm(){if(Pd)return Re;Pd=1;var o=Symbol.for("react.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),m=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),g=Symbol.iterator;function w(B){return B===null||typeof B!="object"?null:(B=g&&B[g]||B["@@iterator"],typeof B=="function"?B:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,P={};function k(B,b,V){this.props=B,this.context=b,this.refs=P,this.updater=V||_}k.prototype.isReactComponent={},k.prototype.setState=function(B,b){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,b,"setState")},k.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function N(){}N.prototype=k.prototype;function D(B,b,V){this.props=B,this.context=b,this.refs=P,this.updater=V||_}var T=D.prototype=new N;T.constructor=D,E(T,k.prototype),T.isPureReactComponent=!0;var A=Array.isArray,G=Object.prototype.hasOwnProperty,M={current:null},Z={key:!0,ref:!0,__self:!0,__source:!0};function de(B,b,V){var Q,ee={},K=null,oe=null;if(b!=null)for(Q in b.ref!==void 0&&(oe=b.ref),b.key!==void 0&&(K=""+b.key),b)G.call(b,Q)&&!Z.hasOwnProperty(Q)&&(ee[Q]=b[Q]);var ae=arguments.length-2;if(ae===1)ee.children=V;else if(1<ae){for(var Ce=Array(ae),Le=0;Le<ae;Le++)Ce[Le]=arguments[Le+2];ee.children=Ce}if(B&&B.defaultProps)for(Q in ae=B.defaultProps,ae)ee[Q]===void 0&&(ee[Q]=ae[Q]);return{$$typeof:o,type:B,key:K,ref:oe,props:ee,_owner:M.current}}function he(B,b){return{$$typeof:o,type:B.type,key:b,ref:B.ref,props:B.props,_owner:B._owner}}function Se(B){return typeof B=="object"&&B!==null&&B.$$typeof===o}function Ee(B){var b={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(V){return b[V]})}var _e=/\/+/g;function Y(B,b){return typeof B=="object"&&B!==null&&B.key!=null?Ee(""+B.key):b.toString(36)}function re(B,b,V,Q,ee){var K=typeof B;(K==="undefined"||K==="boolean")&&(B=null);var oe=!1;if(B===null)oe=!0;else switch(K){case"string":case"number":oe=!0;break;case"object":switch(B.$$typeof){case o:case n:oe=!0}}if(oe)return oe=B,ee=ee(oe),B=Q===""?"."+Y(oe,0):Q,A(ee)?(V="",B!=null&&(V=B.replace(_e,"$&/")+"/"),re(ee,b,V,"",function(Le){return Le})):ee!=null&&(Se(ee)&&(ee=he(ee,V+(!ee.key||oe&&oe.key===ee.key?"":(""+ee.key).replace(_e,"$&/")+"/")+B)),b.push(ee)),1;if(oe=0,Q=Q===""?".":Q+":",A(B))for(var ae=0;ae<B.length;ae++){K=B[ae];var Ce=Q+Y(K,ae);oe+=re(K,b,V,Ce,ee)}else if(Ce=w(B),typeof Ce=="function")for(B=Ce.call(B),ae=0;!(K=B.next()).done;)K=K.value,Ce=Q+Y(K,ae++),oe+=re(K,b,V,Ce,ee);else if(K==="object")throw b=String(B),Error("Objects are not valid as a React child (found: "+(b==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":b)+"). If you meant to render a collection of children, use an array instead.");return oe}function ve(B,b,V){if(B==null)return B;var Q=[],ee=0;return re(B,Q,"","",function(K){return b.call(V,K,ee++)}),Q}function ge(B){if(B._status===-1){var b=B._result;b=b(),b.then(function(V){(B._status===0||B._status===-1)&&(B._status=1,B._result=V)},function(V){(B._status===0||B._status===-1)&&(B._status=2,B._result=V)}),B._status===-1&&(B._status=0,B._result=b)}if(B._status===1)return B._result.default;throw B._result}var ie={current:null},X={transition:null},ue={ReactCurrentDispatcher:ie,ReactCurrentBatchConfig:X,ReactCurrentOwner:M};function te(){throw Error("act(...) is not supported in production builds of React.")}return Re.Children={map:ve,forEach:function(B,b,V){ve(B,function(){b.apply(this,arguments)},V)},count:function(B){var b=0;return ve(B,function(){b++}),b},toArray:function(B){return ve(B,function(b){return b})||[]},only:function(B){if(!Se(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},Re.Component=k,Re.Fragment=i,Re.Profiler=l,Re.PureComponent=D,Re.StrictMode=a,Re.Suspense=p,Re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ue,Re.act=te,Re.cloneElement=function(B,b,V){if(B==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+B+".");var Q=E({},B.props),ee=B.key,K=B.ref,oe=B._owner;if(b!=null){if(b.ref!==void 0&&(K=b.ref,oe=M.current),b.key!==void 0&&(ee=""+b.key),B.type&&B.type.defaultProps)var ae=B.type.defaultProps;for(Ce in b)G.call(b,Ce)&&!Z.hasOwnProperty(Ce)&&(Q[Ce]=b[Ce]===void 0&&ae!==void 0?ae[Ce]:b[Ce])}var Ce=arguments.length-2;if(Ce===1)Q.children=V;else if(1<Ce){ae=Array(Ce);for(var Le=0;Le<Ce;Le++)ae[Le]=arguments[Le+2];Q.children=ae}return{$$typeof:o,type:B.type,key:ee,ref:K,props:Q,_owner:oe}},Re.createContext=function(B){return B={$$typeof:m,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},B.Provider={$$typeof:d,_context:B},B.Consumer=B},Re.createElement=de,Re.createFactory=function(B){var b=de.bind(null,B);return b.type=B,b},Re.createRef=function(){return{current:null}},Re.forwardRef=function(B){return{$$typeof:h,render:B}},Re.isValidElement=Se,Re.lazy=function(B){return{$$typeof:S,_payload:{_status:-1,_result:B},_init:ge}},Re.memo=function(B,b){return{$$typeof:v,type:B,compare:b===void 0?null:b}},Re.startTransition=function(B){var b=X.transition;X.transition={};try{B()}finally{X.transition=b}},Re.unstable_act=te,Re.useCallback=function(B,b){return ie.current.useCallback(B,b)},Re.useContext=function(B){return ie.current.useContext(B)},Re.useDebugValue=function(){},Re.useDeferredValue=function(B){return ie.current.useDeferredValue(B)},Re.useEffect=function(B,b){return ie.current.useEffect(B,b)},Re.useId=function(){return ie.current.useId()},Re.useImperativeHandle=function(B,b,V){return ie.current.useImperativeHandle(B,b,V)},Re.useInsertionEffect=function(B,b){return ie.current.useInsertionEffect(B,b)},Re.useLayoutEffect=function(B,b){return ie.current.useLayoutEffect(B,b)},Re.useMemo=function(B,b){return ie.current.useMemo(B,b)},Re.useReducer=function(B,b,V){return ie.current.useReducer(B,b,V)},Re.useRef=function(B){return ie.current.useRef(B)},Re.useState=function(B){return ie.current.useState(B)},Re.useSyncExternalStore=function(B,b,V){return ie.current.useSyncExternalStore(B,b,V)},Re.useTransition=function(){return ie.current.useTransition()},Re.version="18.3.1",Re}var Md;function sc(){return Md||(Md=1,Tl.exports=mm()),Tl.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rd;function gm(){if(Rd)return fs;Rd=1;var o=sc(),n=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,l=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function m(h,p,v){var S,g={},w=null,_=null;v!==void 0&&(w=""+v),p.key!==void 0&&(w=""+p.key),p.ref!==void 0&&(_=p.ref);for(S in p)a.call(p,S)&&!d.hasOwnProperty(S)&&(g[S]=p[S]);if(h&&h.defaultProps)for(S in p=h.defaultProps,p)g[S]===void 0&&(g[S]=p[S]);return{$$typeof:n,type:h,key:w,ref:_,props:g,_owner:l.current}}return fs.Fragment=i,fs.jsx=m,fs.jsxs=m,fs}var Od;function xm(){return Od||(Od=1,Il.exports=gm()),Il.exports}var u=xm(),H=sc();const hs=Sf(H);var jo={},Ll={exports:{}},en={},Bl={exports:{}},Fl={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ud;function ym(){return Ud||(Ud=1,(function(o){function n(X,ue){var te=X.length;X.push(ue);e:for(;0<te;){var B=te-1>>>1,b=X[B];if(0<l(b,ue))X[B]=ue,X[te]=b,te=B;else break e}}function i(X){return X.length===0?null:X[0]}function a(X){if(X.length===0)return null;var ue=X[0],te=X.pop();if(te!==ue){X[0]=te;e:for(var B=0,b=X.length,V=b>>>1;B<V;){var Q=2*(B+1)-1,ee=X[Q],K=Q+1,oe=X[K];if(0>l(ee,te))K<b&&0>l(oe,ee)?(X[B]=oe,X[K]=te,B=K):(X[B]=ee,X[Q]=te,B=Q);else if(K<b&&0>l(oe,te))X[B]=oe,X[K]=te,B=K;else break e}}return ue}function l(X,ue){var te=X.sortIndex-ue.sortIndex;return te!==0?te:X.id-ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;o.unstable_now=function(){return d.now()}}else{var m=Date,h=m.now();o.unstable_now=function(){return m.now()-h}}var p=[],v=[],S=1,g=null,w=3,_=!1,E=!1,P=!1,k=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(X){for(var ue=i(v);ue!==null;){if(ue.callback===null)a(v);else if(ue.startTime<=X)a(v),ue.sortIndex=ue.expirationTime,n(p,ue);else break;ue=i(v)}}function A(X){if(P=!1,T(X),!E)if(i(p)!==null)E=!0,ge(G);else{var ue=i(v);ue!==null&&ie(A,ue.startTime-X)}}function G(X,ue){E=!1,P&&(P=!1,N(de),de=-1),_=!0;var te=w;try{for(T(ue),g=i(p);g!==null&&(!(g.expirationTime>ue)||X&&!Ee());){var B=g.callback;if(typeof B=="function"){g.callback=null,w=g.priorityLevel;var b=B(g.expirationTime<=ue);ue=o.unstable_now(),typeof b=="function"?g.callback=b:g===i(p)&&a(p),T(ue)}else a(p);g=i(p)}if(g!==null)var V=!0;else{var Q=i(v);Q!==null&&ie(A,Q.startTime-ue),V=!1}return V}finally{g=null,w=te,_=!1}}var M=!1,Z=null,de=-1,he=5,Se=-1;function Ee(){return!(o.unstable_now()-Se<he)}function _e(){if(Z!==null){var X=o.unstable_now();Se=X;var ue=!0;try{ue=Z(!0,X)}finally{ue?Y():(M=!1,Z=null)}}else M=!1}var Y;if(typeof D=="function")Y=function(){D(_e)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,ve=re.port2;re.port1.onmessage=_e,Y=function(){ve.postMessage(null)}}else Y=function(){k(_e,0)};function ge(X){Z=X,M||(M=!0,Y())}function ie(X,ue){de=k(function(){X(o.unstable_now())},ue)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(X){X.callback=null},o.unstable_continueExecution=function(){E||_||(E=!0,ge(G))},o.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):he=0<X?Math.floor(1e3/X):5},o.unstable_getCurrentPriorityLevel=function(){return w},o.unstable_getFirstCallbackNode=function(){return i(p)},o.unstable_next=function(X){switch(w){case 1:case 2:case 3:var ue=3;break;default:ue=w}var te=w;w=ue;try{return X()}finally{w=te}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(X,ue){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var te=w;w=X;try{return ue()}finally{w=te}},o.unstable_scheduleCallback=function(X,ue,te){var B=o.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?B+te:B):te=B,X){case 1:var b=-1;break;case 2:b=250;break;case 5:b=1073741823;break;case 4:b=1e4;break;default:b=5e3}return b=te+b,X={id:S++,callback:ue,priorityLevel:X,startTime:te,expirationTime:b,sortIndex:-1},te>B?(X.sortIndex=te,n(v,X),i(p)===null&&X===i(v)&&(P?(N(de),de=-1):P=!0,ie(A,te-B))):(X.sortIndex=b,n(p,X),E||_||(E=!0,ge(G))),X},o.unstable_shouldYield=Ee,o.unstable_wrapCallback=function(X){var ue=w;return function(){var te=w;w=ue;try{return X.apply(this,arguments)}finally{w=te}}}})(Fl)),Fl}var zd;function vm(){return zd||(zd=1,Bl.exports=ym()),Bl.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hd;function wm(){if(Hd)return en;Hd=1;var o=sc(),n=vm();function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,l={};function d(e,t){m(e,t),m(e+"Capture",t)}function m(e,t){for(l[e]=t,e=0;e<t.length;e++)a.add(t[e])}var h=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p=Object.prototype.hasOwnProperty,v=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,S={},g={};function w(e){return p.call(g,e)?!0:p.call(S,e)?!1:v.test(e)?g[e]=!0:(S[e]=!0,!1)}function _(e,t,r,s){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function E(e,t,r,s){if(t===null||typeof t>"u"||_(e,t,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function P(e,t,r,s,c,f,x){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=c,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=f,this.removeEmptyString=x}var k={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){k[e]=new P(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];k[t]=new P(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){k[e]=new P(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){k[e]=new P(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){k[e]=new P(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){k[e]=new P(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){k[e]=new P(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){k[e]=new P(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){k[e]=new P(e,5,!1,e.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function D(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(N,D);k[t]=new P(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(N,D);k[t]=new P(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(N,D);k[t]=new P(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){k[e]=new P(e,1,!1,e.toLowerCase(),null,!1,!1)}),k.xlinkHref=new P("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){k[e]=new P(e,1,!1,e.toLowerCase(),null,!0,!0)});function T(e,t,r,s){var c=k.hasOwnProperty(t)?k[t]:null;(c!==null?c.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(E(t,r,c,s)&&(r=null),s||c===null?w(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):c.mustUseProperty?e[c.propertyName]=r===null?c.type===3?!1:"":r:(t=c.attributeName,s=c.attributeNamespace,r===null?e.removeAttribute(t):(c=c.type,r=c===3||c===4&&r===!0?"":""+r,s?e.setAttributeNS(s,t,r):e.setAttribute(t,r))))}var A=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,G=Symbol.for("react.element"),M=Symbol.for("react.portal"),Z=Symbol.for("react.fragment"),de=Symbol.for("react.strict_mode"),he=Symbol.for("react.profiler"),Se=Symbol.for("react.provider"),Ee=Symbol.for("react.context"),_e=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),re=Symbol.for("react.suspense_list"),ve=Symbol.for("react.memo"),ge=Symbol.for("react.lazy"),ie=Symbol.for("react.offscreen"),X=Symbol.iterator;function ue(e){return e===null||typeof e!="object"?null:(e=X&&e[X]||e["@@iterator"],typeof e=="function"?e:null)}var te=Object.assign,B;function b(e){if(B===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);B=t&&t[1]||""}return`
`+B+e}var V=!1;function Q(e,t){if(!e||V)return"";V=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(z){var s=z}Reflect.construct(e,[],t)}else{try{t.call()}catch(z){s=z}e.call(t.prototype)}else{try{throw Error()}catch(z){s=z}e()}}catch(z){if(z&&s&&typeof z.stack=="string"){for(var c=z.stack.split(`
`),f=s.stack.split(`
`),x=c.length-1,j=f.length-1;1<=x&&0<=j&&c[x]!==f[j];)j--;for(;1<=x&&0<=j;x--,j--)if(c[x]!==f[j]){if(x!==1||j!==1)do if(x--,j--,0>j||c[x]!==f[j]){var L=`
`+c[x].replace(" at new "," at ");return e.displayName&&L.includes("<anonymous>")&&(L=L.replace("<anonymous>",e.displayName)),L}while(1<=x&&0<=j);break}}}finally{V=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?b(e):""}function ee(e){switch(e.tag){case 5:return b(e.type);case 16:return b("Lazy");case 13:return b("Suspense");case 19:return b("SuspenseList");case 0:case 2:case 15:return e=Q(e.type,!1),e;case 11:return e=Q(e.type.render,!1),e;case 1:return e=Q(e.type,!0),e;default:return""}}function K(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Z:return"Fragment";case M:return"Portal";case he:return"Profiler";case de:return"StrictMode";case Y:return"Suspense";case re:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ee:return(e.displayName||"Context")+".Consumer";case Se:return(e._context.displayName||"Context")+".Provider";case _e:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ve:return t=e.displayName||null,t!==null?t:K(e.type)||"Memo";case ge:t=e._payload,e=e._init;try{return K(e(t))}catch{}}return null}function oe(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return K(t);case 8:return t===de?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ae(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ce(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Le(e){var t=Ce(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var c=r.get,f=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(x){s=""+x,f.call(this,x)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(x){s=""+x},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function yt(e){e._valueTracker||(e._valueTracker=Le(e))}function St(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),s="";return e&&(s=Ce(e)?e.checked?"true":"false":e.value),e=s,e!==r?(t.setValue(e),!0):!1}function vt(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Fe(e,t){var r=t.checked;return te({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function y(e,t){var r=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;r=ae(t.value!=null?t.value:r),e._wrapperState={initialChecked:s,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Ue(e,t){t=t.checked,t!=null&&T(e,"checked",t,!1)}function Et(e,t){Ue(e,t);var r=ae(t.value),s=t.type;if(r!=null)s==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ft(e,t.type,r):t.hasOwnProperty("defaultValue")&&Ft(e,t.type,ae(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Bt(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Ft(e,t,r){(t!=="number"||vt(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var ht=Array.isArray;function lt(e,t,r,s){if(e=e.options,t){t={};for(var c=0;c<r.length;c++)t["$"+r[c]]=!0;for(r=0;r<e.length;r++)c=t.hasOwnProperty("$"+e[r].value),e[r].selected!==c&&(e[r].selected=c),c&&s&&(e[r].defaultSelected=!0)}else{for(r=""+ae(r),t=null,c=0;c<e.length;c++){if(e[c].value===r){e[c].selected=!0,s&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function nr(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(i(91));return te({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function rr(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(i(92));if(ht(r)){if(1<r.length)throw Error(i(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ae(r)}}function Dr(e,t){var r=ae(t.value),s=ae(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),s!=null&&(e.defaultValue=""+s)}function ir(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function gn(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xn(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?gn(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var jn,An=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,s,c){MSApp.execUnsafeLocalFunction(function(){return e(t,r,s,c)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(jn=jn||document.createElement("div"),jn.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=jn.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function sr(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var jr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bs=["Webkit","ms","Moz","O"];Object.keys(jr).forEach(function(e){bs.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),jr[t]=jr[e]})});function le(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||jr.hasOwnProperty(e)&&jr[e]?(""+t).trim():t+"px"}function Ae(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var s=r.indexOf("--")===0,c=le(r,t[r],s);r==="float"&&(r="cssFloat"),s?e.setProperty(r,c):e[r]=c}}var Ge=te({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function et(e,t){if(t){if(Ge[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(i(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(i(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(t.style!=null&&typeof t.style!="object")throw Error(i(62))}}function He(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var We=null;function rt(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Pt=null,Xe=null,Ke=null;function Ze(e){if(e=Zi(e)){if(typeof Pt!="function")throw Error(i(280));var t=e.stateNode;t&&(t=$s(t),Pt(e.stateNode,e.type,t))}}function Ne(e){Xe?Ke?Ke.push(e):Ke=[e]:Xe=e}function Me(){if(Xe){var e=Xe,t=Ke;if(Ke=Xe=null,Ze(e),t)for(e=0;e<t.length;e++)Ze(t[e])}}function it(e,t){return e(t)}function Qe(){}var Ye=!1;function tt(e,t,r){if(Ye)return e(t,r);Ye=!0;try{return it(e,t,r)}finally{Ye=!1,(Xe!==null||Ke!==null)&&(Qe(),Me())}}function qe(e,t){var r=e.stateNode;if(r===null)return null;var s=$s(r);if(s===null)return null;r=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(i(231,t,typeof r));return r}var Mt=!1;if(h)try{var Rt={};Object.defineProperty(Rt,"passive",{get:function(){Mt=!0}}),window.addEventListener("test",Rt,Rt),window.removeEventListener("test",Rt,Rt)}catch{Mt=!1}function mt(e,t,r,s,c,f,x,j,L){var z=Array.prototype.slice.call(arguments,3);try{t.apply(r,z)}catch(J){this.onError(J)}}var gt=!1,At=null,Gt=!1,Xt=null,In={onError:function(e){gt=!0,At=e}};function Ar(e,t,r,s,c,f,x,j,L){gt=!1,At=null,mt.apply(In,arguments)}function ei(e,t,r,s,c,f,x,j,L){if(Ar.apply(this,arguments),gt){if(gt){var z=At;gt=!1,At=null}else throw Error(i(198));Gt||(Gt=!0,Xt=z)}}function It(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Tn(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ir(e){if(It(e)!==e)throw Error(i(188))}function yn(e){var t=e.alternate;if(!t){if(t=It(e),t===null)throw Error(i(188));return t!==e?null:e}for(var r=e,s=t;;){var c=r.return;if(c===null)break;var f=c.alternate;if(f===null){if(s=c.return,s!==null){r=s;continue}break}if(c.child===f.child){for(f=c.child;f;){if(f===r)return Ir(c),e;if(f===s)return Ir(c),t;f=f.sibling}throw Error(i(188))}if(r.return!==s.return)r=c,s=f;else{for(var x=!1,j=c.child;j;){if(j===r){x=!0,r=c,s=f;break}if(j===s){x=!0,s=c,r=f;break}j=j.sibling}if(!x){for(j=f.child;j;){if(j===r){x=!0,r=f,s=c;break}if(j===s){x=!0,s=f,r=c;break}j=j.sibling}if(!x)throw Error(i(189))}}if(r.alternate!==s)throw Error(i(190))}if(r.tag!==3)throw Error(i(188));return r.stateNode.current===r?e:t}function wt(e){return e=yn(e),e!==null?Ln(e):null}function Ln(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Ln(e);if(t!==null)return t;e=e.sibling}return null}var Tr=n.unstable_scheduleCallback,or=n.unstable_cancelCallback,ks=n.unstable_shouldYield,Ti=n.unstable_requestPaint,ct=n.unstable_now,Ss=n.unstable_getCurrentPriorityLevel,vn=n.unstable_ImmediatePriority,ti=n.unstable_UserBlockingPriority,Lr=n.unstable_NormalPriority,Nh=n.unstable_LowPriority,dc=n.unstable_IdlePriority,_s=null,Bn=null;function Dh(e){if(Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(_s,e,void 0,(e.current.flags&128)===128)}catch{}}var wn=Math.clz32?Math.clz32:Ih,jh=Math.log,Ah=Math.LN2;function Ih(e){return e>>>=0,e===0?32:31-(jh(e)/Ah|0)|0}var Cs=64,Es=4194304;function Li(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ns(e,t){var r=e.pendingLanes;if(r===0)return 0;var s=0,c=e.suspendedLanes,f=e.pingedLanes,x=r&268435455;if(x!==0){var j=x&~c;j!==0?s=Li(j):(f&=x,f!==0&&(s=Li(f)))}else x=r&~c,x!==0?s=Li(x):f!==0&&(s=Li(f));if(s===0)return 0;if(t!==0&&t!==s&&(t&c)===0&&(c=s&-s,f=t&-t,c>=f||c===16&&(f&4194240)!==0))return t;if((s&4)!==0&&(s|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)r=31-wn(t),c=1<<r,s|=e[r],t&=~c;return s}function Th(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Lh(e,t){for(var r=e.suspendedLanes,s=e.pingedLanes,c=e.expirationTimes,f=e.pendingLanes;0<f;){var x=31-wn(f),j=1<<x,L=c[x];L===-1?((j&r)===0||(j&s)!==0)&&(c[x]=Th(j,t)):L<=t&&(e.expiredLanes|=j),f&=~j}}function Zo(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function fc(){var e=Cs;return Cs<<=1,(Cs&4194240)===0&&(Cs=64),e}function qo(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Bi(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-wn(t),e[t]=r}function Bh(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<r;){var c=31-wn(r),f=1<<c;t[c]=0,s[c]=-1,e[c]=-1,r&=~f}}function Jo(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var s=31-wn(r),c=1<<s;c&t|e[s]&t&&(e[s]|=t),r&=~c}}var Je=0;function hc(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var pc,ea,mc,gc,xc,ta=!1,Ds=[],ar=null,lr=null,cr=null,Fi=new Map,Pi=new Map,ur=[],Fh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function yc(e,t){switch(e){case"focusin":case"focusout":ar=null;break;case"dragenter":case"dragleave":lr=null;break;case"mouseover":case"mouseout":cr=null;break;case"pointerover":case"pointerout":Fi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pi.delete(t.pointerId)}}function Mi(e,t,r,s,c,f){return e===null||e.nativeEvent!==f?(e={blockedOn:t,domEventName:r,eventSystemFlags:s,nativeEvent:f,targetContainers:[c]},t!==null&&(t=Zi(t),t!==null&&ea(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function Ph(e,t,r,s,c){switch(t){case"focusin":return ar=Mi(ar,e,t,r,s,c),!0;case"dragenter":return lr=Mi(lr,e,t,r,s,c),!0;case"mouseover":return cr=Mi(cr,e,t,r,s,c),!0;case"pointerover":var f=c.pointerId;return Fi.set(f,Mi(Fi.get(f)||null,e,t,r,s,c)),!0;case"gotpointercapture":return f=c.pointerId,Pi.set(f,Mi(Pi.get(f)||null,e,t,r,s,c)),!0}return!1}function vc(e){var t=Br(e.target);if(t!==null){var r=It(t);if(r!==null){if(t=r.tag,t===13){if(t=Tn(r),t!==null){e.blockedOn=t,xc(e.priority,function(){mc(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function js(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=ra(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var s=new r.constructor(r.type,r);We=s,r.target.dispatchEvent(s),We=null}else return t=Zi(r),t!==null&&ea(t),e.blockedOn=r,!1;t.shift()}return!0}function wc(e,t,r){js(e)&&r.delete(t)}function Mh(){ta=!1,ar!==null&&js(ar)&&(ar=null),lr!==null&&js(lr)&&(lr=null),cr!==null&&js(cr)&&(cr=null),Fi.forEach(wc),Pi.forEach(wc)}function Ri(e,t){e.blockedOn===t&&(e.blockedOn=null,ta||(ta=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Mh)))}function Oi(e){function t(c){return Ri(c,e)}if(0<Ds.length){Ri(Ds[0],e);for(var r=1;r<Ds.length;r++){var s=Ds[r];s.blockedOn===e&&(s.blockedOn=null)}}for(ar!==null&&Ri(ar,e),lr!==null&&Ri(lr,e),cr!==null&&Ri(cr,e),Fi.forEach(t),Pi.forEach(t),r=0;r<ur.length;r++)s=ur[r],s.blockedOn===e&&(s.blockedOn=null);for(;0<ur.length&&(r=ur[0],r.blockedOn===null);)vc(r),r.blockedOn===null&&ur.shift()}var ni=A.ReactCurrentBatchConfig,As=!0;function Rh(e,t,r,s){var c=Je,f=ni.transition;ni.transition=null;try{Je=1,na(e,t,r,s)}finally{Je=c,ni.transition=f}}function Oh(e,t,r,s){var c=Je,f=ni.transition;ni.transition=null;try{Je=4,na(e,t,r,s)}finally{Je=c,ni.transition=f}}function na(e,t,r,s){if(As){var c=ra(e,t,r,s);if(c===null)wa(e,t,s,Is,r),yc(e,s);else if(Ph(c,e,t,r,s))s.stopPropagation();else if(yc(e,s),t&4&&-1<Fh.indexOf(e)){for(;c!==null;){var f=Zi(c);if(f!==null&&pc(f),f=ra(e,t,r,s),f===null&&wa(e,t,s,Is,r),f===c)break;c=f}c!==null&&s.stopPropagation()}else wa(e,t,s,null,r)}}var Is=null;function ra(e,t,r,s){if(Is=null,e=rt(s),e=Br(e),e!==null)if(t=It(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Tn(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Is=e,null}function bc(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ss()){case vn:return 1;case ti:return 4;case Lr:case Nh:return 16;case dc:return 536870912;default:return 16}default:return 16}}var dr=null,ia=null,Ts=null;function kc(){if(Ts)return Ts;var e,t=ia,r=t.length,s,c="value"in dr?dr.value:dr.textContent,f=c.length;for(e=0;e<r&&t[e]===c[e];e++);var x=r-e;for(s=1;s<=x&&t[r-s]===c[f-s];s++);return Ts=c.slice(e,1<s?1-s:void 0)}function Ls(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Bs(){return!0}function Sc(){return!1}function nn(e){function t(r,s,c,f,x){this._reactName=r,this._targetInst=c,this.type=s,this.nativeEvent=f,this.target=x,this.currentTarget=null;for(var j in e)e.hasOwnProperty(j)&&(r=e[j],this[j]=r?r(f):f[j]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?Bs:Sc,this.isPropagationStopped=Sc,this}return te(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Bs)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Bs)},persist:function(){},isPersistent:Bs}),t}var ri={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sa=nn(ri),Ui=te({},ri,{view:0,detail:0}),Uh=nn(Ui),oa,aa,zi,Fs=te({},Ui,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ca,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==zi&&(zi&&e.type==="mousemove"?(oa=e.screenX-zi.screenX,aa=e.screenY-zi.screenY):aa=oa=0,zi=e),oa)},movementY:function(e){return"movementY"in e?e.movementY:aa}}),_c=nn(Fs),zh=te({},Fs,{dataTransfer:0}),Hh=nn(zh),$h=te({},Ui,{relatedTarget:0}),la=nn($h),Gh=te({},ri,{animationName:0,elapsedTime:0,pseudoElement:0}),Vh=nn(Gh),Wh=te({},ri,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Yh=nn(Wh),Xh=te({},ri,{data:0}),Cc=nn(Xh),Kh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Zh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qh(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Zh[e])?!!t[e]:!1}function ca(){return qh}var Jh=te({},Ui,{key:function(e){if(e.key){var t=Kh[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ls(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Qh[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ca,charCode:function(e){return e.type==="keypress"?Ls(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ls(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ep=nn(Jh),tp=te({},Fs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ec=nn(tp),np=te({},Ui,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ca}),rp=nn(np),ip=te({},ri,{propertyName:0,elapsedTime:0,pseudoElement:0}),sp=nn(ip),op=te({},Fs,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ap=nn(op),lp=[9,13,27,32],ua=h&&"CompositionEvent"in window,Hi=null;h&&"documentMode"in document&&(Hi=document.documentMode);var cp=h&&"TextEvent"in window&&!Hi,Nc=h&&(!ua||Hi&&8<Hi&&11>=Hi),Dc=" ",jc=!1;function Ac(e,t){switch(e){case"keyup":return lp.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ic(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ii=!1;function up(e,t){switch(e){case"compositionend":return Ic(t);case"keypress":return t.which!==32?null:(jc=!0,Dc);case"textInput":return e=t.data,e===Dc&&jc?null:e;default:return null}}function dp(e,t){if(ii)return e==="compositionend"||!ua&&Ac(e,t)?(e=kc(),Ts=ia=dr=null,ii=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Nc&&t.locale!=="ko"?null:t.data;default:return null}}var fp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!fp[e.type]:t==="textarea"}function Lc(e,t,r,s){Ne(s),t=Us(t,"onChange"),0<t.length&&(r=new sa("onChange","change",null,r,s),e.push({event:r,listeners:t}))}var $i=null,Gi=null;function hp(e){Zc(e,0)}function Ps(e){var t=ci(e);if(St(t))return e}function pp(e,t){if(e==="change")return t}var Bc=!1;if(h){var da;if(h){var fa="oninput"in document;if(!fa){var Fc=document.createElement("div");Fc.setAttribute("oninput","return;"),fa=typeof Fc.oninput=="function"}da=fa}else da=!1;Bc=da&&(!document.documentMode||9<document.documentMode)}function Pc(){$i&&($i.detachEvent("onpropertychange",Mc),Gi=$i=null)}function Mc(e){if(e.propertyName==="value"&&Ps(Gi)){var t=[];Lc(t,Gi,e,rt(e)),tt(hp,t)}}function mp(e,t,r){e==="focusin"?(Pc(),$i=t,Gi=r,$i.attachEvent("onpropertychange",Mc)):e==="focusout"&&Pc()}function gp(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ps(Gi)}function xp(e,t){if(e==="click")return Ps(t)}function yp(e,t){if(e==="input"||e==="change")return Ps(t)}function vp(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var bn=typeof Object.is=="function"?Object.is:vp;function Vi(e,t){if(bn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var c=r[s];if(!p.call(t,c)||!bn(e[c],t[c]))return!1}return!0}function Rc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Oc(e,t){var r=Rc(e);e=0;for(var s;r;){if(r.nodeType===3){if(s=e+r.textContent.length,e<=t&&s>=t)return{node:r,offset:t-e};e=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Rc(r)}}function Uc(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Uc(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function zc(){for(var e=window,t=vt();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=vt(e.document)}return t}function ha(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function wp(e){var t=zc(),r=e.focusedElem,s=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Uc(r.ownerDocument.documentElement,r)){if(s!==null&&ha(r)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var c=r.textContent.length,f=Math.min(s.start,c);s=s.end===void 0?f:Math.min(s.end,c),!e.extend&&f>s&&(c=s,s=f,f=c),c=Oc(r,f);var x=Oc(r,s);c&&x&&(e.rangeCount!==1||e.anchorNode!==c.node||e.anchorOffset!==c.offset||e.focusNode!==x.node||e.focusOffset!==x.offset)&&(t=t.createRange(),t.setStart(c.node,c.offset),e.removeAllRanges(),f>s?(e.addRange(t),e.extend(x.node,x.offset)):(t.setEnd(x.node,x.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var bp=h&&"documentMode"in document&&11>=document.documentMode,si=null,pa=null,Wi=null,ma=!1;function Hc(e,t,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ma||si==null||si!==vt(s)||(s=si,"selectionStart"in s&&ha(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Wi&&Vi(Wi,s)||(Wi=s,s=Us(pa,"onSelect"),0<s.length&&(t=new sa("onSelect","select",null,t,r),e.push({event:t,listeners:s}),t.target=si)))}function Ms(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var oi={animationend:Ms("Animation","AnimationEnd"),animationiteration:Ms("Animation","AnimationIteration"),animationstart:Ms("Animation","AnimationStart"),transitionend:Ms("Transition","TransitionEnd")},ga={},$c={};h&&($c=document.createElement("div").style,"AnimationEvent"in window||(delete oi.animationend.animation,delete oi.animationiteration.animation,delete oi.animationstart.animation),"TransitionEvent"in window||delete oi.transitionend.transition);function Rs(e){if(ga[e])return ga[e];if(!oi[e])return e;var t=oi[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in $c)return ga[e]=t[r];return e}var Gc=Rs("animationend"),Vc=Rs("animationiteration"),Wc=Rs("animationstart"),Yc=Rs("transitionend"),Xc=new Map,Kc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fr(e,t){Xc.set(e,t),d(t,[e])}for(var xa=0;xa<Kc.length;xa++){var ya=Kc[xa],kp=ya.toLowerCase(),Sp=ya[0].toUpperCase()+ya.slice(1);fr(kp,"on"+Sp)}fr(Gc,"onAnimationEnd"),fr(Vc,"onAnimationIteration"),fr(Wc,"onAnimationStart"),fr("dblclick","onDoubleClick"),fr("focusin","onFocus"),fr("focusout","onBlur"),fr(Yc,"onTransitionEnd"),m("onMouseEnter",["mouseout","mouseover"]),m("onMouseLeave",["mouseout","mouseover"]),m("onPointerEnter",["pointerout","pointerover"]),m("onPointerLeave",["pointerout","pointerover"]),d("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),d("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),d("onBeforeInput",["compositionend","keypress","textInput","paste"]),d("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_p=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yi));function Qc(e,t,r){var s=e.type||"unknown-event";e.currentTarget=r,ei(s,t,void 0,e),e.currentTarget=null}function Zc(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var s=e[r],c=s.event;s=s.listeners;e:{var f=void 0;if(t)for(var x=s.length-1;0<=x;x--){var j=s[x],L=j.instance,z=j.currentTarget;if(j=j.listener,L!==f&&c.isPropagationStopped())break e;Qc(c,j,z),f=L}else for(x=0;x<s.length;x++){if(j=s[x],L=j.instance,z=j.currentTarget,j=j.listener,L!==f&&c.isPropagationStopped())break e;Qc(c,j,z),f=L}}}if(Gt)throw e=Xt,Gt=!1,Xt=null,e}function ot(e,t){var r=t[Ea];r===void 0&&(r=t[Ea]=new Set);var s=e+"__bubble";r.has(s)||(qc(t,e,2,!1),r.add(s))}function va(e,t,r){var s=0;t&&(s|=4),qc(r,e,s,t)}var Os="_reactListening"+Math.random().toString(36).slice(2);function Xi(e){if(!e[Os]){e[Os]=!0,a.forEach(function(r){r!=="selectionchange"&&(_p.has(r)||va(r,!1,e),va(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Os]||(t[Os]=!0,va("selectionchange",!1,t))}}function qc(e,t,r,s){switch(bc(t)){case 1:var c=Rh;break;case 4:c=Oh;break;default:c=na}r=c.bind(null,t,r,e),c=void 0,!Mt||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),s?c!==void 0?e.addEventListener(t,r,{capture:!0,passive:c}):e.addEventListener(t,r,!0):c!==void 0?e.addEventListener(t,r,{passive:c}):e.addEventListener(t,r,!1)}function wa(e,t,r,s,c){var f=s;if((t&1)===0&&(t&2)===0&&s!==null)e:for(;;){if(s===null)return;var x=s.tag;if(x===3||x===4){var j=s.stateNode.containerInfo;if(j===c||j.nodeType===8&&j.parentNode===c)break;if(x===4)for(x=s.return;x!==null;){var L=x.tag;if((L===3||L===4)&&(L=x.stateNode.containerInfo,L===c||L.nodeType===8&&L.parentNode===c))return;x=x.return}for(;j!==null;){if(x=Br(j),x===null)return;if(L=x.tag,L===5||L===6){s=f=x;continue e}j=j.parentNode}}s=s.return}tt(function(){var z=f,J=rt(r),ne=[];e:{var q=Xc.get(e);if(q!==void 0){var pe=sa,ye=e;switch(e){case"keypress":if(Ls(r)===0)break e;case"keydown":case"keyup":pe=ep;break;case"focusin":ye="focus",pe=la;break;case"focusout":ye="blur",pe=la;break;case"beforeblur":case"afterblur":pe=la;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pe=_c;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pe=Hh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pe=rp;break;case Gc:case Vc:case Wc:pe=Vh;break;case Yc:pe=sp;break;case"scroll":pe=Uh;break;case"wheel":pe=ap;break;case"copy":case"cut":case"paste":pe=Yh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pe=Ec}var we=(t&4)!==0,xt=!we&&e==="scroll",R=we?q!==null?q+"Capture":null:q;we=[];for(var F=z,U;F!==null;){U=F;var se=U.stateNode;if(U.tag===5&&se!==null&&(U=se,R!==null&&(se=qe(F,R),se!=null&&we.push(Ki(F,se,U)))),xt)break;F=F.return}0<we.length&&(q=new pe(q,ye,null,r,J),ne.push({event:q,listeners:we}))}}if((t&7)===0){e:{if(q=e==="mouseover"||e==="pointerover",pe=e==="mouseout"||e==="pointerout",q&&r!==We&&(ye=r.relatedTarget||r.fromElement)&&(Br(ye)||ye[Vn]))break e;if((pe||q)&&(q=J.window===J?J:(q=J.ownerDocument)?q.defaultView||q.parentWindow:window,pe?(ye=r.relatedTarget||r.toElement,pe=z,ye=ye?Br(ye):null,ye!==null&&(xt=It(ye),ye!==xt||ye.tag!==5&&ye.tag!==6)&&(ye=null)):(pe=null,ye=z),pe!==ye)){if(we=_c,se="onMouseLeave",R="onMouseEnter",F="mouse",(e==="pointerout"||e==="pointerover")&&(we=Ec,se="onPointerLeave",R="onPointerEnter",F="pointer"),xt=pe==null?q:ci(pe),U=ye==null?q:ci(ye),q=new we(se,F+"leave",pe,r,J),q.target=xt,q.relatedTarget=U,se=null,Br(J)===z&&(we=new we(R,F+"enter",ye,r,J),we.target=U,we.relatedTarget=xt,se=we),xt=se,pe&&ye)t:{for(we=pe,R=ye,F=0,U=we;U;U=ai(U))F++;for(U=0,se=R;se;se=ai(se))U++;for(;0<F-U;)we=ai(we),F--;for(;0<U-F;)R=ai(R),U--;for(;F--;){if(we===R||R!==null&&we===R.alternate)break t;we=ai(we),R=ai(R)}we=null}else we=null;pe!==null&&Jc(ne,q,pe,we,!1),ye!==null&&xt!==null&&Jc(ne,xt,ye,we,!0)}}e:{if(q=z?ci(z):window,pe=q.nodeName&&q.nodeName.toLowerCase(),pe==="select"||pe==="input"&&q.type==="file")var ke=pp;else if(Tc(q))if(Bc)ke=yp;else{ke=gp;var De=mp}else(pe=q.nodeName)&&pe.toLowerCase()==="input"&&(q.type==="checkbox"||q.type==="radio")&&(ke=xp);if(ke&&(ke=ke(e,z))){Lc(ne,ke,r,J);break e}De&&De(e,q,z),e==="focusout"&&(De=q._wrapperState)&&De.controlled&&q.type==="number"&&Ft(q,"number",q.value)}switch(De=z?ci(z):window,e){case"focusin":(Tc(De)||De.contentEditable==="true")&&(si=De,pa=z,Wi=null);break;case"focusout":Wi=pa=si=null;break;case"mousedown":ma=!0;break;case"contextmenu":case"mouseup":case"dragend":ma=!1,Hc(ne,r,J);break;case"selectionchange":if(bp)break;case"keydown":case"keyup":Hc(ne,r,J)}var je;if(ua)e:{switch(e){case"compositionstart":var Ie="onCompositionStart";break e;case"compositionend":Ie="onCompositionEnd";break e;case"compositionupdate":Ie="onCompositionUpdate";break e}Ie=void 0}else ii?Ac(e,r)&&(Ie="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(Ie="onCompositionStart");Ie&&(Nc&&r.locale!=="ko"&&(ii||Ie!=="onCompositionStart"?Ie==="onCompositionEnd"&&ii&&(je=kc()):(dr=J,ia="value"in dr?dr.value:dr.textContent,ii=!0)),De=Us(z,Ie),0<De.length&&(Ie=new Cc(Ie,e,null,r,J),ne.push({event:Ie,listeners:De}),je?Ie.data=je:(je=Ic(r),je!==null&&(Ie.data=je)))),(je=cp?up(e,r):dp(e,r))&&(z=Us(z,"onBeforeInput"),0<z.length&&(J=new Cc("onBeforeInput","beforeinput",null,r,J),ne.push({event:J,listeners:z}),J.data=je))}Zc(ne,t)})}function Ki(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Us(e,t){for(var r=t+"Capture",s=[];e!==null;){var c=e,f=c.stateNode;c.tag===5&&f!==null&&(c=f,f=qe(e,r),f!=null&&s.unshift(Ki(e,f,c)),f=qe(e,t),f!=null&&s.push(Ki(e,f,c))),e=e.return}return s}function ai(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Jc(e,t,r,s,c){for(var f=t._reactName,x=[];r!==null&&r!==s;){var j=r,L=j.alternate,z=j.stateNode;if(L!==null&&L===s)break;j.tag===5&&z!==null&&(j=z,c?(L=qe(r,f),L!=null&&x.unshift(Ki(r,L,j))):c||(L=qe(r,f),L!=null&&x.push(Ki(r,L,j)))),r=r.return}x.length!==0&&e.push({event:t,listeners:x})}var Cp=/\r\n?/g,Ep=/\u0000|\uFFFD/g;function eu(e){return(typeof e=="string"?e:""+e).replace(Cp,`
`).replace(Ep,"")}function zs(e,t,r){if(t=eu(t),eu(e)!==t&&r)throw Error(i(425))}function Hs(){}var ba=null,ka=null;function Sa(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var _a=typeof setTimeout=="function"?setTimeout:void 0,Np=typeof clearTimeout=="function"?clearTimeout:void 0,tu=typeof Promise=="function"?Promise:void 0,Dp=typeof queueMicrotask=="function"?queueMicrotask:typeof tu<"u"?function(e){return tu.resolve(null).then(e).catch(jp)}:_a;function jp(e){setTimeout(function(){throw e})}function Ca(e,t){var r=t,s=0;do{var c=r.nextSibling;if(e.removeChild(r),c&&c.nodeType===8)if(r=c.data,r==="/$"){if(s===0){e.removeChild(c),Oi(t);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=c}while(r);Oi(t)}function hr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function nu(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var li=Math.random().toString(36).slice(2),Fn="__reactFiber$"+li,Qi="__reactProps$"+li,Vn="__reactContainer$"+li,Ea="__reactEvents$"+li,Ap="__reactListeners$"+li,Ip="__reactHandles$"+li;function Br(e){var t=e[Fn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Vn]||r[Fn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=nu(e);e!==null;){if(r=e[Fn])return r;e=nu(e)}return t}e=r,r=e.parentNode}return null}function Zi(e){return e=e[Fn]||e[Vn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ci(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(i(33))}function $s(e){return e[Qi]||null}var Na=[],ui=-1;function pr(e){return{current:e}}function at(e){0>ui||(e.current=Na[ui],Na[ui]=null,ui--)}function st(e,t){ui++,Na[ui]=e.current,e.current=t}var mr={},Ot=pr(mr),Kt=pr(!1),Fr=mr;function di(e,t){var r=e.type.contextTypes;if(!r)return mr;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var c={},f;for(f in r)c[f]=t[f];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=c),c}function Qt(e){return e=e.childContextTypes,e!=null}function Gs(){at(Kt),at(Ot)}function ru(e,t,r){if(Ot.current!==mr)throw Error(i(168));st(Ot,t),st(Kt,r)}function iu(e,t,r){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var c in s)if(!(c in t))throw Error(i(108,oe(e)||"Unknown",c));return te({},r,s)}function Vs(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||mr,Fr=Ot.current,st(Ot,e),st(Kt,Kt.current),!0}function su(e,t,r){var s=e.stateNode;if(!s)throw Error(i(169));r?(e=iu(e,t,Fr),s.__reactInternalMemoizedMergedChildContext=e,at(Kt),at(Ot),st(Ot,e)):at(Kt),st(Kt,r)}var Wn=null,Ws=!1,Da=!1;function ou(e){Wn===null?Wn=[e]:Wn.push(e)}function Tp(e){Ws=!0,ou(e)}function gr(){if(!Da&&Wn!==null){Da=!0;var e=0,t=Je;try{var r=Wn;for(Je=1;e<r.length;e++){var s=r[e];do s=s(!0);while(s!==null)}Wn=null,Ws=!1}catch(c){throw Wn!==null&&(Wn=Wn.slice(e+1)),Tr(vn,gr),c}finally{Je=t,Da=!1}}return null}var fi=[],hi=0,Ys=null,Xs=0,ln=[],cn=0,Pr=null,Yn=1,Xn="";function Mr(e,t){fi[hi++]=Xs,fi[hi++]=Ys,Ys=e,Xs=t}function au(e,t,r){ln[cn++]=Yn,ln[cn++]=Xn,ln[cn++]=Pr,Pr=e;var s=Yn;e=Xn;var c=32-wn(s)-1;s&=~(1<<c),r+=1;var f=32-wn(t)+c;if(30<f){var x=c-c%5;f=(s&(1<<x)-1).toString(32),s>>=x,c-=x,Yn=1<<32-wn(t)+c|r<<c|s,Xn=f+e}else Yn=1<<f|r<<c|s,Xn=e}function ja(e){e.return!==null&&(Mr(e,1),au(e,1,0))}function Aa(e){for(;e===Ys;)Ys=fi[--hi],fi[hi]=null,Xs=fi[--hi],fi[hi]=null;for(;e===Pr;)Pr=ln[--cn],ln[cn]=null,Xn=ln[--cn],ln[cn]=null,Yn=ln[--cn],ln[cn]=null}var rn=null,sn=null,ut=!1,kn=null;function lu(e,t){var r=hn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function cu(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,rn=e,sn=hr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,rn=e,sn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Pr!==null?{id:Yn,overflow:Xn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=hn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,rn=e,sn=null,!0):!1;default:return!1}}function Ia(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ta(e){if(ut){var t=sn;if(t){var r=t;if(!cu(e,t)){if(Ia(e))throw Error(i(418));t=hr(r.nextSibling);var s=rn;t&&cu(e,t)?lu(s,r):(e.flags=e.flags&-4097|2,ut=!1,rn=e)}}else{if(Ia(e))throw Error(i(418));e.flags=e.flags&-4097|2,ut=!1,rn=e}}}function uu(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;rn=e}function Ks(e){if(e!==rn)return!1;if(!ut)return uu(e),ut=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Sa(e.type,e.memoizedProps)),t&&(t=sn)){if(Ia(e))throw du(),Error(i(418));for(;t;)lu(e,t),t=hr(t.nextSibling)}if(uu(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){sn=hr(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}sn=null}}else sn=rn?hr(e.stateNode.nextSibling):null;return!0}function du(){for(var e=sn;e;)e=hr(e.nextSibling)}function pi(){sn=rn=null,ut=!1}function La(e){kn===null?kn=[e]:kn.push(e)}var Lp=A.ReactCurrentBatchConfig;function qi(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(i(309));var s=r.stateNode}if(!s)throw Error(i(147,e));var c=s,f=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===f?t.ref:(t=function(x){var j=c.refs;x===null?delete j[f]:j[f]=x},t._stringRef=f,t)}if(typeof e!="string")throw Error(i(284));if(!r._owner)throw Error(i(290,e))}return e}function Qs(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function fu(e){var t=e._init;return t(e._payload)}function hu(e){function t(R,F){if(e){var U=R.deletions;U===null?(R.deletions=[F],R.flags|=16):U.push(F)}}function r(R,F){if(!e)return null;for(;F!==null;)t(R,F),F=F.sibling;return null}function s(R,F){for(R=new Map;F!==null;)F.key!==null?R.set(F.key,F):R.set(F.index,F),F=F.sibling;return R}function c(R,F){return R=_r(R,F),R.index=0,R.sibling=null,R}function f(R,F,U){return R.index=U,e?(U=R.alternate,U!==null?(U=U.index,U<F?(R.flags|=2,F):U):(R.flags|=2,F)):(R.flags|=1048576,F)}function x(R){return e&&R.alternate===null&&(R.flags|=2),R}function j(R,F,U,se){return F===null||F.tag!==6?(F=_l(U,R.mode,se),F.return=R,F):(F=c(F,U),F.return=R,F)}function L(R,F,U,se){var ke=U.type;return ke===Z?J(R,F,U.props.children,se,U.key):F!==null&&(F.elementType===ke||typeof ke=="object"&&ke!==null&&ke.$$typeof===ge&&fu(ke)===F.type)?(se=c(F,U.props),se.ref=qi(R,F,U),se.return=R,se):(se=bo(U.type,U.key,U.props,null,R.mode,se),se.ref=qi(R,F,U),se.return=R,se)}function z(R,F,U,se){return F===null||F.tag!==4||F.stateNode.containerInfo!==U.containerInfo||F.stateNode.implementation!==U.implementation?(F=Cl(U,R.mode,se),F.return=R,F):(F=c(F,U.children||[]),F.return=R,F)}function J(R,F,U,se,ke){return F===null||F.tag!==7?(F=Vr(U,R.mode,se,ke),F.return=R,F):(F=c(F,U),F.return=R,F)}function ne(R,F,U){if(typeof F=="string"&&F!==""||typeof F=="number")return F=_l(""+F,R.mode,U),F.return=R,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case G:return U=bo(F.type,F.key,F.props,null,R.mode,U),U.ref=qi(R,null,F),U.return=R,U;case M:return F=Cl(F,R.mode,U),F.return=R,F;case ge:var se=F._init;return ne(R,se(F._payload),U)}if(ht(F)||ue(F))return F=Vr(F,R.mode,U,null),F.return=R,F;Qs(R,F)}return null}function q(R,F,U,se){var ke=F!==null?F.key:null;if(typeof U=="string"&&U!==""||typeof U=="number")return ke!==null?null:j(R,F,""+U,se);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case G:return U.key===ke?L(R,F,U,se):null;case M:return U.key===ke?z(R,F,U,se):null;case ge:return ke=U._init,q(R,F,ke(U._payload),se)}if(ht(U)||ue(U))return ke!==null?null:J(R,F,U,se,null);Qs(R,U)}return null}function pe(R,F,U,se,ke){if(typeof se=="string"&&se!==""||typeof se=="number")return R=R.get(U)||null,j(F,R,""+se,ke);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case G:return R=R.get(se.key===null?U:se.key)||null,L(F,R,se,ke);case M:return R=R.get(se.key===null?U:se.key)||null,z(F,R,se,ke);case ge:var De=se._init;return pe(R,F,U,De(se._payload),ke)}if(ht(se)||ue(se))return R=R.get(U)||null,J(F,R,se,ke,null);Qs(F,se)}return null}function ye(R,F,U,se){for(var ke=null,De=null,je=F,Ie=F=0,jt=null;je!==null&&Ie<U.length;Ie++){je.index>Ie?(jt=je,je=null):jt=je.sibling;var Ve=q(R,je,U[Ie],se);if(Ve===null){je===null&&(je=jt);break}e&&je&&Ve.alternate===null&&t(R,je),F=f(Ve,F,Ie),De===null?ke=Ve:De.sibling=Ve,De=Ve,je=jt}if(Ie===U.length)return r(R,je),ut&&Mr(R,Ie),ke;if(je===null){for(;Ie<U.length;Ie++)je=ne(R,U[Ie],se),je!==null&&(F=f(je,F,Ie),De===null?ke=je:De.sibling=je,De=je);return ut&&Mr(R,Ie),ke}for(je=s(R,je);Ie<U.length;Ie++)jt=pe(je,R,Ie,U[Ie],se),jt!==null&&(e&&jt.alternate!==null&&je.delete(jt.key===null?Ie:jt.key),F=f(jt,F,Ie),De===null?ke=jt:De.sibling=jt,De=jt);return e&&je.forEach(function(Cr){return t(R,Cr)}),ut&&Mr(R,Ie),ke}function we(R,F,U,se){var ke=ue(U);if(typeof ke!="function")throw Error(i(150));if(U=ke.call(U),U==null)throw Error(i(151));for(var De=ke=null,je=F,Ie=F=0,jt=null,Ve=U.next();je!==null&&!Ve.done;Ie++,Ve=U.next()){je.index>Ie?(jt=je,je=null):jt=je.sibling;var Cr=q(R,je,Ve.value,se);if(Cr===null){je===null&&(je=jt);break}e&&je&&Cr.alternate===null&&t(R,je),F=f(Cr,F,Ie),De===null?ke=Cr:De.sibling=Cr,De=Cr,je=jt}if(Ve.done)return r(R,je),ut&&Mr(R,Ie),ke;if(je===null){for(;!Ve.done;Ie++,Ve=U.next())Ve=ne(R,Ve.value,se),Ve!==null&&(F=f(Ve,F,Ie),De===null?ke=Ve:De.sibling=Ve,De=Ve);return ut&&Mr(R,Ie),ke}for(je=s(R,je);!Ve.done;Ie++,Ve=U.next())Ve=pe(je,R,Ie,Ve.value,se),Ve!==null&&(e&&Ve.alternate!==null&&je.delete(Ve.key===null?Ie:Ve.key),F=f(Ve,F,Ie),De===null?ke=Ve:De.sibling=Ve,De=Ve);return e&&je.forEach(function(fm){return t(R,fm)}),ut&&Mr(R,Ie),ke}function xt(R,F,U,se){if(typeof U=="object"&&U!==null&&U.type===Z&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case G:e:{for(var ke=U.key,De=F;De!==null;){if(De.key===ke){if(ke=U.type,ke===Z){if(De.tag===7){r(R,De.sibling),F=c(De,U.props.children),F.return=R,R=F;break e}}else if(De.elementType===ke||typeof ke=="object"&&ke!==null&&ke.$$typeof===ge&&fu(ke)===De.type){r(R,De.sibling),F=c(De,U.props),F.ref=qi(R,De,U),F.return=R,R=F;break e}r(R,De);break}else t(R,De);De=De.sibling}U.type===Z?(F=Vr(U.props.children,R.mode,se,U.key),F.return=R,R=F):(se=bo(U.type,U.key,U.props,null,R.mode,se),se.ref=qi(R,F,U),se.return=R,R=se)}return x(R);case M:e:{for(De=U.key;F!==null;){if(F.key===De)if(F.tag===4&&F.stateNode.containerInfo===U.containerInfo&&F.stateNode.implementation===U.implementation){r(R,F.sibling),F=c(F,U.children||[]),F.return=R,R=F;break e}else{r(R,F);break}else t(R,F);F=F.sibling}F=Cl(U,R.mode,se),F.return=R,R=F}return x(R);case ge:return De=U._init,xt(R,F,De(U._payload),se)}if(ht(U))return ye(R,F,U,se);if(ue(U))return we(R,F,U,se);Qs(R,U)}return typeof U=="string"&&U!==""||typeof U=="number"?(U=""+U,F!==null&&F.tag===6?(r(R,F.sibling),F=c(F,U),F.return=R,R=F):(r(R,F),F=_l(U,R.mode,se),F.return=R,R=F),x(R)):r(R,F)}return xt}var mi=hu(!0),pu=hu(!1),Zs=pr(null),qs=null,gi=null,Ba=null;function Fa(){Ba=gi=qs=null}function Pa(e){var t=Zs.current;at(Zs),e._currentValue=t}function Ma(e,t,r){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===r)break;e=e.return}}function xi(e,t){qs=e,Ba=gi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(Zt=!0),e.firstContext=null)}function un(e){var t=e._currentValue;if(Ba!==e)if(e={context:e,memoizedValue:t,next:null},gi===null){if(qs===null)throw Error(i(308));gi=e,qs.dependencies={lanes:0,firstContext:e}}else gi=gi.next=e;return t}var Rr=null;function Ra(e){Rr===null?Rr=[e]:Rr.push(e)}function mu(e,t,r,s){var c=t.interleaved;return c===null?(r.next=r,Ra(t)):(r.next=c.next,c.next=r),t.interleaved=r,Kn(e,s)}function Kn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var xr=!1;function Oa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gu(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Qn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function yr(e,t,r){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,($e&2)!==0){var c=s.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),s.pending=t,Kn(e,r)}return c=s.interleaved,c===null?(t.next=t,Ra(s)):(t.next=c.next,c.next=t),s.interleaved=t,Kn(e,r)}function Js(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,Jo(e,r)}}function xu(e,t){var r=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var c=null,f=null;if(r=r.firstBaseUpdate,r!==null){do{var x={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};f===null?c=f=x:f=f.next=x,r=r.next}while(r!==null);f===null?c=f=t:f=f.next=t}else c=f=t;r={baseState:s.baseState,firstBaseUpdate:c,lastBaseUpdate:f,shared:s.shared,effects:s.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function eo(e,t,r,s){var c=e.updateQueue;xr=!1;var f=c.firstBaseUpdate,x=c.lastBaseUpdate,j=c.shared.pending;if(j!==null){c.shared.pending=null;var L=j,z=L.next;L.next=null,x===null?f=z:x.next=z,x=L;var J=e.alternate;J!==null&&(J=J.updateQueue,j=J.lastBaseUpdate,j!==x&&(j===null?J.firstBaseUpdate=z:j.next=z,J.lastBaseUpdate=L))}if(f!==null){var ne=c.baseState;x=0,J=z=L=null,j=f;do{var q=j.lane,pe=j.eventTime;if((s&q)===q){J!==null&&(J=J.next={eventTime:pe,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});e:{var ye=e,we=j;switch(q=t,pe=r,we.tag){case 1:if(ye=we.payload,typeof ye=="function"){ne=ye.call(pe,ne,q);break e}ne=ye;break e;case 3:ye.flags=ye.flags&-65537|128;case 0:if(ye=we.payload,q=typeof ye=="function"?ye.call(pe,ne,q):ye,q==null)break e;ne=te({},ne,q);break e;case 2:xr=!0}}j.callback!==null&&j.lane!==0&&(e.flags|=64,q=c.effects,q===null?c.effects=[j]:q.push(j))}else pe={eventTime:pe,lane:q,tag:j.tag,payload:j.payload,callback:j.callback,next:null},J===null?(z=J=pe,L=ne):J=J.next=pe,x|=q;if(j=j.next,j===null){if(j=c.shared.pending,j===null)break;q=j,j=q.next,q.next=null,c.lastBaseUpdate=q,c.shared.pending=null}}while(!0);if(J===null&&(L=ne),c.baseState=L,c.firstBaseUpdate=z,c.lastBaseUpdate=J,t=c.shared.interleaved,t!==null){c=t;do x|=c.lane,c=c.next;while(c!==t)}else f===null&&(c.shared.lanes=0);zr|=x,e.lanes=x,e.memoizedState=ne}}function yu(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],c=s.callback;if(c!==null){if(s.callback=null,s=r,typeof c!="function")throw Error(i(191,c));c.call(s)}}}var Ji={},Pn=pr(Ji),es=pr(Ji),ts=pr(Ji);function Or(e){if(e===Ji)throw Error(i(174));return e}function Ua(e,t){switch(st(ts,t),st(es,e),st(Pn,Ji),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:xn(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=xn(t,e)}at(Pn),st(Pn,t)}function yi(){at(Pn),at(es),at(ts)}function vu(e){Or(ts.current);var t=Or(Pn.current),r=xn(t,e.type);t!==r&&(st(es,e),st(Pn,r))}function za(e){es.current===e&&(at(Pn),at(es))}var dt=pr(0);function to(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ha=[];function $a(){for(var e=0;e<Ha.length;e++)Ha[e]._workInProgressVersionPrimary=null;Ha.length=0}var no=A.ReactCurrentDispatcher,Ga=A.ReactCurrentBatchConfig,Ur=0,ft=null,_t=null,Nt=null,ro=!1,ns=!1,rs=0,Bp=0;function Ut(){throw Error(i(321))}function Va(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!bn(e[r],t[r]))return!1;return!0}function Wa(e,t,r,s,c,f){if(Ur=f,ft=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,no.current=e===null||e.memoizedState===null?Rp:Op,e=r(s,c),ns){f=0;do{if(ns=!1,rs=0,25<=f)throw Error(i(301));f+=1,Nt=_t=null,t.updateQueue=null,no.current=Up,e=r(s,c)}while(ns)}if(no.current=oo,t=_t!==null&&_t.next!==null,Ur=0,Nt=_t=ft=null,ro=!1,t)throw Error(i(300));return e}function Ya(){var e=rs!==0;return rs=0,e}function Mn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nt===null?ft.memoizedState=Nt=e:Nt=Nt.next=e,Nt}function dn(){if(_t===null){var e=ft.alternate;e=e!==null?e.memoizedState:null}else e=_t.next;var t=Nt===null?ft.memoizedState:Nt.next;if(t!==null)Nt=t,_t=e;else{if(e===null)throw Error(i(310));_t=e,e={memoizedState:_t.memoizedState,baseState:_t.baseState,baseQueue:_t.baseQueue,queue:_t.queue,next:null},Nt===null?ft.memoizedState=Nt=e:Nt=Nt.next=e}return Nt}function is(e,t){return typeof t=="function"?t(e):t}function Xa(e){var t=dn(),r=t.queue;if(r===null)throw Error(i(311));r.lastRenderedReducer=e;var s=_t,c=s.baseQueue,f=r.pending;if(f!==null){if(c!==null){var x=c.next;c.next=f.next,f.next=x}s.baseQueue=c=f,r.pending=null}if(c!==null){f=c.next,s=s.baseState;var j=x=null,L=null,z=f;do{var J=z.lane;if((Ur&J)===J)L!==null&&(L=L.next={lane:0,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null}),s=z.hasEagerState?z.eagerState:e(s,z.action);else{var ne={lane:J,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null};L===null?(j=L=ne,x=s):L=L.next=ne,ft.lanes|=J,zr|=J}z=z.next}while(z!==null&&z!==f);L===null?x=s:L.next=j,bn(s,t.memoizedState)||(Zt=!0),t.memoizedState=s,t.baseState=x,t.baseQueue=L,r.lastRenderedState=s}if(e=r.interleaved,e!==null){c=e;do f=c.lane,ft.lanes|=f,zr|=f,c=c.next;while(c!==e)}else c===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ka(e){var t=dn(),r=t.queue;if(r===null)throw Error(i(311));r.lastRenderedReducer=e;var s=r.dispatch,c=r.pending,f=t.memoizedState;if(c!==null){r.pending=null;var x=c=c.next;do f=e(f,x.action),x=x.next;while(x!==c);bn(f,t.memoizedState)||(Zt=!0),t.memoizedState=f,t.baseQueue===null&&(t.baseState=f),r.lastRenderedState=f}return[f,s]}function wu(){}function bu(e,t){var r=ft,s=dn(),c=t(),f=!bn(s.memoizedState,c);if(f&&(s.memoizedState=c,Zt=!0),s=s.queue,Qa(_u.bind(null,r,s,e),[e]),s.getSnapshot!==t||f||Nt!==null&&Nt.memoizedState.tag&1){if(r.flags|=2048,ss(9,Su.bind(null,r,s,c,t),void 0,null),Dt===null)throw Error(i(349));(Ur&30)!==0||ku(r,t,c)}return c}function ku(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ft.updateQueue,t===null?(t={lastEffect:null,stores:null},ft.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Su(e,t,r,s){t.value=r,t.getSnapshot=s,Cu(t)&&Eu(e)}function _u(e,t,r){return r(function(){Cu(t)&&Eu(e)})}function Cu(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!bn(e,r)}catch{return!0}}function Eu(e){var t=Kn(e,1);t!==null&&En(t,e,1,-1)}function Nu(e){var t=Mn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:is,lastRenderedState:e},t.queue=e,e=e.dispatch=Mp.bind(null,ft,e),[t.memoizedState,e]}function ss(e,t,r,s){return e={tag:e,create:t,destroy:r,deps:s,next:null},t=ft.updateQueue,t===null?(t={lastEffect:null,stores:null},ft.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(s=r.next,r.next=e,e.next=s,t.lastEffect=e)),e}function Du(){return dn().memoizedState}function io(e,t,r,s){var c=Mn();ft.flags|=e,c.memoizedState=ss(1|t,r,void 0,s===void 0?null:s)}function so(e,t,r,s){var c=dn();s=s===void 0?null:s;var f=void 0;if(_t!==null){var x=_t.memoizedState;if(f=x.destroy,s!==null&&Va(s,x.deps)){c.memoizedState=ss(t,r,f,s);return}}ft.flags|=e,c.memoizedState=ss(1|t,r,f,s)}function ju(e,t){return io(8390656,8,e,t)}function Qa(e,t){return so(2048,8,e,t)}function Au(e,t){return so(4,2,e,t)}function Iu(e,t){return so(4,4,e,t)}function Tu(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Lu(e,t,r){return r=r!=null?r.concat([e]):null,so(4,4,Tu.bind(null,t,e),r)}function Za(){}function Bu(e,t){var r=dn();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&Va(t,s[1])?s[0]:(r.memoizedState=[e,t],e)}function Fu(e,t){var r=dn();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&Va(t,s[1])?s[0]:(e=e(),r.memoizedState=[e,t],e)}function Pu(e,t,r){return(Ur&21)===0?(e.baseState&&(e.baseState=!1,Zt=!0),e.memoizedState=r):(bn(r,t)||(r=fc(),ft.lanes|=r,zr|=r,e.baseState=!0),t)}function Fp(e,t){var r=Je;Je=r!==0&&4>r?r:4,e(!0);var s=Ga.transition;Ga.transition={};try{e(!1),t()}finally{Je=r,Ga.transition=s}}function Mu(){return dn().memoizedState}function Pp(e,t,r){var s=kr(e);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},Ru(e))Ou(t,r);else if(r=mu(e,t,r,s),r!==null){var c=Wt();En(r,e,s,c),Uu(r,t,s)}}function Mp(e,t,r){var s=kr(e),c={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ru(e))Ou(t,c);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=t.lastRenderedReducer,f!==null))try{var x=t.lastRenderedState,j=f(x,r);if(c.hasEagerState=!0,c.eagerState=j,bn(j,x)){var L=t.interleaved;L===null?(c.next=c,Ra(t)):(c.next=L.next,L.next=c),t.interleaved=c;return}}catch{}finally{}r=mu(e,t,c,s),r!==null&&(c=Wt(),En(r,e,s,c),Uu(r,t,s))}}function Ru(e){var t=e.alternate;return e===ft||t!==null&&t===ft}function Ou(e,t){ns=ro=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Uu(e,t,r){if((r&4194240)!==0){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,Jo(e,r)}}var oo={readContext:un,useCallback:Ut,useContext:Ut,useEffect:Ut,useImperativeHandle:Ut,useInsertionEffect:Ut,useLayoutEffect:Ut,useMemo:Ut,useReducer:Ut,useRef:Ut,useState:Ut,useDebugValue:Ut,useDeferredValue:Ut,useTransition:Ut,useMutableSource:Ut,useSyncExternalStore:Ut,useId:Ut,unstable_isNewReconciler:!1},Rp={readContext:un,useCallback:function(e,t){return Mn().memoizedState=[e,t===void 0?null:t],e},useContext:un,useEffect:ju,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,io(4194308,4,Tu.bind(null,t,e),r)},useLayoutEffect:function(e,t){return io(4194308,4,e,t)},useInsertionEffect:function(e,t){return io(4,2,e,t)},useMemo:function(e,t){var r=Mn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var s=Mn();return t=r!==void 0?r(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=Pp.bind(null,ft,e),[s.memoizedState,e]},useRef:function(e){var t=Mn();return e={current:e},t.memoizedState=e},useState:Nu,useDebugValue:Za,useDeferredValue:function(e){return Mn().memoizedState=e},useTransition:function(){var e=Nu(!1),t=e[0];return e=Fp.bind(null,e[1]),Mn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var s=ft,c=Mn();if(ut){if(r===void 0)throw Error(i(407));r=r()}else{if(r=t(),Dt===null)throw Error(i(349));(Ur&30)!==0||ku(s,t,r)}c.memoizedState=r;var f={value:r,getSnapshot:t};return c.queue=f,ju(_u.bind(null,s,f,e),[e]),s.flags|=2048,ss(9,Su.bind(null,s,f,r,t),void 0,null),r},useId:function(){var e=Mn(),t=Dt.identifierPrefix;if(ut){var r=Xn,s=Yn;r=(s&~(1<<32-wn(s)-1)).toString(32)+r,t=":"+t+"R"+r,r=rs++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Bp++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Op={readContext:un,useCallback:Bu,useContext:un,useEffect:Qa,useImperativeHandle:Lu,useInsertionEffect:Au,useLayoutEffect:Iu,useMemo:Fu,useReducer:Xa,useRef:Du,useState:function(){return Xa(is)},useDebugValue:Za,useDeferredValue:function(e){var t=dn();return Pu(t,_t.memoizedState,e)},useTransition:function(){var e=Xa(is)[0],t=dn().memoizedState;return[e,t]},useMutableSource:wu,useSyncExternalStore:bu,useId:Mu,unstable_isNewReconciler:!1},Up={readContext:un,useCallback:Bu,useContext:un,useEffect:Qa,useImperativeHandle:Lu,useInsertionEffect:Au,useLayoutEffect:Iu,useMemo:Fu,useReducer:Ka,useRef:Du,useState:function(){return Ka(is)},useDebugValue:Za,useDeferredValue:function(e){var t=dn();return _t===null?t.memoizedState=e:Pu(t,_t.memoizedState,e)},useTransition:function(){var e=Ka(is)[0],t=dn().memoizedState;return[e,t]},useMutableSource:wu,useSyncExternalStore:bu,useId:Mu,unstable_isNewReconciler:!1};function Sn(e,t){if(e&&e.defaultProps){t=te({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function qa(e,t,r,s){t=e.memoizedState,r=r(s,t),r=r==null?t:te({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var ao={isMounted:function(e){return(e=e._reactInternals)?It(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var s=Wt(),c=kr(e),f=Qn(s,c);f.payload=t,r!=null&&(f.callback=r),t=yr(e,f,c),t!==null&&(En(t,e,c,s),Js(t,e,c))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var s=Wt(),c=kr(e),f=Qn(s,c);f.tag=1,f.payload=t,r!=null&&(f.callback=r),t=yr(e,f,c),t!==null&&(En(t,e,c,s),Js(t,e,c))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Wt(),s=kr(e),c=Qn(r,s);c.tag=2,t!=null&&(c.callback=t),t=yr(e,c,s),t!==null&&(En(t,e,s,r),Js(t,e,s))}};function zu(e,t,r,s,c,f,x){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,f,x):t.prototype&&t.prototype.isPureReactComponent?!Vi(r,s)||!Vi(c,f):!0}function Hu(e,t,r){var s=!1,c=mr,f=t.contextType;return typeof f=="object"&&f!==null?f=un(f):(c=Qt(t)?Fr:Ot.current,s=t.contextTypes,f=(s=s!=null)?di(e,c):mr),t=new t(r,f),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ao,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=c,e.__reactInternalMemoizedMaskedChildContext=f),t}function $u(e,t,r,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,s),t.state!==e&&ao.enqueueReplaceState(t,t.state,null)}function Ja(e,t,r,s){var c=e.stateNode;c.props=r,c.state=e.memoizedState,c.refs={},Oa(e);var f=t.contextType;typeof f=="object"&&f!==null?c.context=un(f):(f=Qt(t)?Fr:Ot.current,c.context=di(e,f)),c.state=e.memoizedState,f=t.getDerivedStateFromProps,typeof f=="function"&&(qa(e,t,f,r),c.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(t=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),t!==c.state&&ao.enqueueReplaceState(c,c.state,null),eo(e,r,c,s),c.state=e.memoizedState),typeof c.componentDidMount=="function"&&(e.flags|=4194308)}function vi(e,t){try{var r="",s=t;do r+=ee(s),s=s.return;while(s);var c=r}catch(f){c=`
Error generating stack: `+f.message+`
`+f.stack}return{value:e,source:t,stack:c,digest:null}}function el(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function tl(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var zp=typeof WeakMap=="function"?WeakMap:Map;function Gu(e,t,r){r=Qn(-1,r),r.tag=3,r.payload={element:null};var s=t.value;return r.callback=function(){mo||(mo=!0,gl=s),tl(e,t)},r}function Vu(e,t,r){r=Qn(-1,r),r.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var c=t.value;r.payload=function(){return s(c)},r.callback=function(){tl(e,t)}}var f=e.stateNode;return f!==null&&typeof f.componentDidCatch=="function"&&(r.callback=function(){tl(e,t),typeof s!="function"&&(wr===null?wr=new Set([this]):wr.add(this));var x=t.stack;this.componentDidCatch(t.value,{componentStack:x!==null?x:""})}),r}function Wu(e,t,r){var s=e.pingCache;if(s===null){s=e.pingCache=new zp;var c=new Set;s.set(t,c)}else c=s.get(t),c===void 0&&(c=new Set,s.set(t,c));c.has(r)||(c.add(r),e=tm.bind(null,e,t,r),t.then(e,e))}function Yu(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Xu(e,t,r,s,c){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Qn(-1,1),t.tag=2,yr(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=c,e)}var Hp=A.ReactCurrentOwner,Zt=!1;function Vt(e,t,r,s){t.child=e===null?pu(t,null,r,s):mi(t,e.child,r,s)}function Ku(e,t,r,s,c){r=r.render;var f=t.ref;return xi(t,c),s=Wa(e,t,r,s,f,c),r=Ya(),e!==null&&!Zt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~c,Zn(e,t,c)):(ut&&r&&ja(t),t.flags|=1,Vt(e,t,s,c),t.child)}function Qu(e,t,r,s,c){if(e===null){var f=r.type;return typeof f=="function"&&!Sl(f)&&f.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=f,Zu(e,t,f,s,c)):(e=bo(r.type,null,s,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(f=e.child,(e.lanes&c)===0){var x=f.memoizedProps;if(r=r.compare,r=r!==null?r:Vi,r(x,s)&&e.ref===t.ref)return Zn(e,t,c)}return t.flags|=1,e=_r(f,s),e.ref=t.ref,e.return=t,t.child=e}function Zu(e,t,r,s,c){if(e!==null){var f=e.memoizedProps;if(Vi(f,s)&&e.ref===t.ref)if(Zt=!1,t.pendingProps=s=f,(e.lanes&c)!==0)(e.flags&131072)!==0&&(Zt=!0);else return t.lanes=e.lanes,Zn(e,t,c)}return nl(e,t,r,s,c)}function qu(e,t,r){var s=t.pendingProps,c=s.children,f=e!==null?e.memoizedState:null;if(s.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},st(bi,on),on|=r;else{if((r&1073741824)===0)return e=f!==null?f.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,st(bi,on),on|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=f!==null?f.baseLanes:r,st(bi,on),on|=s}else f!==null?(s=f.baseLanes|r,t.memoizedState=null):s=r,st(bi,on),on|=s;return Vt(e,t,c,r),t.child}function Ju(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function nl(e,t,r,s,c){var f=Qt(r)?Fr:Ot.current;return f=di(t,f),xi(t,c),r=Wa(e,t,r,s,f,c),s=Ya(),e!==null&&!Zt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~c,Zn(e,t,c)):(ut&&s&&ja(t),t.flags|=1,Vt(e,t,r,c),t.child)}function ed(e,t,r,s,c){if(Qt(r)){var f=!0;Vs(t)}else f=!1;if(xi(t,c),t.stateNode===null)co(e,t),Hu(t,r,s),Ja(t,r,s,c),s=!0;else if(e===null){var x=t.stateNode,j=t.memoizedProps;x.props=j;var L=x.context,z=r.contextType;typeof z=="object"&&z!==null?z=un(z):(z=Qt(r)?Fr:Ot.current,z=di(t,z));var J=r.getDerivedStateFromProps,ne=typeof J=="function"||typeof x.getSnapshotBeforeUpdate=="function";ne||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(j!==s||L!==z)&&$u(t,x,s,z),xr=!1;var q=t.memoizedState;x.state=q,eo(t,s,x,c),L=t.memoizedState,j!==s||q!==L||Kt.current||xr?(typeof J=="function"&&(qa(t,r,J,s),L=t.memoizedState),(j=xr||zu(t,r,j,s,q,L,z))?(ne||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(t.flags|=4194308)):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=L),x.props=s,x.state=L,x.context=z,s=j):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{x=t.stateNode,gu(e,t),j=t.memoizedProps,z=t.type===t.elementType?j:Sn(t.type,j),x.props=z,ne=t.pendingProps,q=x.context,L=r.contextType,typeof L=="object"&&L!==null?L=un(L):(L=Qt(r)?Fr:Ot.current,L=di(t,L));var pe=r.getDerivedStateFromProps;(J=typeof pe=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(j!==ne||q!==L)&&$u(t,x,s,L),xr=!1,q=t.memoizedState,x.state=q,eo(t,s,x,c);var ye=t.memoizedState;j!==ne||q!==ye||Kt.current||xr?(typeof pe=="function"&&(qa(t,r,pe,s),ye=t.memoizedState),(z=xr||zu(t,r,z,s,q,ye,L)||!1)?(J||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(s,ye,L),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(s,ye,L)),typeof x.componentDidUpdate=="function"&&(t.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof x.componentDidUpdate!="function"||j===e.memoizedProps&&q===e.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||j===e.memoizedProps&&q===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=ye),x.props=s,x.state=ye,x.context=L,s=z):(typeof x.componentDidUpdate!="function"||j===e.memoizedProps&&q===e.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||j===e.memoizedProps&&q===e.memoizedState||(t.flags|=1024),s=!1)}return rl(e,t,r,s,f,c)}function rl(e,t,r,s,c,f){Ju(e,t);var x=(t.flags&128)!==0;if(!s&&!x)return c&&su(t,r,!1),Zn(e,t,f);s=t.stateNode,Hp.current=t;var j=x&&typeof r.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&x?(t.child=mi(t,e.child,null,f),t.child=mi(t,null,j,f)):Vt(e,t,j,f),t.memoizedState=s.state,c&&su(t,r,!0),t.child}function td(e){var t=e.stateNode;t.pendingContext?ru(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ru(e,t.context,!1),Ua(e,t.containerInfo)}function nd(e,t,r,s,c){return pi(),La(c),t.flags|=256,Vt(e,t,r,s),t.child}var il={dehydrated:null,treeContext:null,retryLane:0};function sl(e){return{baseLanes:e,cachePool:null,transitions:null}}function rd(e,t,r){var s=t.pendingProps,c=dt.current,f=!1,x=(t.flags&128)!==0,j;if((j=x)||(j=e!==null&&e.memoizedState===null?!1:(c&2)!==0),j?(f=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(c|=1),st(dt,c&1),e===null)return Ta(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(x=s.children,e=s.fallback,f?(s=t.mode,f=t.child,x={mode:"hidden",children:x},(s&1)===0&&f!==null?(f.childLanes=0,f.pendingProps=x):f=ko(x,s,0,null),e=Vr(e,s,r,null),f.return=t,e.return=t,f.sibling=e,t.child=f,t.child.memoizedState=sl(r),t.memoizedState=il,e):ol(t,x));if(c=e.memoizedState,c!==null&&(j=c.dehydrated,j!==null))return $p(e,t,x,s,j,c,r);if(f){f=s.fallback,x=t.mode,c=e.child,j=c.sibling;var L={mode:"hidden",children:s.children};return(x&1)===0&&t.child!==c?(s=t.child,s.childLanes=0,s.pendingProps=L,t.deletions=null):(s=_r(c,L),s.subtreeFlags=c.subtreeFlags&14680064),j!==null?f=_r(j,f):(f=Vr(f,x,r,null),f.flags|=2),f.return=t,s.return=t,s.sibling=f,t.child=s,s=f,f=t.child,x=e.child.memoizedState,x=x===null?sl(r):{baseLanes:x.baseLanes|r,cachePool:null,transitions:x.transitions},f.memoizedState=x,f.childLanes=e.childLanes&~r,t.memoizedState=il,s}return f=e.child,e=f.sibling,s=_r(f,{mode:"visible",children:s.children}),(t.mode&1)===0&&(s.lanes=r),s.return=t,s.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=s,t.memoizedState=null,s}function ol(e,t){return t=ko({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function lo(e,t,r,s){return s!==null&&La(s),mi(t,e.child,null,r),e=ol(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function $p(e,t,r,s,c,f,x){if(r)return t.flags&256?(t.flags&=-257,s=el(Error(i(422))),lo(e,t,x,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(f=s.fallback,c=t.mode,s=ko({mode:"visible",children:s.children},c,0,null),f=Vr(f,c,x,null),f.flags|=2,s.return=t,f.return=t,s.sibling=f,t.child=s,(t.mode&1)!==0&&mi(t,e.child,null,x),t.child.memoizedState=sl(x),t.memoizedState=il,f);if((t.mode&1)===0)return lo(e,t,x,null);if(c.data==="$!"){if(s=c.nextSibling&&c.nextSibling.dataset,s)var j=s.dgst;return s=j,f=Error(i(419)),s=el(f,s,void 0),lo(e,t,x,s)}if(j=(x&e.childLanes)!==0,Zt||j){if(s=Dt,s!==null){switch(x&-x){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=(c&(s.suspendedLanes|x))!==0?0:c,c!==0&&c!==f.retryLane&&(f.retryLane=c,Kn(e,c),En(s,e,c,-1))}return kl(),s=el(Error(i(421))),lo(e,t,x,s)}return c.data==="$?"?(t.flags|=128,t.child=e.child,t=nm.bind(null,e),c._reactRetry=t,null):(e=f.treeContext,sn=hr(c.nextSibling),rn=t,ut=!0,kn=null,e!==null&&(ln[cn++]=Yn,ln[cn++]=Xn,ln[cn++]=Pr,Yn=e.id,Xn=e.overflow,Pr=t),t=ol(t,s.children),t.flags|=4096,t)}function id(e,t,r){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),Ma(e.return,t,r)}function al(e,t,r,s,c){var f=e.memoizedState;f===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:c}:(f.isBackwards=t,f.rendering=null,f.renderingStartTime=0,f.last=s,f.tail=r,f.tailMode=c)}function sd(e,t,r){var s=t.pendingProps,c=s.revealOrder,f=s.tail;if(Vt(e,t,s.children,r),s=dt.current,(s&2)!==0)s=s&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&id(e,r,t);else if(e.tag===19)id(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(st(dt,s),(t.mode&1)===0)t.memoizedState=null;else switch(c){case"forwards":for(r=t.child,c=null;r!==null;)e=r.alternate,e!==null&&to(e)===null&&(c=r),r=r.sibling;r=c,r===null?(c=t.child,t.child=null):(c=r.sibling,r.sibling=null),al(t,!1,c,r,f);break;case"backwards":for(r=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&to(e)===null){t.child=c;break}e=c.sibling,c.sibling=r,r=c,c=e}al(t,!0,r,null,f);break;case"together":al(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function co(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Zn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),zr|=t.lanes,(r&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(i(153));if(t.child!==null){for(e=t.child,r=_r(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=_r(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Gp(e,t,r){switch(t.tag){case 3:td(t),pi();break;case 5:vu(t);break;case 1:Qt(t.type)&&Vs(t);break;case 4:Ua(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,c=t.memoizedProps.value;st(Zs,s._currentValue),s._currentValue=c;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(st(dt,dt.current&1),t.flags|=128,null):(r&t.child.childLanes)!==0?rd(e,t,r):(st(dt,dt.current&1),e=Zn(e,t,r),e!==null?e.sibling:null);st(dt,dt.current&1);break;case 19:if(s=(r&t.childLanes)!==0,(e.flags&128)!==0){if(s)return sd(e,t,r);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),st(dt,dt.current),s)break;return null;case 22:case 23:return t.lanes=0,qu(e,t,r)}return Zn(e,t,r)}var od,ll,ad,ld;od=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},ll=function(){},ad=function(e,t,r,s){var c=e.memoizedProps;if(c!==s){e=t.stateNode,Or(Pn.current);var f=null;switch(r){case"input":c=Fe(e,c),s=Fe(e,s),f=[];break;case"select":c=te({},c,{value:void 0}),s=te({},s,{value:void 0}),f=[];break;case"textarea":c=nr(e,c),s=nr(e,s),f=[];break;default:typeof c.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Hs)}et(r,s);var x;r=null;for(z in c)if(!s.hasOwnProperty(z)&&c.hasOwnProperty(z)&&c[z]!=null)if(z==="style"){var j=c[z];for(x in j)j.hasOwnProperty(x)&&(r||(r={}),r[x]="")}else z!=="dangerouslySetInnerHTML"&&z!=="children"&&z!=="suppressContentEditableWarning"&&z!=="suppressHydrationWarning"&&z!=="autoFocus"&&(l.hasOwnProperty(z)?f||(f=[]):(f=f||[]).push(z,null));for(z in s){var L=s[z];if(j=c!=null?c[z]:void 0,s.hasOwnProperty(z)&&L!==j&&(L!=null||j!=null))if(z==="style")if(j){for(x in j)!j.hasOwnProperty(x)||L&&L.hasOwnProperty(x)||(r||(r={}),r[x]="");for(x in L)L.hasOwnProperty(x)&&j[x]!==L[x]&&(r||(r={}),r[x]=L[x])}else r||(f||(f=[]),f.push(z,r)),r=L;else z==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,j=j?j.__html:void 0,L!=null&&j!==L&&(f=f||[]).push(z,L)):z==="children"?typeof L!="string"&&typeof L!="number"||(f=f||[]).push(z,""+L):z!=="suppressContentEditableWarning"&&z!=="suppressHydrationWarning"&&(l.hasOwnProperty(z)?(L!=null&&z==="onScroll"&&ot("scroll",e),f||j===L||(f=[])):(f=f||[]).push(z,L))}r&&(f=f||[]).push("style",r);var z=f;(t.updateQueue=z)&&(t.flags|=4)}},ld=function(e,t,r,s){r!==s&&(t.flags|=4)};function os(e,t){if(!ut)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function zt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,s=0;if(t)for(var c=e.child;c!==null;)r|=c.lanes|c.childLanes,s|=c.subtreeFlags&14680064,s|=c.flags&14680064,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)r|=c.lanes|c.childLanes,s|=c.subtreeFlags,s|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=s,e.childLanes=r,t}function Vp(e,t,r){var s=t.pendingProps;switch(Aa(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zt(t),null;case 1:return Qt(t.type)&&Gs(),zt(t),null;case 3:return s=t.stateNode,yi(),at(Kt),at(Ot),$a(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Ks(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,kn!==null&&(vl(kn),kn=null))),ll(e,t),zt(t),null;case 5:za(t);var c=Or(ts.current);if(r=t.type,e!==null&&t.stateNode!=null)ad(e,t,r,s,c),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(i(166));return zt(t),null}if(e=Or(Pn.current),Ks(t)){s=t.stateNode,r=t.type;var f=t.memoizedProps;switch(s[Fn]=t,s[Qi]=f,e=(t.mode&1)!==0,r){case"dialog":ot("cancel",s),ot("close",s);break;case"iframe":case"object":case"embed":ot("load",s);break;case"video":case"audio":for(c=0;c<Yi.length;c++)ot(Yi[c],s);break;case"source":ot("error",s);break;case"img":case"image":case"link":ot("error",s),ot("load",s);break;case"details":ot("toggle",s);break;case"input":y(s,f),ot("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!f.multiple},ot("invalid",s);break;case"textarea":rr(s,f),ot("invalid",s)}et(r,f),c=null;for(var x in f)if(f.hasOwnProperty(x)){var j=f[x];x==="children"?typeof j=="string"?s.textContent!==j&&(f.suppressHydrationWarning!==!0&&zs(s.textContent,j,e),c=["children",j]):typeof j=="number"&&s.textContent!==""+j&&(f.suppressHydrationWarning!==!0&&zs(s.textContent,j,e),c=["children",""+j]):l.hasOwnProperty(x)&&j!=null&&x==="onScroll"&&ot("scroll",s)}switch(r){case"input":yt(s),Bt(s,f,!0);break;case"textarea":yt(s),ir(s);break;case"select":case"option":break;default:typeof f.onClick=="function"&&(s.onclick=Hs)}s=c,t.updateQueue=s,s!==null&&(t.flags|=4)}else{x=c.nodeType===9?c:c.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=gn(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=x.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=x.createElement(r,{is:s.is}):(e=x.createElement(r),r==="select"&&(x=e,s.multiple?x.multiple=!0:s.size&&(x.size=s.size))):e=x.createElementNS(e,r),e[Fn]=t,e[Qi]=s,od(e,t,!1,!1),t.stateNode=e;e:{switch(x=He(r,s),r){case"dialog":ot("cancel",e),ot("close",e),c=s;break;case"iframe":case"object":case"embed":ot("load",e),c=s;break;case"video":case"audio":for(c=0;c<Yi.length;c++)ot(Yi[c],e);c=s;break;case"source":ot("error",e),c=s;break;case"img":case"image":case"link":ot("error",e),ot("load",e),c=s;break;case"details":ot("toggle",e),c=s;break;case"input":y(e,s),c=Fe(e,s),ot("invalid",e);break;case"option":c=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},c=te({},s,{value:void 0}),ot("invalid",e);break;case"textarea":rr(e,s),c=nr(e,s),ot("invalid",e);break;default:c=s}et(r,c),j=c;for(f in j)if(j.hasOwnProperty(f)){var L=j[f];f==="style"?Ae(e,L):f==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,L!=null&&An(e,L)):f==="children"?typeof L=="string"?(r!=="textarea"||L!=="")&&sr(e,L):typeof L=="number"&&sr(e,""+L):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(l.hasOwnProperty(f)?L!=null&&f==="onScroll"&&ot("scroll",e):L!=null&&T(e,f,L,x))}switch(r){case"input":yt(e),Bt(e,s,!1);break;case"textarea":yt(e),ir(e);break;case"option":s.value!=null&&e.setAttribute("value",""+ae(s.value));break;case"select":e.multiple=!!s.multiple,f=s.value,f!=null?lt(e,!!s.multiple,f,!1):s.defaultValue!=null&&lt(e,!!s.multiple,s.defaultValue,!0);break;default:typeof c.onClick=="function"&&(e.onclick=Hs)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return zt(t),null;case 6:if(e&&t.stateNode!=null)ld(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(i(166));if(r=Or(ts.current),Or(Pn.current),Ks(t)){if(s=t.stateNode,r=t.memoizedProps,s[Fn]=t,(f=s.nodeValue!==r)&&(e=rn,e!==null))switch(e.tag){case 3:zs(s.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&zs(s.nodeValue,r,(e.mode&1)!==0)}f&&(t.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[Fn]=t,t.stateNode=s}return zt(t),null;case 13:if(at(dt),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ut&&sn!==null&&(t.mode&1)!==0&&(t.flags&128)===0)du(),pi(),t.flags|=98560,f=!1;else if(f=Ks(t),s!==null&&s.dehydrated!==null){if(e===null){if(!f)throw Error(i(318));if(f=t.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[Fn]=t}else pi(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;zt(t),f=!1}else kn!==null&&(vl(kn),kn=null),f=!0;if(!f)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=r,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(dt.current&1)!==0?Ct===0&&(Ct=3):kl())),t.updateQueue!==null&&(t.flags|=4),zt(t),null);case 4:return yi(),ll(e,t),e===null&&Xi(t.stateNode.containerInfo),zt(t),null;case 10:return Pa(t.type._context),zt(t),null;case 17:return Qt(t.type)&&Gs(),zt(t),null;case 19:if(at(dt),f=t.memoizedState,f===null)return zt(t),null;if(s=(t.flags&128)!==0,x=f.rendering,x===null)if(s)os(f,!1);else{if(Ct!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(x=to(e),x!==null){for(t.flags|=128,os(f,!1),s=x.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=r,r=t.child;r!==null;)f=r,e=s,f.flags&=14680066,x=f.alternate,x===null?(f.childLanes=0,f.lanes=e,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=x.childLanes,f.lanes=x.lanes,f.child=x.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=x.memoizedProps,f.memoizedState=x.memoizedState,f.updateQueue=x.updateQueue,f.type=x.type,e=x.dependencies,f.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return st(dt,dt.current&1|2),t.child}e=e.sibling}f.tail!==null&&ct()>ki&&(t.flags|=128,s=!0,os(f,!1),t.lanes=4194304)}else{if(!s)if(e=to(x),e!==null){if(t.flags|=128,s=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),os(f,!0),f.tail===null&&f.tailMode==="hidden"&&!x.alternate&&!ut)return zt(t),null}else 2*ct()-f.renderingStartTime>ki&&r!==1073741824&&(t.flags|=128,s=!0,os(f,!1),t.lanes=4194304);f.isBackwards?(x.sibling=t.child,t.child=x):(r=f.last,r!==null?r.sibling=x:t.child=x,f.last=x)}return f.tail!==null?(t=f.tail,f.rendering=t,f.tail=t.sibling,f.renderingStartTime=ct(),t.sibling=null,r=dt.current,st(dt,s?r&1|2:r&1),t):(zt(t),null);case 22:case 23:return bl(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&(t.mode&1)!==0?(on&1073741824)!==0&&(zt(t),t.subtreeFlags&6&&(t.flags|=8192)):zt(t),null;case 24:return null;case 25:return null}throw Error(i(156,t.tag))}function Wp(e,t){switch(Aa(t),t.tag){case 1:return Qt(t.type)&&Gs(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return yi(),at(Kt),at(Ot),$a(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return za(t),null;case 13:if(at(dt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(i(340));pi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return at(dt),null;case 4:return yi(),null;case 10:return Pa(t.type._context),null;case 22:case 23:return bl(),null;case 24:return null;default:return null}}var uo=!1,Ht=!1,Yp=typeof WeakSet=="function"?WeakSet:Set,xe=null;function wi(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){pt(e,t,s)}else r.current=null}function cl(e,t,r){try{r()}catch(s){pt(e,t,s)}}var cd=!1;function Xp(e,t){if(ba=As,e=zc(),ha(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var c=s.anchorOffset,f=s.focusNode;s=s.focusOffset;try{r.nodeType,f.nodeType}catch{r=null;break e}var x=0,j=-1,L=-1,z=0,J=0,ne=e,q=null;t:for(;;){for(var pe;ne!==r||c!==0&&ne.nodeType!==3||(j=x+c),ne!==f||s!==0&&ne.nodeType!==3||(L=x+s),ne.nodeType===3&&(x+=ne.nodeValue.length),(pe=ne.firstChild)!==null;)q=ne,ne=pe;for(;;){if(ne===e)break t;if(q===r&&++z===c&&(j=x),q===f&&++J===s&&(L=x),(pe=ne.nextSibling)!==null)break;ne=q,q=ne.parentNode}ne=pe}r=j===-1||L===-1?null:{start:j,end:L}}else r=null}r=r||{start:0,end:0}}else r=null;for(ka={focusedElem:e,selectionRange:r},As=!1,xe=t;xe!==null;)if(t=xe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,xe=e;else for(;xe!==null;){t=xe;try{var ye=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(ye!==null){var we=ye.memoizedProps,xt=ye.memoizedState,R=t.stateNode,F=R.getSnapshotBeforeUpdate(t.elementType===t.type?we:Sn(t.type,we),xt);R.__reactInternalSnapshotBeforeUpdate=F}break;case 3:var U=t.stateNode.containerInfo;U.nodeType===1?U.textContent="":U.nodeType===9&&U.documentElement&&U.removeChild(U.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(se){pt(t,t.return,se)}if(e=t.sibling,e!==null){e.return=t.return,xe=e;break}xe=t.return}return ye=cd,cd=!1,ye}function as(e,t,r){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var c=s=s.next;do{if((c.tag&e)===e){var f=c.destroy;c.destroy=void 0,f!==void 0&&cl(t,r,f)}c=c.next}while(c!==s)}}function fo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var s=r.create;r.destroy=s()}r=r.next}while(r!==t)}}function ul(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function ud(e){var t=e.alternate;t!==null&&(e.alternate=null,ud(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Fn],delete t[Qi],delete t[Ea],delete t[Ap],delete t[Ip])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function dd(e){return e.tag===5||e.tag===3||e.tag===4}function fd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||dd(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function dl(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Hs));else if(s!==4&&(e=e.child,e!==null))for(dl(e,t,r),e=e.sibling;e!==null;)dl(e,t,r),e=e.sibling}function fl(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(fl(e,t,r),e=e.sibling;e!==null;)fl(e,t,r),e=e.sibling}var Tt=null,_n=!1;function vr(e,t,r){for(r=r.child;r!==null;)hd(e,t,r),r=r.sibling}function hd(e,t,r){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(_s,r)}catch{}switch(r.tag){case 5:Ht||wi(r,t);case 6:var s=Tt,c=_n;Tt=null,vr(e,t,r),Tt=s,_n=c,Tt!==null&&(_n?(e=Tt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Tt.removeChild(r.stateNode));break;case 18:Tt!==null&&(_n?(e=Tt,r=r.stateNode,e.nodeType===8?Ca(e.parentNode,r):e.nodeType===1&&Ca(e,r),Oi(e)):Ca(Tt,r.stateNode));break;case 4:s=Tt,c=_n,Tt=r.stateNode.containerInfo,_n=!0,vr(e,t,r),Tt=s,_n=c;break;case 0:case 11:case 14:case 15:if(!Ht&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){c=s=s.next;do{var f=c,x=f.destroy;f=f.tag,x!==void 0&&((f&2)!==0||(f&4)!==0)&&cl(r,t,x),c=c.next}while(c!==s)}vr(e,t,r);break;case 1:if(!Ht&&(wi(r,t),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(j){pt(r,t,j)}vr(e,t,r);break;case 21:vr(e,t,r);break;case 22:r.mode&1?(Ht=(s=Ht)||r.memoizedState!==null,vr(e,t,r),Ht=s):vr(e,t,r);break;default:vr(e,t,r)}}function pd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Yp),t.forEach(function(s){var c=rm.bind(null,e,s);r.has(s)||(r.add(s),s.then(c,c))})}}function Cn(e,t){var r=t.deletions;if(r!==null)for(var s=0;s<r.length;s++){var c=r[s];try{var f=e,x=t,j=x;e:for(;j!==null;){switch(j.tag){case 5:Tt=j.stateNode,_n=!1;break e;case 3:Tt=j.stateNode.containerInfo,_n=!0;break e;case 4:Tt=j.stateNode.containerInfo,_n=!0;break e}j=j.return}if(Tt===null)throw Error(i(160));hd(f,x,c),Tt=null,_n=!1;var L=c.alternate;L!==null&&(L.return=null),c.return=null}catch(z){pt(c,t,z)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)md(t,e),t=t.sibling}function md(e,t){var r=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Cn(t,e),Rn(e),s&4){try{as(3,e,e.return),fo(3,e)}catch(we){pt(e,e.return,we)}try{as(5,e,e.return)}catch(we){pt(e,e.return,we)}}break;case 1:Cn(t,e),Rn(e),s&512&&r!==null&&wi(r,r.return);break;case 5:if(Cn(t,e),Rn(e),s&512&&r!==null&&wi(r,r.return),e.flags&32){var c=e.stateNode;try{sr(c,"")}catch(we){pt(e,e.return,we)}}if(s&4&&(c=e.stateNode,c!=null)){var f=e.memoizedProps,x=r!==null?r.memoizedProps:f,j=e.type,L=e.updateQueue;if(e.updateQueue=null,L!==null)try{j==="input"&&f.type==="radio"&&f.name!=null&&Ue(c,f),He(j,x);var z=He(j,f);for(x=0;x<L.length;x+=2){var J=L[x],ne=L[x+1];J==="style"?Ae(c,ne):J==="dangerouslySetInnerHTML"?An(c,ne):J==="children"?sr(c,ne):T(c,J,ne,z)}switch(j){case"input":Et(c,f);break;case"textarea":Dr(c,f);break;case"select":var q=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!f.multiple;var pe=f.value;pe!=null?lt(c,!!f.multiple,pe,!1):q!==!!f.multiple&&(f.defaultValue!=null?lt(c,!!f.multiple,f.defaultValue,!0):lt(c,!!f.multiple,f.multiple?[]:"",!1))}c[Qi]=f}catch(we){pt(e,e.return,we)}}break;case 6:if(Cn(t,e),Rn(e),s&4){if(e.stateNode===null)throw Error(i(162));c=e.stateNode,f=e.memoizedProps;try{c.nodeValue=f}catch(we){pt(e,e.return,we)}}break;case 3:if(Cn(t,e),Rn(e),s&4&&r!==null&&r.memoizedState.isDehydrated)try{Oi(t.containerInfo)}catch(we){pt(e,e.return,we)}break;case 4:Cn(t,e),Rn(e);break;case 13:Cn(t,e),Rn(e),c=e.child,c.flags&8192&&(f=c.memoizedState!==null,c.stateNode.isHidden=f,!f||c.alternate!==null&&c.alternate.memoizedState!==null||(ml=ct())),s&4&&pd(e);break;case 22:if(J=r!==null&&r.memoizedState!==null,e.mode&1?(Ht=(z=Ht)||J,Cn(t,e),Ht=z):Cn(t,e),Rn(e),s&8192){if(z=e.memoizedState!==null,(e.stateNode.isHidden=z)&&!J&&(e.mode&1)!==0)for(xe=e,J=e.child;J!==null;){for(ne=xe=J;xe!==null;){switch(q=xe,pe=q.child,q.tag){case 0:case 11:case 14:case 15:as(4,q,q.return);break;case 1:wi(q,q.return);var ye=q.stateNode;if(typeof ye.componentWillUnmount=="function"){s=q,r=q.return;try{t=s,ye.props=t.memoizedProps,ye.state=t.memoizedState,ye.componentWillUnmount()}catch(we){pt(s,r,we)}}break;case 5:wi(q,q.return);break;case 22:if(q.memoizedState!==null){yd(ne);continue}}pe!==null?(pe.return=q,xe=pe):yd(ne)}J=J.sibling}e:for(J=null,ne=e;;){if(ne.tag===5){if(J===null){J=ne;try{c=ne.stateNode,z?(f=c.style,typeof f.setProperty=="function"?f.setProperty("display","none","important"):f.display="none"):(j=ne.stateNode,L=ne.memoizedProps.style,x=L!=null&&L.hasOwnProperty("display")?L.display:null,j.style.display=le("display",x))}catch(we){pt(e,e.return,we)}}}else if(ne.tag===6){if(J===null)try{ne.stateNode.nodeValue=z?"":ne.memoizedProps}catch(we){pt(e,e.return,we)}}else if((ne.tag!==22&&ne.tag!==23||ne.memoizedState===null||ne===e)&&ne.child!==null){ne.child.return=ne,ne=ne.child;continue}if(ne===e)break e;for(;ne.sibling===null;){if(ne.return===null||ne.return===e)break e;J===ne&&(J=null),ne=ne.return}J===ne&&(J=null),ne.sibling.return=ne.return,ne=ne.sibling}}break;case 19:Cn(t,e),Rn(e),s&4&&pd(e);break;case 21:break;default:Cn(t,e),Rn(e)}}function Rn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(dd(r)){var s=r;break e}r=r.return}throw Error(i(160))}switch(s.tag){case 5:var c=s.stateNode;s.flags&32&&(sr(c,""),s.flags&=-33);var f=fd(e);fl(e,f,c);break;case 3:case 4:var x=s.stateNode.containerInfo,j=fd(e);dl(e,j,x);break;default:throw Error(i(161))}}catch(L){pt(e,e.return,L)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Kp(e,t,r){xe=e,gd(e)}function gd(e,t,r){for(var s=(e.mode&1)!==0;xe!==null;){var c=xe,f=c.child;if(c.tag===22&&s){var x=c.memoizedState!==null||uo;if(!x){var j=c.alternate,L=j!==null&&j.memoizedState!==null||Ht;j=uo;var z=Ht;if(uo=x,(Ht=L)&&!z)for(xe=c;xe!==null;)x=xe,L=x.child,x.tag===22&&x.memoizedState!==null?vd(c):L!==null?(L.return=x,xe=L):vd(c);for(;f!==null;)xe=f,gd(f),f=f.sibling;xe=c,uo=j,Ht=z}xd(e)}else(c.subtreeFlags&8772)!==0&&f!==null?(f.return=c,xe=f):xd(e)}}function xd(e){for(;xe!==null;){var t=xe;if((t.flags&8772)!==0){var r=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:Ht||fo(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!Ht)if(r===null)s.componentDidMount();else{var c=t.elementType===t.type?r.memoizedProps:Sn(t.type,r.memoizedProps);s.componentDidUpdate(c,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var f=t.updateQueue;f!==null&&yu(t,f,s);break;case 3:var x=t.updateQueue;if(x!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}yu(t,x,r)}break;case 5:var j=t.stateNode;if(r===null&&t.flags&4){r=j;var L=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":L.autoFocus&&r.focus();break;case"img":L.src&&(r.src=L.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var z=t.alternate;if(z!==null){var J=z.memoizedState;if(J!==null){var ne=J.dehydrated;ne!==null&&Oi(ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}Ht||t.flags&512&&ul(t)}catch(q){pt(t,t.return,q)}}if(t===e){xe=null;break}if(r=t.sibling,r!==null){r.return=t.return,xe=r;break}xe=t.return}}function yd(e){for(;xe!==null;){var t=xe;if(t===e){xe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,xe=r;break}xe=t.return}}function vd(e){for(;xe!==null;){var t=xe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{fo(4,t)}catch(L){pt(t,r,L)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var c=t.return;try{s.componentDidMount()}catch(L){pt(t,c,L)}}var f=t.return;try{ul(t)}catch(L){pt(t,f,L)}break;case 5:var x=t.return;try{ul(t)}catch(L){pt(t,x,L)}}}catch(L){pt(t,t.return,L)}if(t===e){xe=null;break}var j=t.sibling;if(j!==null){j.return=t.return,xe=j;break}xe=t.return}}var Qp=Math.ceil,ho=A.ReactCurrentDispatcher,hl=A.ReactCurrentOwner,fn=A.ReactCurrentBatchConfig,$e=0,Dt=null,bt=null,Lt=0,on=0,bi=pr(0),Ct=0,ls=null,zr=0,po=0,pl=0,cs=null,qt=null,ml=0,ki=1/0,qn=null,mo=!1,gl=null,wr=null,go=!1,br=null,xo=0,us=0,xl=null,yo=-1,vo=0;function Wt(){return($e&6)!==0?ct():yo!==-1?yo:yo=ct()}function kr(e){return(e.mode&1)===0?1:($e&2)!==0&&Lt!==0?Lt&-Lt:Lp.transition!==null?(vo===0&&(vo=fc()),vo):(e=Je,e!==0||(e=window.event,e=e===void 0?16:bc(e.type)),e)}function En(e,t,r,s){if(50<us)throw us=0,xl=null,Error(i(185));Bi(e,r,s),(($e&2)===0||e!==Dt)&&(e===Dt&&(($e&2)===0&&(po|=r),Ct===4&&Sr(e,Lt)),Jt(e,s),r===1&&$e===0&&(t.mode&1)===0&&(ki=ct()+500,Ws&&gr()))}function Jt(e,t){var r=e.callbackNode;Lh(e,t);var s=Ns(e,e===Dt?Lt:0);if(s===0)r!==null&&or(r),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(r!=null&&or(r),t===1)e.tag===0?Tp(bd.bind(null,e)):ou(bd.bind(null,e)),Dp(function(){($e&6)===0&&gr()}),r=null;else{switch(hc(s)){case 1:r=vn;break;case 4:r=ti;break;case 16:r=Lr;break;case 536870912:r=dc;break;default:r=Lr}r=jd(r,wd.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function wd(e,t){if(yo=-1,vo=0,($e&6)!==0)throw Error(i(327));var r=e.callbackNode;if(Si()&&e.callbackNode!==r)return null;var s=Ns(e,e===Dt?Lt:0);if(s===0)return null;if((s&30)!==0||(s&e.expiredLanes)!==0||t)t=wo(e,s);else{t=s;var c=$e;$e|=2;var f=Sd();(Dt!==e||Lt!==t)&&(qn=null,ki=ct()+500,$r(e,t));do try{Jp();break}catch(j){kd(e,j)}while(!0);Fa(),ho.current=f,$e=c,bt!==null?t=0:(Dt=null,Lt=0,t=Ct)}if(t!==0){if(t===2&&(c=Zo(e),c!==0&&(s=c,t=yl(e,c))),t===1)throw r=ls,$r(e,0),Sr(e,s),Jt(e,ct()),r;if(t===6)Sr(e,s);else{if(c=e.current.alternate,(s&30)===0&&!Zp(c)&&(t=wo(e,s),t===2&&(f=Zo(e),f!==0&&(s=f,t=yl(e,f))),t===1))throw r=ls,$r(e,0),Sr(e,s),Jt(e,ct()),r;switch(e.finishedWork=c,e.finishedLanes=s,t){case 0:case 1:throw Error(i(345));case 2:Gr(e,qt,qn);break;case 3:if(Sr(e,s),(s&130023424)===s&&(t=ml+500-ct(),10<t)){if(Ns(e,0)!==0)break;if(c=e.suspendedLanes,(c&s)!==s){Wt(),e.pingedLanes|=e.suspendedLanes&c;break}e.timeoutHandle=_a(Gr.bind(null,e,qt,qn),t);break}Gr(e,qt,qn);break;case 4:if(Sr(e,s),(s&4194240)===s)break;for(t=e.eventTimes,c=-1;0<s;){var x=31-wn(s);f=1<<x,x=t[x],x>c&&(c=x),s&=~f}if(s=c,s=ct()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*Qp(s/1960))-s,10<s){e.timeoutHandle=_a(Gr.bind(null,e,qt,qn),s);break}Gr(e,qt,qn);break;case 5:Gr(e,qt,qn);break;default:throw Error(i(329))}}}return Jt(e,ct()),e.callbackNode===r?wd.bind(null,e):null}function yl(e,t){var r=cs;return e.current.memoizedState.isDehydrated&&($r(e,t).flags|=256),e=wo(e,t),e!==2&&(t=qt,qt=r,t!==null&&vl(t)),e}function vl(e){qt===null?qt=e:qt.push.apply(qt,e)}function Zp(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var c=r[s],f=c.getSnapshot;c=c.value;try{if(!bn(f(),c))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Sr(e,t){for(t&=~pl,t&=~po,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-wn(t),s=1<<r;e[r]=-1,t&=~s}}function bd(e){if(($e&6)!==0)throw Error(i(327));Si();var t=Ns(e,0);if((t&1)===0)return Jt(e,ct()),null;var r=wo(e,t);if(e.tag!==0&&r===2){var s=Zo(e);s!==0&&(t=s,r=yl(e,s))}if(r===1)throw r=ls,$r(e,0),Sr(e,t),Jt(e,ct()),r;if(r===6)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Gr(e,qt,qn),Jt(e,ct()),null}function wl(e,t){var r=$e;$e|=1;try{return e(t)}finally{$e=r,$e===0&&(ki=ct()+500,Ws&&gr())}}function Hr(e){br!==null&&br.tag===0&&($e&6)===0&&Si();var t=$e;$e|=1;var r=fn.transition,s=Je;try{if(fn.transition=null,Je=1,e)return e()}finally{Je=s,fn.transition=r,$e=t,($e&6)===0&&gr()}}function bl(){on=bi.current,at(bi)}function $r(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Np(r)),bt!==null)for(r=bt.return;r!==null;){var s=r;switch(Aa(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Gs();break;case 3:yi(),at(Kt),at(Ot),$a();break;case 5:za(s);break;case 4:yi();break;case 13:at(dt);break;case 19:at(dt);break;case 10:Pa(s.type._context);break;case 22:case 23:bl()}r=r.return}if(Dt=e,bt=e=_r(e.current,null),Lt=on=t,Ct=0,ls=null,pl=po=zr=0,qt=cs=null,Rr!==null){for(t=0;t<Rr.length;t++)if(r=Rr[t],s=r.interleaved,s!==null){r.interleaved=null;var c=s.next,f=r.pending;if(f!==null){var x=f.next;f.next=c,s.next=x}r.pending=s}Rr=null}return e}function kd(e,t){do{var r=bt;try{if(Fa(),no.current=oo,ro){for(var s=ft.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}ro=!1}if(Ur=0,Nt=_t=ft=null,ns=!1,rs=0,hl.current=null,r===null||r.return===null){Ct=1,ls=t,bt=null;break}e:{var f=e,x=r.return,j=r,L=t;if(t=Lt,j.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){var z=L,J=j,ne=J.tag;if((J.mode&1)===0&&(ne===0||ne===11||ne===15)){var q=J.alternate;q?(J.updateQueue=q.updateQueue,J.memoizedState=q.memoizedState,J.lanes=q.lanes):(J.updateQueue=null,J.memoizedState=null)}var pe=Yu(x);if(pe!==null){pe.flags&=-257,Xu(pe,x,j,f,t),pe.mode&1&&Wu(f,z,t),t=pe,L=z;var ye=t.updateQueue;if(ye===null){var we=new Set;we.add(L),t.updateQueue=we}else ye.add(L);break e}else{if((t&1)===0){Wu(f,z,t),kl();break e}L=Error(i(426))}}else if(ut&&j.mode&1){var xt=Yu(x);if(xt!==null){(xt.flags&65536)===0&&(xt.flags|=256),Xu(xt,x,j,f,t),La(vi(L,j));break e}}f=L=vi(L,j),Ct!==4&&(Ct=2),cs===null?cs=[f]:cs.push(f),f=x;do{switch(f.tag){case 3:f.flags|=65536,t&=-t,f.lanes|=t;var R=Gu(f,L,t);xu(f,R);break e;case 1:j=L;var F=f.type,U=f.stateNode;if((f.flags&128)===0&&(typeof F.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(wr===null||!wr.has(U)))){f.flags|=65536,t&=-t,f.lanes|=t;var se=Vu(f,j,t);xu(f,se);break e}}f=f.return}while(f!==null)}Cd(r)}catch(ke){t=ke,bt===r&&r!==null&&(bt=r=r.return);continue}break}while(!0)}function Sd(){var e=ho.current;return ho.current=oo,e===null?oo:e}function kl(){(Ct===0||Ct===3||Ct===2)&&(Ct=4),Dt===null||(zr&268435455)===0&&(po&268435455)===0||Sr(Dt,Lt)}function wo(e,t){var r=$e;$e|=2;var s=Sd();(Dt!==e||Lt!==t)&&(qn=null,$r(e,t));do try{qp();break}catch(c){kd(e,c)}while(!0);if(Fa(),$e=r,ho.current=s,bt!==null)throw Error(i(261));return Dt=null,Lt=0,Ct}function qp(){for(;bt!==null;)_d(bt)}function Jp(){for(;bt!==null&&!ks();)_d(bt)}function _d(e){var t=Dd(e.alternate,e,on);e.memoizedProps=e.pendingProps,t===null?Cd(e):bt=t,hl.current=null}function Cd(e){var t=e;do{var r=t.alternate;if(e=t.return,(t.flags&32768)===0){if(r=Vp(r,t,on),r!==null){bt=r;return}}else{if(r=Wp(r,t),r!==null){r.flags&=32767,bt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ct=6,bt=null;return}}if(t=t.sibling,t!==null){bt=t;return}bt=t=e}while(t!==null);Ct===0&&(Ct=5)}function Gr(e,t,r){var s=Je,c=fn.transition;try{fn.transition=null,Je=1,em(e,t,r,s)}finally{fn.transition=c,Je=s}return null}function em(e,t,r,s){do Si();while(br!==null);if(($e&6)!==0)throw Error(i(327));r=e.finishedWork;var c=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var f=r.lanes|r.childLanes;if(Bh(e,f),e===Dt&&(bt=Dt=null,Lt=0),(r.subtreeFlags&2064)===0&&(r.flags&2064)===0||go||(go=!0,jd(Lr,function(){return Si(),null})),f=(r.flags&15990)!==0,(r.subtreeFlags&15990)!==0||f){f=fn.transition,fn.transition=null;var x=Je;Je=1;var j=$e;$e|=4,hl.current=null,Xp(e,r),md(r,e),wp(ka),As=!!ba,ka=ba=null,e.current=r,Kp(r),Ti(),$e=j,Je=x,fn.transition=f}else e.current=r;if(go&&(go=!1,br=e,xo=c),f=e.pendingLanes,f===0&&(wr=null),Dh(r.stateNode),Jt(e,ct()),t!==null)for(s=e.onRecoverableError,r=0;r<t.length;r++)c=t[r],s(c.value,{componentStack:c.stack,digest:c.digest});if(mo)throw mo=!1,e=gl,gl=null,e;return(xo&1)!==0&&e.tag!==0&&Si(),f=e.pendingLanes,(f&1)!==0?e===xl?us++:(us=0,xl=e):us=0,gr(),null}function Si(){if(br!==null){var e=hc(xo),t=fn.transition,r=Je;try{if(fn.transition=null,Je=16>e?16:e,br===null)var s=!1;else{if(e=br,br=null,xo=0,($e&6)!==0)throw Error(i(331));var c=$e;for($e|=4,xe=e.current;xe!==null;){var f=xe,x=f.child;if((xe.flags&16)!==0){var j=f.deletions;if(j!==null){for(var L=0;L<j.length;L++){var z=j[L];for(xe=z;xe!==null;){var J=xe;switch(J.tag){case 0:case 11:case 15:as(8,J,f)}var ne=J.child;if(ne!==null)ne.return=J,xe=ne;else for(;xe!==null;){J=xe;var q=J.sibling,pe=J.return;if(ud(J),J===z){xe=null;break}if(q!==null){q.return=pe,xe=q;break}xe=pe}}}var ye=f.alternate;if(ye!==null){var we=ye.child;if(we!==null){ye.child=null;do{var xt=we.sibling;we.sibling=null,we=xt}while(we!==null)}}xe=f}}if((f.subtreeFlags&2064)!==0&&x!==null)x.return=f,xe=x;else e:for(;xe!==null;){if(f=xe,(f.flags&2048)!==0)switch(f.tag){case 0:case 11:case 15:as(9,f,f.return)}var R=f.sibling;if(R!==null){R.return=f.return,xe=R;break e}xe=f.return}}var F=e.current;for(xe=F;xe!==null;){x=xe;var U=x.child;if((x.subtreeFlags&2064)!==0&&U!==null)U.return=x,xe=U;else e:for(x=F;xe!==null;){if(j=xe,(j.flags&2048)!==0)try{switch(j.tag){case 0:case 11:case 15:fo(9,j)}}catch(ke){pt(j,j.return,ke)}if(j===x){xe=null;break e}var se=j.sibling;if(se!==null){se.return=j.return,xe=se;break e}xe=j.return}}if($e=c,gr(),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(_s,e)}catch{}s=!0}return s}finally{Je=r,fn.transition=t}}return!1}function Ed(e,t,r){t=vi(r,t),t=Gu(e,t,1),e=yr(e,t,1),t=Wt(),e!==null&&(Bi(e,1,t),Jt(e,t))}function pt(e,t,r){if(e.tag===3)Ed(e,e,r);else for(;t!==null;){if(t.tag===3){Ed(t,e,r);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(wr===null||!wr.has(s))){e=vi(r,e),e=Vu(t,e,1),t=yr(t,e,1),e=Wt(),t!==null&&(Bi(t,1,e),Jt(t,e));break}}t=t.return}}function tm(e,t,r){var s=e.pingCache;s!==null&&s.delete(t),t=Wt(),e.pingedLanes|=e.suspendedLanes&r,Dt===e&&(Lt&r)===r&&(Ct===4||Ct===3&&(Lt&130023424)===Lt&&500>ct()-ml?$r(e,0):pl|=r),Jt(e,t)}function Nd(e,t){t===0&&((e.mode&1)===0?t=1:(t=Es,Es<<=1,(Es&130023424)===0&&(Es=4194304)));var r=Wt();e=Kn(e,t),e!==null&&(Bi(e,t,r),Jt(e,r))}function nm(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Nd(e,r)}function rm(e,t){var r=0;switch(e.tag){case 13:var s=e.stateNode,c=e.memoizedState;c!==null&&(r=c.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(i(314))}s!==null&&s.delete(t),Nd(e,r)}var Dd;Dd=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Kt.current)Zt=!0;else{if((e.lanes&r)===0&&(t.flags&128)===0)return Zt=!1,Gp(e,t,r);Zt=(e.flags&131072)!==0}else Zt=!1,ut&&(t.flags&1048576)!==0&&au(t,Xs,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;co(e,t),e=t.pendingProps;var c=di(t,Ot.current);xi(t,r),c=Wa(null,t,s,e,c,r);var f=Ya();return t.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Qt(s)?(f=!0,Vs(t)):f=!1,t.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,Oa(t),c.updater=ao,t.stateNode=c,c._reactInternals=t,Ja(t,s,e,r),t=rl(null,t,s,!0,f,r)):(t.tag=0,ut&&f&&ja(t),Vt(null,t,c,r),t=t.child),t;case 16:s=t.elementType;e:{switch(co(e,t),e=t.pendingProps,c=s._init,s=c(s._payload),t.type=s,c=t.tag=sm(s),e=Sn(s,e),c){case 0:t=nl(null,t,s,e,r);break e;case 1:t=ed(null,t,s,e,r);break e;case 11:t=Ku(null,t,s,e,r);break e;case 14:t=Qu(null,t,s,Sn(s.type,e),r);break e}throw Error(i(306,s,""))}return t;case 0:return s=t.type,c=t.pendingProps,c=t.elementType===s?c:Sn(s,c),nl(e,t,s,c,r);case 1:return s=t.type,c=t.pendingProps,c=t.elementType===s?c:Sn(s,c),ed(e,t,s,c,r);case 3:e:{if(td(t),e===null)throw Error(i(387));s=t.pendingProps,f=t.memoizedState,c=f.element,gu(e,t),eo(t,s,null,r);var x=t.memoizedState;if(s=x.element,f.isDehydrated)if(f={element:s,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},t.updateQueue.baseState=f,t.memoizedState=f,t.flags&256){c=vi(Error(i(423)),t),t=nd(e,t,s,r,c);break e}else if(s!==c){c=vi(Error(i(424)),t),t=nd(e,t,s,r,c);break e}else for(sn=hr(t.stateNode.containerInfo.firstChild),rn=t,ut=!0,kn=null,r=pu(t,null,s,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(pi(),s===c){t=Zn(e,t,r);break e}Vt(e,t,s,r)}t=t.child}return t;case 5:return vu(t),e===null&&Ta(t),s=t.type,c=t.pendingProps,f=e!==null?e.memoizedProps:null,x=c.children,Sa(s,c)?x=null:f!==null&&Sa(s,f)&&(t.flags|=32),Ju(e,t),Vt(e,t,x,r),t.child;case 6:return e===null&&Ta(t),null;case 13:return rd(e,t,r);case 4:return Ua(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=mi(t,null,s,r):Vt(e,t,s,r),t.child;case 11:return s=t.type,c=t.pendingProps,c=t.elementType===s?c:Sn(s,c),Ku(e,t,s,c,r);case 7:return Vt(e,t,t.pendingProps,r),t.child;case 8:return Vt(e,t,t.pendingProps.children,r),t.child;case 12:return Vt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(s=t.type._context,c=t.pendingProps,f=t.memoizedProps,x=c.value,st(Zs,s._currentValue),s._currentValue=x,f!==null)if(bn(f.value,x)){if(f.children===c.children&&!Kt.current){t=Zn(e,t,r);break e}}else for(f=t.child,f!==null&&(f.return=t);f!==null;){var j=f.dependencies;if(j!==null){x=f.child;for(var L=j.firstContext;L!==null;){if(L.context===s){if(f.tag===1){L=Qn(-1,r&-r),L.tag=2;var z=f.updateQueue;if(z!==null){z=z.shared;var J=z.pending;J===null?L.next=L:(L.next=J.next,J.next=L),z.pending=L}}f.lanes|=r,L=f.alternate,L!==null&&(L.lanes|=r),Ma(f.return,r,t),j.lanes|=r;break}L=L.next}}else if(f.tag===10)x=f.type===t.type?null:f.child;else if(f.tag===18){if(x=f.return,x===null)throw Error(i(341));x.lanes|=r,j=x.alternate,j!==null&&(j.lanes|=r),Ma(x,r,t),x=f.sibling}else x=f.child;if(x!==null)x.return=f;else for(x=f;x!==null;){if(x===t){x=null;break}if(f=x.sibling,f!==null){f.return=x.return,x=f;break}x=x.return}f=x}Vt(e,t,c.children,r),t=t.child}return t;case 9:return c=t.type,s=t.pendingProps.children,xi(t,r),c=un(c),s=s(c),t.flags|=1,Vt(e,t,s,r),t.child;case 14:return s=t.type,c=Sn(s,t.pendingProps),c=Sn(s.type,c),Qu(e,t,s,c,r);case 15:return Zu(e,t,t.type,t.pendingProps,r);case 17:return s=t.type,c=t.pendingProps,c=t.elementType===s?c:Sn(s,c),co(e,t),t.tag=1,Qt(s)?(e=!0,Vs(t)):e=!1,xi(t,r),Hu(t,s,c),Ja(t,s,c,r),rl(null,t,s,!0,e,r);case 19:return sd(e,t,r);case 22:return qu(e,t,r)}throw Error(i(156,t.tag))};function jd(e,t){return Tr(e,t)}function im(e,t,r,s){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hn(e,t,r,s){return new im(e,t,r,s)}function Sl(e){return e=e.prototype,!(!e||!e.isReactComponent)}function sm(e){if(typeof e=="function")return Sl(e)?1:0;if(e!=null){if(e=e.$$typeof,e===_e)return 11;if(e===ve)return 14}return 2}function _r(e,t){var r=e.alternate;return r===null?(r=hn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function bo(e,t,r,s,c,f){var x=2;if(s=e,typeof e=="function")Sl(e)&&(x=1);else if(typeof e=="string")x=5;else e:switch(e){case Z:return Vr(r.children,c,f,t);case de:x=8,c|=8;break;case he:return e=hn(12,r,t,c|2),e.elementType=he,e.lanes=f,e;case Y:return e=hn(13,r,t,c),e.elementType=Y,e.lanes=f,e;case re:return e=hn(19,r,t,c),e.elementType=re,e.lanes=f,e;case ie:return ko(r,c,f,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Se:x=10;break e;case Ee:x=9;break e;case _e:x=11;break e;case ve:x=14;break e;case ge:x=16,s=null;break e}throw Error(i(130,e==null?e:typeof e,""))}return t=hn(x,r,t,c),t.elementType=e,t.type=s,t.lanes=f,t}function Vr(e,t,r,s){return e=hn(7,e,s,t),e.lanes=r,e}function ko(e,t,r,s){return e=hn(22,e,s,t),e.elementType=ie,e.lanes=r,e.stateNode={isHidden:!1},e}function _l(e,t,r){return e=hn(6,e,null,t),e.lanes=r,e}function Cl(e,t,r){return t=hn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function om(e,t,r,s,c){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qo(0),this.expirationTimes=qo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qo(0),this.identifierPrefix=s,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function El(e,t,r,s,c,f,x,j,L){return e=new om(e,t,r,j,L),t===1?(t=1,f===!0&&(t|=8)):t=0,f=hn(3,null,null,t),e.current=f,f.stateNode=e,f.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oa(f),e}function am(e,t,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:M,key:s==null?null:""+s,children:e,containerInfo:t,implementation:r}}function Ad(e){if(!e)return mr;e=e._reactInternals;e:{if(It(e)!==e||e.tag!==1)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Qt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(i(171))}if(e.tag===1){var r=e.type;if(Qt(r))return iu(e,r,t)}return t}function Id(e,t,r,s,c,f,x,j,L){return e=El(r,s,!0,e,c,f,x,j,L),e.context=Ad(null),r=e.current,s=Wt(),c=kr(r),f=Qn(s,c),f.callback=t??null,yr(r,f,c),e.current.lanes=c,Bi(e,c,s),Jt(e,s),e}function So(e,t,r,s){var c=t.current,f=Wt(),x=kr(c);return r=Ad(r),t.context===null?t.context=r:t.pendingContext=r,t=Qn(f,x),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=yr(c,t,x),e!==null&&(En(e,c,x,f),Js(e,c,x)),x}function _o(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Td(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Nl(e,t){Td(e,t),(e=e.alternate)&&Td(e,t)}function lm(){return null}var Ld=typeof reportError=="function"?reportError:function(e){console.error(e)};function Dl(e){this._internalRoot=e}Co.prototype.render=Dl.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(i(409));So(e,t,null,null)},Co.prototype.unmount=Dl.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Hr(function(){So(null,e,null,null)}),t[Vn]=null}};function Co(e){this._internalRoot=e}Co.prototype.unstable_scheduleHydration=function(e){if(e){var t=gc();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ur.length&&t!==0&&t<ur[r].priority;r++);ur.splice(r,0,e),r===0&&vc(e)}};function jl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Eo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Bd(){}function cm(e,t,r,s,c){if(c){if(typeof s=="function"){var f=s;s=function(){var z=_o(x);f.call(z)}}var x=Id(t,s,e,0,null,!1,!1,"",Bd);return e._reactRootContainer=x,e[Vn]=x.current,Xi(e.nodeType===8?e.parentNode:e),Hr(),x}for(;c=e.lastChild;)e.removeChild(c);if(typeof s=="function"){var j=s;s=function(){var z=_o(L);j.call(z)}}var L=El(e,0,!1,null,null,!1,!1,"",Bd);return e._reactRootContainer=L,e[Vn]=L.current,Xi(e.nodeType===8?e.parentNode:e),Hr(function(){So(t,L,r,s)}),L}function No(e,t,r,s,c){var f=r._reactRootContainer;if(f){var x=f;if(typeof c=="function"){var j=c;c=function(){var L=_o(x);j.call(L)}}So(t,x,e,c)}else x=cm(r,t,e,c,s);return _o(x)}pc=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Li(t.pendingLanes);r!==0&&(Jo(t,r|1),Jt(t,ct()),($e&6)===0&&(ki=ct()+500,gr()))}break;case 13:Hr(function(){var s=Kn(e,1);if(s!==null){var c=Wt();En(s,e,1,c)}}),Nl(e,1)}},ea=function(e){if(e.tag===13){var t=Kn(e,134217728);if(t!==null){var r=Wt();En(t,e,134217728,r)}Nl(e,134217728)}},mc=function(e){if(e.tag===13){var t=kr(e),r=Kn(e,t);if(r!==null){var s=Wt();En(r,e,t,s)}Nl(e,t)}},gc=function(){return Je},xc=function(e,t){var r=Je;try{return Je=e,t()}finally{Je=r}},Pt=function(e,t,r){switch(t){case"input":if(Et(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var s=r[t];if(s!==e&&s.form===e.form){var c=$s(s);if(!c)throw Error(i(90));St(s),Et(s,c)}}}break;case"textarea":Dr(e,r);break;case"select":t=r.value,t!=null&&lt(e,!!r.multiple,t,!1)}},it=wl,Qe=Hr;var um={usingClientEntryPoint:!1,Events:[Zi,ci,$s,Ne,Me,wl]},ds={findFiberByHostInstance:Br,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dm={bundleType:ds.bundleType,version:ds.version,rendererPackageName:ds.rendererPackageName,rendererConfig:ds.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=wt(e),e===null?null:e.stateNode},findFiberByHostInstance:ds.findFiberByHostInstance||lm,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Do=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Do.isDisabled&&Do.supportsFiber)try{_s=Do.inject(dm),Bn=Do}catch{}}return en.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=um,en.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jl(t))throw Error(i(200));return am(e,t,null,r)},en.createRoot=function(e,t){if(!jl(e))throw Error(i(299));var r=!1,s="",c=Ld;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(c=t.onRecoverableError)),t=El(e,1,!1,null,null,r,!1,s,c),e[Vn]=t.current,Xi(e.nodeType===8?e.parentNode:e),new Dl(t)},en.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=wt(t),e=e===null?null:e.stateNode,e},en.flushSync=function(e){return Hr(e)},en.hydrate=function(e,t,r){if(!Eo(t))throw Error(i(200));return No(null,e,t,!0,r)},en.hydrateRoot=function(e,t,r){if(!jl(e))throw Error(i(405));var s=r!=null&&r.hydratedSources||null,c=!1,f="",x=Ld;if(r!=null&&(r.unstable_strictMode===!0&&(c=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onRecoverableError!==void 0&&(x=r.onRecoverableError)),t=Id(t,null,e,1,r??null,c,!1,f,x),e[Vn]=t.current,Xi(e),s)for(e=0;e<s.length;e++)r=s[e],c=r._getVersion,c=c(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,c]:t.mutableSourceEagerHydrationData.push(r,c);return new Co(t)},en.render=function(e,t,r){if(!Eo(t))throw Error(i(200));return No(null,e,t,!1,r)},en.unmountComponentAtNode=function(e){if(!Eo(e))throw Error(i(40));return e._reactRootContainer?(Hr(function(){No(null,null,e,!1,function(){e._reactRootContainer=null,e[Vn]=null})}),!0):!1},en.unstable_batchedUpdates=wl,en.unstable_renderSubtreeIntoContainer=function(e,t,r,s){if(!Eo(r))throw Error(i(200));if(e==null||e._reactInternals===void 0)throw Error(i(38));return No(e,t,r,!1,s)},en.version="18.3.1-next-f1338f8080-20240426",en}var $d;function bm(){if($d)return Ll.exports;$d=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(n){console.error(n)}}return o(),Ll.exports=wm(),Ll.exports}var Gd;function km(){if(Gd)return jo;Gd=1;var o=bm();return jo.createRoot=o.createRoot,jo.hydrateRoot=o.hydrateRoot,jo}var Sm=km();const _m=Sf(Sm),Vd=o=>{let n;const i=new Set,a=(v,S)=>{const g=typeof v=="function"?v(n):v;if(!Object.is(g,n)){const w=n;n=S??(typeof g!="object"||g===null)?g:Object.assign({},n,g),i.forEach(_=>_(n,w))}},l=()=>n,h={setState:a,getState:l,getInitialState:()=>p,subscribe:v=>(i.add(v),()=>i.delete(v))},p=n=o(a,l,h);return h},Cm=(o=>o?Vd(o):Vd),Em=o=>o;function Nm(o,n=Em){const i=hs.useSyncExternalStore(o.subscribe,hs.useCallback(()=>n(o.getState()),[o,n]),hs.useCallback(()=>n(o.getInitialState()),[o,n]));return hs.useDebugValue(i),i}const Wd=o=>{const n=Cm(o),i=a=>Nm(n,a);return Object.assign(i,n),i},Dm=(o=>o?Wd(o):Wd);class ws{constructor(n){$(this,"buffer");$(this,"index",0);this.buffer=n instanceof Uint8Array?n:new Uint8Array(n)}slice(n,i){return new ws(this.buffer.slice(n,i))}readable(){return this.index<this.buffer.length}skip(n){this.index+=n}readUInt8(){return this.buffer[this.index++]}readInt8(){return this.buffer[this.index++]<<24>>24}readUInt16(){return this.buffer[this.index++]+(this.buffer[this.index++]<<8)}readUInt32(){return this.buffer[this.index++]+(this.buffer[this.index++]<<8)+(this.buffer[this.index++]<<16)+(this.buffer[this.index++]<<24)>>>0}readString(){const n=this.readUInt16();if(n===0)return"";const i=new TextDecoder("utf-8").decode(this.buffer.slice(this.index,this.index+n));return this.index+=n,i}readRGB(){return this.buffer[this.index++]+(this.buffer[this.index++]<<8)+(this.buffer[this.index++]<<16)}readLight(){return{level:this.readUInt16(),color:this.readUInt16()}}readAnimationLength(){return{min:this.readUInt32(),max:this.readUInt32()}}}const Oo=new Uint8Array([69,77,80,69,82,73,65,0]),Jr=20;var Vo=(o=>(o[o.SPRITE_DATA=1]="SPRITE_DATA",o[o.OBJECT_DEFS=2]="OBJECT_DEFS",o))(Vo||{});function oc(o){const n=o instanceof Uint8Array?o:new Uint8Array(o);if(n.length<Jr)return!1;for(let i=0;i<Oo.length;i++)if(n[i]!==Oo[i])return!1;return!0}function _f(o){const n=o instanceof Uint8Array?o:new Uint8Array(o);if(!oc(n))return null;const i=new DataView(n.buffer,n.byteOffset,n.byteLength);return{fileType:i.getUint8(8),formatVersion:i.getUint16(9,!0),contentVersion:i.getUint32(11,!0),flags:i.getUint8(15)}}function jm(o){const n=o instanceof Uint8Array?o:new Uint8Array(o);return n.length>=2&&n[0]===31&&n[1]===139}async function Am(o){const n=new CompressionStream("gzip"),i=n.writable.getWriter();i.write(new Uint8Array(o)),i.close();const a=n.readable.getReader(),l=[];for(;;){const{done:p,value:v}=await a.read();if(p)break;l.push(v)}let d=0;for(const p of l)d+=p.byteLength;const m=new Uint8Array(d);let h=0;for(const p of l)m.set(p,h),h+=p.byteLength;return m.buffer}async function Im(o){if(!jm(o))return o;const n=new DecompressionStream("gzip"),i=n.writable.getWriter();i.write(new Uint8Array(o)),i.close();const a=n.readable.getReader(),l=[];for(;;){const{done:p,value:v}=await a.read();if(p)break;l.push(v)}let d=0;for(const p of l)d+=p.byteLength;const m=new Uint8Array(d);let h=0;for(const p of l)m.set(p,h),h+=p.byteLength;return m.buffer}const Yd={"41BF619C":740,"439D5A33":760,"42A3":1098},be={ThingAttrGround:0,ThingAttrGroundBorder:1,ThingAttrOnBottom:2,ThingAttrOnTop:3,ThingAttrContainer:4,ThingAttrStackable:5,ThingAttrForceUse:6,ThingAttrMultiUse:7,ThingAttrWritable:8,ThingAttrWritableOnce:9,ThingAttrFluidContainer:10,ThingAttrSplash:11,ThingAttrNotWalkable:12,ThingAttrNotMoveable:13,ThingAttrBlockProjectile:14,ThingAttrNotPathable:15,ThingAttrPickupable:16,ThingAttrHangable:17,ThingAttrHookSouth:18,ThingAttrHookEast:19,ThingAttrRotateable:20,ThingAttrLight:21,ThingAttrDontHide:22,ThingAttrTranslucent:23,ThingAttrDisplacement:24,ThingAttrElevation:25,ThingAttrLyingCorpse:26,ThingAttrAnimateAlways:27,ThingAttrMinimapColor:28,ThingAttrLensHelp:29,ThingAttrFullGround:30,ThingAttrLook:31,ThingAttrCloth:32,ThingAttrMarket:33,ThingAttrUsable:34,ThingAttrWrapable:35,ThingAttrUnwrapable:36,ThingAttrTopEffect:37,ThingAttrOpacity:100,ThingAttrNotPreWalkable:101,ThingAttrFloorChange:252,ThingAttrNoMoveAnimation:253,ThingAttrChargeable:254,ThingAttrLast:255};function Tm(o,n){if(o===be.ThingAttrLast)return o;if(n>=1e3){if(o===16)return be.ThingAttrNoMoveAnimation;if(o>16)return o-1}else if(n>=755){if(o===23)return be.ThingAttrFloorChange}else if(n>=740){if(o>0&&o<=15)return o===5?be.ThingAttrMultiUse:o===6?be.ThingAttrForceUse:o+1;switch(o){case 16:return be.ThingAttrLight;case 17:return be.ThingAttrFloorChange;case 18:return be.ThingAttrFullGround;case 19:return be.ThingAttrElevation;case 20:return be.ThingAttrDisplacement;case 22:return be.ThingAttrMinimapColor;case 23:return be.ThingAttrRotateable;case 24:return be.ThingAttrLyingCorpse;case 25:return be.ThingAttrHangable;case 26:return be.ThingAttrHookSouth;case 27:return be.ThingAttrHookEast;case 28:return be.ThingAttrAnimateAlways}}return o}function Lm(){return{ground:!1,groundBorder:!1,onBottom:!1,onTop:!1,container:!1,stackable:!1,forceUse:!1,multiUse:!1,writable:!1,writableOnce:!1,fluidContainer:!1,splash:!1,notWalkable:!1,notMoveable:!1,blockProjectile:!1,notPathable:!1,pickupable:!1,hangable:!1,hookSouth:!1,hookEast:!1,rotateable:!1,hasLight:!1,dontHide:!1,translucent:!1,hasDisplacement:!1,hasElevation:!1,lyingCorpse:!1,animateAlways:!1,hasMinimapColor:!1,fullGround:!1,look:!1,cloth:!1,hasMarket:!1,usable:!1,wrapable:!1,unwrapable:!1,topEffect:!1,noMoveAnimation:!1,chargeable:!1}}function Bm(o,n){const i=Lm();for(;;){const a=o.readUInt8(),l=Tm(a,n);switch(l){case be.ThingAttrLast:return i;case be.ThingAttrGround:i.ground=!0,i.groundSpeed=o.readUInt16();break;case be.ThingAttrGroundBorder:i.groundBorder=!0;break;case be.ThingAttrOnBottom:i.onBottom=!0;break;case be.ThingAttrOnTop:i.onTop=!0;break;case be.ThingAttrContainer:i.container=!0;break;case be.ThingAttrStackable:i.stackable=!0;break;case be.ThingAttrForceUse:i.forceUse=!0;break;case be.ThingAttrMultiUse:i.multiUse=!0;break;case be.ThingAttrWritable:i.writable=!0,i.writableMaxLen=o.readUInt16();break;case be.ThingAttrWritableOnce:i.writableOnce=!0,i.writableOnceMaxLen=o.readUInt16();break;case be.ThingAttrFluidContainer:i.fluidContainer=!0;break;case be.ThingAttrSplash:i.splash=!0;break;case be.ThingAttrNotWalkable:i.notWalkable=!0;break;case be.ThingAttrNotMoveable:i.notMoveable=!0;break;case be.ThingAttrBlockProjectile:i.blockProjectile=!0;break;case be.ThingAttrNotPathable:i.notPathable=!0;break;case be.ThingAttrPickupable:i.pickupable=!0;break;case be.ThingAttrHangable:i.hangable=!0;break;case be.ThingAttrHookSouth:i.hookSouth=!0;break;case be.ThingAttrHookEast:i.hookEast=!0;break;case be.ThingAttrRotateable:i.rotateable=!0;break;case be.ThingAttrLight:{i.hasLight=!0;const d=o.readLight();i.lightLevel=d.level,i.lightColor=d.color;break}case be.ThingAttrDontHide:i.dontHide=!0;break;case be.ThingAttrTranslucent:i.translucent=!0;break;case be.ThingAttrDisplacement:{if(i.hasDisplacement=!0,n>=755){const d=o.readLight();i.displacementX=d.level,i.displacementY=d.color}break}case be.ThingAttrElevation:i.hasElevation=!0,i.elevation=o.readUInt16();break;case be.ThingAttrLyingCorpse:i.lyingCorpse=!0;break;case be.ThingAttrAnimateAlways:i.animateAlways=!0;break;case be.ThingAttrMinimapColor:i.hasMinimapColor=!0,i.minimapColor=o.readUInt16();break;case be.ThingAttrLensHelp:i.lensHelp=o.readUInt16();break;case be.ThingAttrFullGround:i.fullGround=!0;break;case be.ThingAttrLook:i.look=!0;break;case be.ThingAttrCloth:i.cloth=!0,i.clothSlot=o.readUInt16();break;case be.ThingAttrMarket:i.hasMarket=!0,i.marketCategory=o.readUInt16(),i.marketTradeAs=o.readUInt16(),i.marketShowAs=o.readUInt16(),i.marketName=o.readString(),i.marketRestrictVocation=o.readUInt16(),i.marketRequiredLevel=o.readUInt16();break;case be.ThingAttrUsable:i.usable=!0,i.usableActionId=o.readUInt16();break;case be.ThingAttrWrapable:i.wrapable=!0;break;case be.ThingAttrUnwrapable:i.unwrapable=!0;break;case be.ThingAttrTopEffect:i.topEffect=!0;break;case be.ThingAttrOpacity:break;case be.ThingAttrNotPreWalkable:break;case be.ThingAttrFloorChange:break;case be.ThingAttrNoMoveAnimation:i.noMoveAnimation=!0;break;case be.ThingAttrChargeable:i.chargeable=!0;break;default:throw new Error(`Unknown flag 0x${l.toString(16)} at offset ${o.index}`)}}}function Fm(o,n,i){const a=i?o.readUInt8():0,l=o.readUInt8(),d=o.readUInt8();(l>1||d>1)&&o.readUInt8();const m=o.readUInt8(),h=o.readUInt8(),p=o.readUInt8(),v=n>=755?o.readUInt8():1,S=o.readUInt8();let g=0,w=0,_=0;const E=[];if(S>1&&n>=1050){g=o.readUInt8(),w=o.readUInt32(),_=o.readInt8();for(let N=0;N<S;N++)E.push(o.readAnimationLength())}const P=l*d*m*h*p*v*S,k=[];for(let N=0;N<P;N++)k.push(n>=960?o.readUInt32():o.readUInt16());return{type:a,width:l,height:d,layers:m,patternX:h,patternY:p,patternZ:v,animationLength:S,asynchronous:g,nLoop:w,start:_,animationLengths:E,sprites:k}}function Pm(o){const n=_f(o);let i,a;if(n){if(n.fileType!==Vo.OBJECT_DEFS)throw new Error(`Expected object definitions (0x02), got 0x${n.fileType.toString(16)}`);i=n.contentVersion,a=Jr}else{const w=new DataView(o).getUint32(0,!0).toString(16).toUpperCase();if(!(w in Yd))throw new Error("Unknown object definition file format.");i=Yd[w],a=4}const l=new ws(o.slice(a)),d=l.readUInt16(),m=l.readUInt16(),h=l.readUInt16(),p=l.readUInt16(),v=d+m+h+p,S=new Map;for(let g=100;g<=v;g++){const w=l.index,_=Bm(l,i),E=g>d&&g<=d+m,P=i>=1050&&E,k=P?l.readUInt8():1,N=[];for(let G=0;G<k;G++)N.push(Fm(l,i,P));const D=l.index,T=l.buffer.slice(w,D);let A;g<=d?A="item":g<=d+m?A="outfit":g<=d+m+h?A="effect":A="distance",S.set(g,{id:g,category:A,flags:_,frameGroups:N,rawBytes:T})}return console.log(`[OB] Parsed ${S.size} things: items=${d} outfits=${m} effects=${h} distances=${p}`),{version:i,itemCount:d,outfitCount:m,effectCount:h,distanceCount:p,things:S,originalBuffer:o}}const Xd={"57BBD603":1098};function Mm(o){const n=_f(o);let i,a;if(n){if(n.fileType!==Vo.SPRITE_DATA)throw new Error(`Expected sprite data (0x01), got 0x${n.fileType.toString(16)}`);i=n.contentVersion,a=Jr}else{const v=new DataView(o).getUint32(0,!0).toString(16).toUpperCase();if(!(v in Xd))throw new Error("Unknown sprite file format.");i=Xd[v],a=4}const l=new Uint8Array(o.slice(a)),d=new ws(l),m=i>760?d.readUInt32():d.readUInt16(),h=new Map;for(let p=1;p<=m;p++){const v=d.readUInt32();v!==0&&h.set(p,v-a)}return console.log(`[OB] Parsed sprite index: ${m} sprites, ${h.size} non-empty`),{version:i,spriteCount:m,addresses:h,buffer:l,originalBuffer:o}}function mn(o,n){const i=o.addresses.get(n);if(i===void 0)return null;const a=o.buffer,l=a[i+3]+(a[i+4]<<8),d=new ws(a.slice(i,i+5+l));d.readRGB(),d.skip(2);const m=new Uint32Array(1024);let h=0;for(;d.readable();){const v=d.readUInt16(),S=d.readUInt16();h+=v;for(let g=h;g<h+S;g++){const w=d.readUInt8(),_=d.readUInt8(),E=d.readUInt8(),P=d.readUInt8();m[g]=P<<24|E<<16|_<<8|w}h+=S}const p=new ImageData(32,32);return new Uint32Array(p.data.buffer).set(m),p}const Uo=new Map,Wo=document.createElement("canvas");Wo.width=32;Wo.height=32;const Kd=Wo.getContext("2d");function Yo(o,n,i){if(n===0)return null;const a=Uo.get(n);if(a)return a;const l=(i==null?void 0:i.get(n))??mn(o,n);if(!l)return null;Kd.clearRect(0,0,32,32),Kd.putImageData(l,0,0);const d=Wo.toDataURL();return Uo.set(n,d),d}function zn(){Uo.clear()}function Pl(o){Uo.delete(o)}const Rm=["FLAG_BLOCK_SOLID","FLAG_BLOCK_PROJECTILE","FLAG_BLOCK_PATHFIND","FLAG_HAS_HEIGHT","FLAG_USEABLE","FLAG_PICKUPABLE","FLAG_MOVEABLE","FLAG_STACKABLE","FLAG_FLOORCHANGEDOWN","FLAG_FLOORCHANGENORTH","FLAG_FLOORCHANGEEAST","FLAG_FLOORCHANGESOUTH","FLAG_FLOORCHANGEWEST","FLAG_ALWAYSONTOP","FLAG_READABLE","FLAG_ROTATABLE","FLAG_HANGABLE","FLAG_VERTICAL","FLAG_HORIZONTAL","FLAG_CANNOTDECAY","FLAG_ALLOWDISTREAD","FLAG_UNUSED","FLAG_CLIENTCHARGES","FLAG_LOOKTHROUGH","FLAG_ANIMATION","FLAG_FULLTILE","FLAG_FORCEUSE"];function Om(o){let n=0;return o.notWalkable&&(n|=1),o.blockProjectile&&(n|=2),o.notPathable&&(n|=4),o.hasElevation&&(n|=8),(o.forceUse||o.multiUse)&&(n|=16),o.pickupable&&(n|=32),o.notMoveable||(n|=64),o.stackable&&(n|=128),o.onTop&&(n|=8192),(o.writable||o.writableOnce)&&(n|=16384),o.rotateable&&(n|=32768),o.hangable&&(n|=65536),o.hookSouth&&(n|=1<<17),o.hookEast&&(n|=1<<18),o.chargeable&&(n|=1<<22),o.translucent&&(n|=1<<23),o.animateAlways&&(n|=1<<24),o.forceUse&&(n|=1<<26),n}function Ml(o,n){return o&-96985344|Om(n)}function Rl(o){return o.ground||o.groundBorder?1:o.container?2:o.splash?11:o.fluidContainer?12:0}var qr=(o=>(o[o.Human=1]="Human",o[o.Demon=2]="Demon",o[o.Orc=4]="Orc",o))(qr||{});const Cf=7;var gs=(o=>(o[o.Male=1]="Male",o[o.Female=2]="Female",o))(gs||{});const Ef=3;var xs=(o=>(o[o.Free=1]="Free",o[o.Noble=2]="Noble",o))(xs||{});const ac=3;function Um(o,n,i,a){for(let d=i;d>=n;d--){const m=o.things.get(d);m&&(m.id=d+1,o.things.set(d+1,m),o.things.delete(d))}const l=new Set;for(const d of a)l.add(d>=n?d+1:d);return l}function zm(o,n,i,a){for(let d=n+1;d<=i;d++){const m=o.things.get(d);m&&(m.id=d-1,o.things.set(d-1,m),o.things.delete(d))}const l=new Set;for(const d of a)d!==n&&l.add(d>n?d-1:d);return l}function Qd(o,n,i){const a=o.itemCount+o.outfitCount+o.effectCount+o.distanceCount;let l,d;switch(n){case"item":o.itemCount++,l=o.itemCount,d=l;break;case"outfit":o.outfitCount++,l=o.itemCount+o.outfitCount,d=l;break;case"effect":o.effectCount++,l=o.itemCount+o.outfitCount+o.effectCount,d=l;break;case"distance":o.distanceCount++,l=o.itemCount+o.outfitCount+o.effectCount+o.distanceCount,d=l+1;break}const m=d<=a?Um(o,d,a,i):new Set(i);return m.add(l),{insertId:l,dirtyIds:m}}function Hm(o,n){return{loadHairDefinitions:i=>{var l;const a=[];for(const[d,m]of Object.entries(i)){const h=parseInt(d,10);isNaN(h)||a.push({hairId:h,name:m.name??`Hair ${h}`,outfitId:m.outfitId??h,races:m.races??Cf,genders:m.genders??Ef,tiers:m.tiers??ac,sortOrder:m.sortOrder??0})}a.sort((d,m)=>d.sortOrder-m.sortOrder||d.hairId-m.hairId),o({hairDefinitions:a,hairDefsLoaded:!0,selectedHairId:((l=a[0])==null?void 0:l.hairId)??null}),console.log(`[OB] Loaded ${a.length} hair definitions`)},addHairDefinition:i=>{const a=[...n().hairDefinitions,i];a.sort((l,d)=>l.sortOrder-d.sortOrder||l.hairId-d.hairId),o({hairDefinitions:a,selectedHairId:i.hairId,dirty:!0,editVersion:n().editVersion+1})},updateHairDefinition:(i,a)=>{const l=n().hairDefinitions.map(d=>d.hairId===i?{...d,...a}:d);l.sort((d,m)=>d.sortOrder-m.sortOrder||d.hairId-m.hairId),o({hairDefinitions:l,dirty:!0,editVersion:n().editVersion+1})},removeHairDefinition:i=>{var d;const a=n().hairDefinitions.filter(m=>m.hairId!==i),{selectedHairId:l}=n();o({hairDefinitions:a,selectedHairId:l===i?((d=a[0])==null?void 0:d.hairId)??null:l,dirty:!0,editVersion:n().editVersion+1})},duplicateHairDefinition:i=>{const a=n().hairDefinitions.find(p=>p.hairId===i);if(!a)return;const l=new Set(n().hairDefinitions.map(p=>p.hairId));let d=a.hairId+1;for(;l.has(d);)d++;const m={...a,hairId:d,name:`${a.name} (copy)`},h=[...n().hairDefinitions,m];h.sort((p,v)=>p.sortOrder-v.sortOrder||p.hairId-v.hairId),o({hairDefinitions:h,selectedHairId:d,dirty:!0,editVersion:n().editVersion+1})},setSelectedHairId:i=>o({selectedHairId:i}),exportHairDefinitionsJson:()=>{const a=[...n().hairDefinitions].sort((d,m)=>d.hairId-m.hairId),l={};for(const d of a)l[String(d.hairId)]={name:d.name,outfitId:d.outfitId,races:d.races,genders:d.genders,tiers:d.tiers,sortOrder:d.sortOrder};return JSON.stringify(l,null,4)}}}function $m(o,n){return{loadSpriteMap:i=>{const a=Array.isArray(i.items)?i.items:[];o({spriteMapEntries:a,spriteMapLoaded:!0}),console.log(`[OB] Loaded sprite map: ${a.length} entries`)},updateSpriteMapEntry:(i,a)=>{const l=[...n().spriteMapEntries];l[i]=a,o({spriteMapEntries:l,dirty:!0,editVersion:n().editVersion+1})},addSpriteMapEntry:i=>{const a=[i,...n().spriteMapEntries];o({spriteMapEntries:a,dirty:!0,editVersion:n().editVersion+1})},removeSpriteMapEntry:i=>{const a=n().spriteMapEntries.filter((l,d)=>d!==i);o({spriteMapEntries:a,dirty:!0,editVersion:n().editVersion+1})},exportSpriteMapJson:()=>JSON.stringify({items:n().spriteMapEntries},null,2)}}function Gm(o,n){return{compactSpriteAtlas:()=>{const{objectData:i,spriteData:a,spriteOverrides:l,dirtySpriteIds:d,editVersion:m}=n();if(!i||!a)return null;const h=a.spriteCount,p=new Set;for(const T of i.things.values())for(const A of T.frameGroups)for(const G of A.sprites)G>0&&p.add(G);const v=new Set;for(let T=1;T<=h;T++){if(p.has(T)){v.add(T);continue}const A=a.addresses.has(T),G=l.get(T);if(G){let M=!1;for(let Z=3;Z<G.data.length;Z+=4)if(G.data[Z]>0){M=!0;break}M&&v.add(T)}else A&&v.add(T)}const S=h-v.size;if(S===0)return{removed:0,oldCount:h,newCount:h};const g=new Map;let w=1;for(let T=1;T<=h;T++)v.has(T)&&(g.set(T,w),w++);const _=w-1,E=new Set;for(const T of i.things.values()){let A=!1;for(const G of T.frameGroups)for(let M=0;M<G.sprites.length;M++){const Z=G.sprites[M];if(Z===0)continue;const de=g.get(Z);de!=null&&de!==Z?(G.sprites[M]=de,A=!0):de==null&&(G.sprites[M]=0,A=!0)}A&&(T.rawBytes=void 0,E.add(T.id))}const P=new Map;for(const[T,A]of l){const G=g.get(T);G!=null&&P.set(G,A)}const k=new Set;for(const T of d){const A=g.get(T);A!=null&&k.add(A)}for(let T=1;T<=_;T++)k.add(T);const N=new Map;for(const[T,A]of a.addresses){const G=g.get(T);G!=null&&N.set(G,A)}a.addresses=N,a.spriteCount=_;const D=new Set(n().dirtyIds);for(const T of E)D.add(T);return zn(),o({dirty:!0,dirtyIds:D,spriteOverrides:P,dirtySpriteIds:k,editVersion:m+1}),console.log(`[OB] Compacted sprite atlas: ${h}  ${_} (removed ${S} blank/unreferenced sprites)`),{removed:S,oldCount:h,newCount:_}}}}const I=Dm((o,n)=>({objectData:null,spriteData:null,loaded:!1,loading:!1,error:null,dirty:!1,dirtyIds:new Set,undoStack:[],redoStack:[],spriteOverrides:new Map,dirtySpriteIds:new Set,itemDefinitions:new Map,clientToServerIds:new Map,definitionsLoaded:!1,spriteMapEntries:[],spriteMapLoaded:!1,hairDefinitions:[],hairDefsLoaded:!1,selectedHairId:null,sourceDir:null,sourceNames:{},sourceHandles:{},centerTab:"texture",activeCategory:"item",selectedThingId:null,selectedThingIds:new Set,searchQuery:"",filterGroup:-1,editVersion:0,focusSpriteId:null,importTileSize:1,selectedSlots:[],copiedThing:null,activeLayer:0,blendLayers:!1,currentFrame:0,playing:!1,outfitColors:{head:0,body:0,legs:0,feet:0},showColorPicker:null,loadFiles:async(i,a)=>{o({loading:!0,error:null});try{const l=Pm(i),d=await Im(a),m=Mm(d);zn(),o({objectData:l,spriteData:m,loaded:!0,loading:!1,selectedThingId:100,selectedThingIds:new Set,activeCategory:"item",dirty:!1,dirtyIds:new Set,undoStack:[],redoStack:[],spriteOverrides:new Map,dirtySpriteIds:new Set,editVersion:0,focusSpriteId:null,copiedThing:null,...n().definitionsLoaded?{}:{itemDefinitions:new Map,clientToServerIds:new Map,definitionsLoaded:!1},...n().spriteMapLoaded?{}:{spriteMapEntries:[],spriteMapLoaded:!1}})}catch(l){o({error:l instanceof Error?l.message:String(l),loading:!1})}},loadDefinitions:i=>{const a=new Map,l=new Map;for(const[m,h]of Object.entries(i)){const p=parseInt(m,10);if(isNaN(p))continue;const v=h.id??p;a.set(p,{serverId:p,id:v,flags:h.flags??0,group:h.group??0,properties:h.properties?{...h.properties}:null}),(!l.has(v)||p===v)&&l.set(v,p)}o({itemDefinitions:a,clientToServerIds:l,definitionsLoaded:!0}),console.log(`[OB] Loaded ${a.size} definitions (by serverId), ${l.size} clientserver mappings`);const d=n().objectData;if(d){let m=0;for(const h of a.values()){const p=h.id??0;(p>d.itemCount||p<100)&&m++}m>0&&console.warn(`[OB]  ${m} definitions reference clientIds outside the .eobj range (100${d.itemCount}). These items will be invisible in-game.`)}},setSourceDir:(i,a)=>{o({sourceDir:i,sourceNames:{...n().sourceNames,...a}})},setSourceHandles:i=>{o({sourceHandles:{...n().sourceHandles,...i}})},setCenterTab:i=>o({centerTab:i}),setActiveCategory:i=>{const a=n().getCategoryRange(i);o({activeCategory:i,selectedThingId:a?a.start:null,selectedThingIds:new Set,searchQuery:"",filterGroup:-1})},setSelectedThingId:i=>o({selectedThingId:i,selectedThingIds:new Set}),toggleThingSelection:(i,a)=>{const l=n().selectedThingIds,d=new Set(l);if(a)for(const m of a)d.add(m);else d.has(i)?d.delete(i):d.add(i);o({selectedThingIds:d,selectedThingId:i})},clearThingSelection:()=>o({selectedThingIds:new Set}),setSearchQuery:i=>o({searchQuery:i}),setFilterGroup:i=>o({filterGroup:i}),reset:()=>{zn(),o({objectData:null,spriteData:null,loaded:!1,loading:!1,error:null,activeCategory:"item",selectedThingId:null,searchQuery:"",filterGroup:-1,dirty:!1,dirtyIds:new Set,undoStack:[],redoStack:[],spriteOverrides:new Map,dirtySpriteIds:new Set,editVersion:0,focusSpriteId:null,copiedThing:null,itemDefinitions:new Map,clientToServerIds:new Map,definitionsLoaded:!1,spriteMapEntries:[],spriteMapLoaded:!1,hairDefinitions:[],hairDefsLoaded:!1,selectedHairId:null,sourceHandles:{}})},updateItemDefinition:(i,a)=>{const{itemDefinitions:l,clientToServerIds:d,editVersion:m}=n(),h=d.get(i)??i,p=l.get(h),v={serverId:h,id:a.id??(p==null?void 0:p.id)??i,flags:a.flags??(p==null?void 0:p.flags)??0,group:a.group??(p==null?void 0:p.group)??0,properties:a.properties!==void 0?a.properties?{...(p==null?void 0:p.properties)??{},...a.properties}:null:p!=null&&p.properties?{...p.properties}:null},S=new Map(l);S.set(h,v);const g=new Map(d);g.has(i)||g.set(i,h),o({itemDefinitions:S,clientToServerIds:g,dirty:!0,editVersion:m+1})},updateThingFlags:(i,a)=>{const{objectData:l,undoStack:d,dirtyIds:m,editVersion:h,itemDefinitions:p}=n();if(!l)return;const v=l.things.get(i);if(!v)return;const S={...v.flags};v.flags=a,v.rawBytes=void 0;const g=new Set(m);if(g.add(i),v.category==="item"){const{clientToServerIds:w}=n(),_=w.get(i)??i,E=p.get(_),P=(E==null?void 0:E.flags)??0,k=Ml(P,a),N=Rl(a),D=E!=null&&E.properties?{...E.properties}:{};a.ground&&a.groundSpeed!=null&&a.groundSpeed!==100?D.friction=a.groundSpeed:delete D.friction;const T={serverId:_,id:(E==null?void 0:E.id)??i,flags:k,group:N,properties:Object.keys(D).length>0?D:null},A=new Map(p);A.set(_,T),o({dirty:!0,dirtyIds:g,undoStack:[...d,{thingId:i,oldFlags:S,newFlags:{...a}}],redoStack:[],editVersion:h+1,itemDefinitions:A})}else o({dirty:!0,dirtyIds:g,undoStack:[...d,{thingId:i,oldFlags:S,newFlags:{...a}}],redoStack:[],editVersion:h+1})},undo:()=>{const{objectData:i,undoStack:a,redoStack:l,editVersion:d,itemDefinitions:m}=n();if(!i||a.length===0)return;const h=a[a.length-1],p=i.things.get(h.thingId);if(p&&(p.flags={...h.oldFlags},p.category==="item")){const{clientToServerIds:v}=n(),S=v.get(h.thingId)??h.thingId,g=m.get(S),w=new Map(m);w.set(S,{serverId:S,id:(g==null?void 0:g.id)??h.thingId,flags:Ml((g==null?void 0:g.flags)??0,h.oldFlags),group:Rl(h.oldFlags),properties:g!=null&&g.properties?{...g.properties}:null}),o({undoStack:a.slice(0,-1),redoStack:[...l,h],editVersion:d+1,itemDefinitions:w});return}o({undoStack:a.slice(0,-1),redoStack:[...l,h],editVersion:d+1})},redo:()=>{const{objectData:i,undoStack:a,redoStack:l,editVersion:d,itemDefinitions:m}=n();if(!i||l.length===0)return;const h=l[l.length-1],p=i.things.get(h.thingId);if(p&&(p.flags={...h.newFlags},p.category==="item")){const{clientToServerIds:v}=n(),S=v.get(h.thingId)??h.thingId,g=m.get(S),w=new Map(m);w.set(S,{serverId:S,id:(g==null?void 0:g.id)??h.thingId,flags:Ml((g==null?void 0:g.flags)??0,h.newFlags),group:Rl(h.newFlags),properties:g!=null&&g.properties?{...g.properties}:null}),o({undoStack:[...a,h],redoStack:l.slice(0,-1),editVersion:d+1,itemDefinitions:w});return}o({undoStack:[...a,h],redoStack:l.slice(0,-1),editVersion:d+1})},replaceSprite:(i,a)=>{const{spriteOverrides:l,dirtySpriteIds:d,editVersion:m}=n(),h=new Map(l);h.set(i,a);const p=new Set(d);p.add(i),Pl(i),o({dirty:!0,spriteOverrides:h,dirtySpriteIds:p,editVersion:m+1})},addSprite:i=>{const{spriteData:a,spriteOverrides:l,dirtySpriteIds:d,editVersion:m}=n();if(!a)return null;a.spriteCount++;const h=a.spriteCount,p=new Map(l);p.set(h,i);const v=new Set(d);return v.add(h),o({dirty:!0,spriteOverrides:p,dirtySpriteIds:v,editVersion:m+1}),h},deleteSprite:i=>{const{spriteOverrides:a,dirtySpriteIds:l,editVersion:d}=n();if(i<=0)return;const m=new ImageData(32,32),h=new Map(a);h.set(i,m);const p=new Set(l);p.add(i),Pl(i),o({dirty:!0,spriteOverrides:h,dirtySpriteIds:p,editVersion:d+1})},deleteSprites:i=>{const{spriteOverrides:a,dirtySpriteIds:l,editVersion:d}=n();if(i.length===0)return;const m=new ImageData(32,32),h=new Map(a),p=new Set(l);for(const v of i)v<=0||(h.set(v,m),p.add(v),Pl(v));o({dirty:!0,spriteOverrides:h,dirtySpriteIds:p,editVersion:d+1})},addThing:i=>{const{objectData:a,editVersion:l}=n();if(!a)return null;const{insertId:d,dirtyIds:m}=Qd(a,i,n().dirtyIds),v={id:d,category:i,flags:{ground:!1,groundBorder:!1,onBottom:!1,onTop:!1,container:!1,stackable:!1,forceUse:!1,multiUse:!1,writable:!1,writableOnce:!1,fluidContainer:!1,splash:!1,notWalkable:!1,notMoveable:!1,blockProjectile:!1,notPathable:!1,pickupable:!1,hangable:!1,hookSouth:!1,hookEast:!1,rotateable:!1,hasLight:!1,dontHide:!1,translucent:!1,hasDisplacement:!1,hasElevation:!1,lyingCorpse:!1,animateAlways:!1,hasMinimapColor:!1,fullGround:!1,look:!1,cloth:!1,hasMarket:!1,usable:!1,wrapable:!1,unwrapable:!1,topEffect:!1,noMoveAnimation:!1,chargeable:!1},frameGroups:[{type:0,width:1,height:1,layers:1,patternX:1,patternY:1,patternZ:1,animationLength:1,asynchronous:0,nLoop:0,start:0,animationLengths:[{min:0,max:0}],sprites:[0]}]};a.things.set(d,v),m.add(d);const S={dirty:!0,dirtyIds:m,selectedThingId:d,editVersion:l+1};if(i==="item"&&n().definitionsLoaded){const{itemDefinitions:g,clientToServerIds:w}=n(),_=w.get(d);let E=0;for(const T of g.keys())T>E&&(E=T);const P=E+1,k={serverId:P,id:d,flags:0,group:0,properties:null},N=new Map(g);N.set(P,k);const D=new Map(w);D.set(d,P),S.itemDefinitions=N,S.clientToServerIds=D,_!=null?console.log(`[OB] Auto-created definition: serverId=${P} clientId=${d} (overriding stale mapping to serverId=${_})`):console.log(`[OB] Auto-created definition: serverId=${P} clientId=${d}`)}return o(S),d},removeThing:i=>{const{objectData:a,editVersion:l,activeCategory:d}=n();if(!a||!a.things.get(i))return;const h=n().getCategoryRange(d);if(!h)return;const p=h.end;if(i!==p)return;const v=a.itemCount+a.outfitCount+a.effectCount+a.distanceCount;switch(a.things.delete(i),d){case"item":a.itemCount--;break;case"outfit":a.outfitCount--;break;case"effect":a.effectCount--;break;case"distance":a.distanceCount--;break}const S=zm(a,i,v,n().dirtyIds),g=i>h.start?i-1:h.start;o({dirty:!0,dirtyIds:S,selectedThingId:a.things.has(g)?g:null,editVersion:l+1})},importThing:(i,a,l,d)=>{const{objectData:m,spriteData:h,editVersion:p,spriteOverrides:v,dirtySpriteIds:S}=n();if(!m||!h)return null;const{insertId:g,dirtyIds:w}=Qd(m,i,n().dirtyIds),_=new Map(v),E=new Set(S),P=new Map;for(const[D,T]of d){if(D===0||P.has(D))continue;h.spriteCount++;const A=h.spriteCount;P.set(D,A),_.set(A,T),E.add(A)}const k=l.map((D,T)=>({...D,type:T,sprites:D.sprites.map(A=>A===0?0:P.get(A)??A),animationLengths:D.animationLengths.map(A=>({...A}))})),N={id:g,category:i,flags:{...a},frameGroups:k};return m.things.set(g,N),zn(),o({dirty:!0,dirtyIds:w,spriteOverrides:_,dirtySpriteIds:E,selectedThingId:g,activeCategory:i,editVersion:p+1}),g},replaceThing:(i,a,l,d)=>{const{objectData:m,spriteData:h,editVersion:p,spriteOverrides:v,dirtySpriteIds:S}=n();if(!m||!h)return!1;const g=m.things.get(i);if(!g)return!1;const w=new Map(v),_=new Set(S),E=new Map;for(const[D,T]of d){if(D===0||E.has(D))continue;h.spriteCount++;const A=h.spriteCount;E.set(D,A),w.set(A,T),_.add(A)}const P=l.map((D,T)=>({...D,type:T,sprites:D.sprites.map(A=>A===0?0:E.get(A)??A),animationLengths:D.animationLengths.map(A=>({...A}))})),k={id:i,category:g.category,flags:{...a},frameGroups:P};m.things.set(i,k);const N=new Set(n().dirtyIds);return N.add(i),zn(),o({dirty:!0,dirtyIds:N,spriteOverrides:w,dirtySpriteIds:_,editVersion:p+1}),!0},...$m(o,n),...Hm(o,n),...Gm(o,n),markClean:()=>{const i=n().objectData;if(i)for(const a of i.things.values())a.rawBytes=void 0;o({dirty:!1,dirtyIds:new Set,dirtySpriteIds:new Set,spriteOverrides:new Map})},getCategoryRange:i=>{const a=n().objectData;if(!a)return null;switch(i){case"item":return{start:100,end:a.itemCount};case"outfit":return{start:a.itemCount+1,end:a.itemCount+a.outfitCount};case"effect":return{start:a.itemCount+a.outfitCount+1,end:a.itemCount+a.outfitCount+a.effectCount};case"distance":return{start:a.itemCount+a.outfitCount+a.effectCount+1,end:a.itemCount+a.outfitCount+a.effectCount+a.distanceCount}}}}));function Hn(o,n){return n<=o.itemCount?n:n<=o.itemCount+o.outfitCount?n-o.itemCount:n<=o.itemCount+o.outfitCount+o.effectCount?n-o.itemCount-o.outfitCount:n-o.itemCount-o.outfitCount-o.effectCount}function Vm(o,n,i,a,l,d,m){var S;if(!o)return[];const h=l(n);if(!h)return[];const p=i.trim().toLowerCase(),v=[];for(let g=h.start;g<=h.end;g++){const w=o.things.get(g);if(w){if(a>=0&&m&&d){const _=m.get(g),E=_!=null?d.get(_):void 0;if(!E||E.group!==a)continue}if(p){let P=Hn(o,g).toString().includes(p);if(!P&&m&&d){const k=m.get(g);if(k!=null){k.toString().includes(p)&&(P=!0);const N=d.get(k);!P&&((S=N==null?void 0:N.properties)!=null&&S.name)&&(P=N.properties.name.toLowerCase().includes(p))}}if(!P)continue}v.push(w)}}return v}/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wm=o=>o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Nf=(...o)=>o.filter((n,i,a)=>!!n&&n.trim()!==""&&a.indexOf(n)===i).join(" ").trim();/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ym={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xm=H.forwardRef(({color:o="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:l="",children:d,iconNode:m,...h},p)=>H.createElement("svg",{ref:p,...Ym,width:n,height:n,stroke:o,strokeWidth:a?Number(i)*24/Number(n):i,className:Nf("lucide",l),...h},[...m.map(([v,S])=>H.createElement(v,S)),...Array.isArray(d)?d:[d]]));/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=(o,n)=>{const i=H.forwardRef(({className:a,...l},d)=>H.createElement(Xm,{ref:d,iconNode:n,className:Nf(`lucide-${Wm(o)}`,a),...l}));return i.displayName=`${o}`,i};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Km=Pe("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zd=Pe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lc=Pe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qm=Pe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Df=Pe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qd=Pe("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zm=Pe("ClipboardPaste",[["path",{d:"M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z",key:"1pp7kr"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10",key:"2ik1ml"}],["path",{d:"m17 10 4 4-4 4",key:"vp2hj1"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jf=Pe("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qm=Pe("Crop",[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cc=Pe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jm=Pe("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0=Pe("FileWarning",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Af=Pe("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t0=Pe("Grid2x2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0=Pe("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r0=Pe("ImageDown",[["path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10l-3.1-3.1a2 2 0 0 0-2.814.014L6 21",key:"9csbqa"}],["path",{d:"m14 19 3 3v-5.5",key:"9ldu5r"}],["path",{d:"m17 22 3-3",key:"1nkfve"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=Pe("ImageUp",[["path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10l-3.1-3.1a2 2 0 0 0-2.814.014L6 21",key:"9csbqa"}],["path",{d:"m14 19.5 3-3 3 3",key:"9vmjn0"}],["path",{d:"M17 22v-5.5",key:"1aa6fl"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s0=Pe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=Pe("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o0=Pe("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0=Pe("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l0=Pe("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=Pe("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0=Pe("PinOff",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M15 9.34V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H7.89",key:"znwnzq"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v1.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h11",key:"c9qhm2"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jd=Pe("Pin",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=Pe("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=Pe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f0=Pe("Redo2",[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h0=Pe("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ii=Pe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p0=Pe("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m0=Pe("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Di=Pe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g0=Pe("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x0=Pe("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const If=Pe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=Pe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y0=Pe("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v0=Pe("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),w0="emperia-ob",b0=2,ji="dir-handles",Ai="file-handles",Tf="last-source-dir",Lf="last-session";function Ko(){return new Promise((o,n)=>{const i=indexedDB.open(w0,b0);i.onupgradeneeded=()=>{const a=i.result;a.objectStoreNames.contains(ji)||a.createObjectStore(ji),a.objectStoreNames.contains(Ai)||a.createObjectStore(Ai)},i.onsuccess=()=>o(i.result),i.onerror=()=>n(i.error)})}async function k0(o){try{const n=await Ko(),i=n.transaction(ji,"readwrite");i.objectStore(ji).put(o,Tf),await new Promise((a,l)=>{i.oncomplete=()=>a(),i.onerror=()=>l(i.error)}),n.close()}catch(n){console.warn("[OB] Failed to save dir handle:",n)}}async function S0(){try{const o=await Ko(),i=o.transaction(ji,"readonly").objectStore(ji).get(Tf),a=await new Promise((l,d)=>{i.onsuccess=()=>l(i.result??null),i.onerror=()=>d(i.error)});return o.close(),a}catch(o){return console.warn("[OB] Failed to load dir handle:",o),null}}async function _0(o){try{const n=await Ko(),i=n.transaction(Ai,"readwrite");i.objectStore(Ai).put(o,Lf),await new Promise((a,l)=>{i.oncomplete=()=>a(),i.onerror=()=>l(i.error)}),n.close(),console.log("[OB] Saved session handles")}catch(n){console.warn("[OB] Failed to save session handles:",n)}}async function ef(){try{const o=await Ko(),i=o.transaction(Ai,"readonly").objectStore(Ai).get(Lf),a=await new Promise((l,d)=>{i.onsuccess=()=>l(i.result??null),i.onerror=()=>d(i.error)});return o.close(),a}catch(o){return console.warn("[OB] Failed to load session handles:",o),null}}async function C0(o,n="readwrite"){const i={mode:n};return await o.queryPermission(i)==="granted"||await o.requestPermission(i)==="granted"}function E0(){const o=I(b=>b.loadFiles),n=I(b=>b.loading),i=I(b=>b.error),[a,l]=H.useState(!1),d=I(b=>b.loadDefinitions),m=I(b=>b.loadSpriteMap),h=I(b=>b.loadHairDefinitions),p=I(b=>b.setSourceDir),v=I(b=>b.setSourceHandles),S=H.useRef(null),g=H.useRef(null),[w,_]=H.useState(null),[E,P]=H.useState(null),[k,N]=H.useState(null),[D,T]=H.useState(null),[A,G]=H.useState(null),M=H.useRef(null),Z=H.useRef(null),de=H.useRef(null),he=H.useRef(null),Se=H.useRef({}),[Ee,_e]=H.useState(!1),[Y,re]=H.useState(null);H.useEffect(()=>{S0().then(b=>{b&&(he.current=b)}),ef().then(b=>{b&&(b.obj||b.spr)&&_e(!0)})},[]);const ve=H.useCallback(b=>{_0(b)},[]),ge=H.useCallback(()=>{if(!(!S.current||!g.current)){if(M.current){try{const b=new TextDecoder().decode(M.current),V=JSON.parse(b);d(V)}catch(b){console.error("Failed to parse definitions JSON:",b)}M.current=null}if(Z.current){try{const b=new TextDecoder().decode(Z.current),V=JSON.parse(b);m(V)}catch(b){console.error("Failed to parse item-to-sprite JSON:",b)}Z.current=null}if(de.current){try{const b=new TextDecoder().decode(de.current),V=JSON.parse(b);h(V)}catch(b){console.error("Failed to parse hair-definitions JSON:",b)}de.current=null}o(S.current,g.current),(Se.current.obj||Se.current.spr)&&(ve(Se.current),v(Se.current))}},[o,d,m,h,ve,v]),ie=H.useCallback(b=>{var ee;const V=(ee=b.name.split(".").pop())==null?void 0:ee.toLowerCase(),Q=new FileReader;Q.onload=K=>{var ae;const oe=(ae=K.target)==null?void 0:ae.result;if(V==="dat"||V==="eobj")S.current=oe,_(b.name);else if(V==="spr"||V==="espr")g.current=oe,P(b.name);else if(V==="json"){const Ce=b.name.toLowerCase();Ce.includes("item-to-sprite")||Ce.includes("sprite-map")||Ce.includes("spritemap")?(Z.current=oe,T(b.name)):Ce.includes("hair-definition")||Ce.includes("hair_definition")?(de.current=oe,G(b.name)):(M.current=oe,N(b.name))}ge()},Q.readAsArrayBuffer(b)},[ge]),X=H.useCallback(async()=>{var b;if(typeof window.showDirectoryPicker=="function")try{const V={mode:"readwrite"};he.current&&(V.startIn=he.current);const Q=await window.showDirectoryPicker(V),ee={},K={dir:Q};for await(const[oe,ae]of Q.entries()){if(ae.kind!=="file")continue;const Ce=(b=oe.split(".").pop())==null?void 0:b.toLowerCase();if((Ce==="eobj"||Ce==="dat")&&!ee.obj){ee.obj=oe,K.obj=ae;const Le=await ae.getFile();S.current=await Le.arrayBuffer(),_(oe)}else if((Ce==="espr"||Ce==="spr")&&!ee.spr){ee.spr=oe,K.spr=ae;const Le=await ae.getFile();g.current=await Le.arrayBuffer(),P(oe)}else if(Ce==="json"&&oe.toLowerCase().includes("definition")&&!ee.def){ee.def=oe,K.def=ae;const Le=await ae.getFile();M.current=await Le.arrayBuffer(),N(oe)}else if(Ce==="json"&&(oe.toLowerCase().includes("item-to-sprite")||oe.toLowerCase().includes("sprite-map"))&&!ee.spriteMap){ee.spriteMap=oe,K.spriteMap=ae;const Le=await ae.getFile();Z.current=await Le.arrayBuffer(),T(oe)}else if(Ce==="json"&&(oe.toLowerCase().includes("hair-definition")||oe.toLowerCase().includes("hair_definition"))&&!ee.hairDefs){ee.hairDefs=oe,K.hairDefs=ae;const Le=await ae.getFile();de.current=await Le.arrayBuffer(),G(oe)}}Se.current=K,p(Q,ee),he.current=Q,k0(Q),console.log("[OB] Opened folder:",Q.name,ee),ge()}catch{}},[ge,p]),ue=H.useCallback(async()=>{var Le,yt,St,vt;re(null);const b=await ef();if(!b){re("No saved session found.");return}const V=[];async function Q(Fe,y){if(!Fe)return null;try{return await C0(Fe,"readwrite")?(await Fe.getFile()).arrayBuffer():(V.push(y),null)}catch(Ue){return console.warn(`[OB] Failed to read ${y}:`,Ue),V.push(y),null}}const ee=await Q(b.obj,"Objects"),K=await Q(b.spr,"Sprites"),oe=await Q(b.def,"Definitions"),ae=await Q(b.spriteMap,"Sprite Map");if(V.length>0&&(re(`Permission denied for: ${V.join(", ")}. Click to retry.`),!ee||!K))return;if(!ee||!K){re("Required files (objects + sprites) not found in saved session.");return}if(oe)try{const Fe=new TextDecoder().decode(oe);d(JSON.parse(Fe))}catch(Fe){console.error("Failed to parse definitions:",Fe)}if(ae)try{const Fe=new TextDecoder().decode(ae);m(JSON.parse(Fe))}catch(Fe){console.error("Failed to parse sprite map:",Fe)}const Ce=await Q(b.hairDefs,"Hair Definitions");if(Ce)try{const Fe=new TextDecoder().decode(Ce);h(JSON.parse(Fe))}catch(Fe){console.error("Failed to parse hair definitions:",Fe)}if(v({obj:b.obj,spr:b.spr,def:b.def,spriteMap:b.spriteMap}),b.dir){const Fe={};b.obj&&(Fe.obj=b.obj.name),b.spr&&(Fe.spr=b.spr.name),b.def&&(Fe.def=b.def.name),b.spriteMap&&(Fe.spriteMap=b.spriteMap.name),p(b.dir,Fe)}_(((Le=b.obj)==null?void 0:Le.name)??null),P(((yt=b.spr)==null?void 0:yt.name)??null),N(((St=b.def)==null?void 0:St.name)??null),T(((vt=b.spriteMap)==null?void 0:vt.name)??null),o(ee,K)},[o,d,m,h,v,p]),te=H.useCallback(b=>{b.preventDefault(),l(!1),Array.from(b.dataTransfer.files).forEach(ie)},[ie]),B=H.useCallback(b=>{Array.from(b.target.files||[]).forEach(V=>ie(V))},[ie]);return u.jsx("div",{className:"h-full flex items-center justify-center bg-emperia-bg p-8",children:u.jsxs("div",{className:"max-w-lg w-full",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-emperia-text mb-2",children:"Emperia Object Builder"}),u.jsx("p",{className:"text-emperia-muted text-sm",children:"v1.0.0  Web Edition"})]}),u.jsxs("div",{onDragOver:b=>{b.preventDefault(),l(!0)},onDragLeave:()=>l(!1),onDrop:te,className:`
            border-2 border-dashed rounded-xl p-12 text-center cursor-pointer
            transition-all duration-200
            ${a?"border-emperia-accent bg-emperia-accent/10":"border-emperia-border hover:border-emperia-muted bg-emperia-surface"}
          `,onClick:()=>{var b;return(b=document.getElementById("file-input"))==null?void 0:b.click()},children:[u.jsx("input",{id:"file-input",type:"file",multiple:!0,accept:".dat,.spr,.eobj,.espr,.json",className:"hidden",onChange:B}),n?u.jsxs("div",{className:"flex flex-col items-center gap-3",children:[u.jsx(Bo,{className:"w-12 h-12 text-emperia-accent animate-spin"}),u.jsx("p",{className:"text-emperia-text",children:"Loading files"})]}):u.jsxs("div",{className:"flex flex-col items-center gap-3",children:[u.jsx(If,{className:"w-12 h-12 text-emperia-muted"}),u.jsx("p",{className:"text-emperia-text font-medium",children:"Drop your files here"}),u.jsxs("p",{className:"text-emperia-muted text-sm",children:["Drag & drop ",u.jsx("code",{className:"text-emperia-accent",children:".eobj"})," + ",u.jsx("code",{className:"text-emperia-accent",children:".espr"})," files",u.jsx("br",{}),"or legacy ",u.jsx("code",{className:"text-emperia-accent",children:".dat"})," + ",u.jsx("code",{className:"text-emperia-accent",children:".spr"}),u.jsx("br",{}),u.jsxs("span",{className:"text-emperia-muted/60",children:["+ optional ",u.jsx("code",{className:"text-emperia-accent",children:"definitions.json"})," & ",u.jsx("code",{className:"text-emperia-accent",children:"item-to-sprite.json"})]})]})]})]}),typeof window.showDirectoryPicker=="function"&&u.jsxs("div",{className:"mt-4 flex flex-col items-center gap-2",children:[u.jsxs("div",{className:"flex items-center gap-3 text-emperia-muted/40 text-xs w-full",children:[u.jsx("div",{className:"flex-1 h-px bg-emperia-border/40"}),u.jsx("span",{children:"or"}),u.jsx("div",{className:"flex-1 h-px bg-emperia-border/40"})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("button",{onClick:X,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-emperia-accent/10 border border-emperia-accent/30 text-emperia-accent hover:bg-emperia-accent/20 transition-colors text-sm font-medium",children:[u.jsx(Af,{className:"w-4 h-4"}),"Open Folder"]}),Ee&&u.jsxs("button",{onClick:ue,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-green-500/10 border border-green-500/30 text-green-400 hover:bg-green-500/20 transition-colors text-sm font-medium",children:[u.jsx(h0,{className:"w-4 h-4"}),"Reload Last Session"]})]}),u.jsxs("p",{className:"text-emperia-muted/50 text-[10px] text-center",children:["Auto-detects files & saves directly back on compile",Ee&&u.jsx("span",{className:"text-green-400/50",children:"  Previous session available"})]}),Y&&u.jsx("p",{className:"text-red-400 text-[10px] text-center",children:Y})]}),u.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 justify-center text-xs",children:[u.jsxs("div",{className:`flex items-center gap-1.5 ${w?"text-green-400":"text-emperia-muted"}`,children:[u.jsx("div",{className:`w-2 h-2 rounded-full ${w?"bg-green-400":"bg-emperia-border"}`}),w||"Objects (.eobj / .dat)"]}),u.jsxs("div",{className:`flex items-center gap-1.5 ${E?"text-green-400":"text-emperia-muted"}`,children:[u.jsx("div",{className:`w-2 h-2 rounded-full ${E?"bg-green-400":"bg-emperia-border"}`}),E||"Sprites (.espr / .spr)"]}),u.jsxs("div",{className:`flex items-center gap-1.5 ${k?"text-green-400":"text-emperia-muted/50"}`,children:[u.jsx("div",{className:`w-2 h-2 rounded-full ${k?"bg-green-400":"bg-emperia-border/50"}`}),k||"Definitions (.json)  optional"]}),u.jsxs("div",{className:`flex items-center gap-1.5 ${D?"text-green-400":"text-emperia-muted/50"}`,children:[u.jsx("div",{className:`w-2 h-2 rounded-full ${D?"bg-green-400":"bg-emperia-border/50"}`}),D||"Sprite Map (.json)  optional"]}),u.jsxs("div",{className:`flex items-center gap-1.5 ${A?"text-green-400":"text-emperia-muted/50"}`,children:[u.jsx("div",{className:`w-2 h-2 rounded-full ${A?"bg-green-400":"bg-emperia-border/50"}`}),A||"Hair Definitions (.json)  optional"]})]}),i&&u.jsxs("div",{className:"mt-4 p-3 rounded-lg bg-red-500/10 border border-red-500/30 flex items-start gap-2",children:[u.jsx(e0,{className:"w-4 h-4 text-red-400 mt-0.5 shrink-0"}),u.jsx("p",{className:"text-red-300 text-sm",children:i})]})]})})}class Bf{constructor(n=4096){$(this,"chunks",[]);$(this,"current");$(this,"pos",0);this.current=new Uint8Array(n)}ensure(n){if(this.pos+n<=this.current.length)return;this.chunks.push(this.current.slice(0,this.pos));const i=Math.max(this.current.length*2,n+1024);this.current=new Uint8Array(i),this.pos=0}writeUInt8(n){this.ensure(1),this.current[this.pos++]=n&255}writeInt8(n){this.ensure(1),this.current[this.pos++]=n&255}writeUInt16(n){this.ensure(2),this.current[this.pos++]=n&255,this.current[this.pos++]=n>>8&255}writeUInt32(n){this.ensure(4),this.current[this.pos++]=n&255,this.current[this.pos++]=n>>8&255,this.current[this.pos++]=n>>16&255,this.current[this.pos++]=n>>24&255}writeBytes(n){this.ensure(n.length),this.current.set(n,this.pos),this.pos+=n.length}writeString(n){const i=new TextEncoder().encode(n);this.writeUInt16(i.length),this.ensure(i.length),this.current.set(i,this.pos),this.pos+=i.length}toArrayBuffer(){this.chunks.push(this.current.slice(0,this.pos));const n=this.chunks.reduce((l,d)=>l+d.length,0),i=new Uint8Array(n);let a=0;for(const l of this.chunks)i.set(l,a),a+=l.length;return this.chunks=[],this.current=new Uint8Array(4096),this.pos=0,i.buffer}}const Te={ThingAttrGround:0,ThingAttrGroundBorder:1,ThingAttrOnBottom:2,ThingAttrOnTop:3,ThingAttrContainer:4,ThingAttrStackable:5,ThingAttrForceUse:6,ThingAttrMultiUse:7,ThingAttrWritable:8,ThingAttrWritableOnce:9,ThingAttrFluidContainer:10,ThingAttrSplash:11,ThingAttrNotWalkable:12,ThingAttrNotMoveable:13,ThingAttrBlockProjectile:14,ThingAttrNotPathable:15,ThingAttrPickupable:16,ThingAttrHangable:17,ThingAttrHookSouth:18,ThingAttrHookEast:19,ThingAttrRotateable:20,ThingAttrLight:21,ThingAttrDontHide:22,ThingAttrTranslucent:23,ThingAttrDisplacement:24,ThingAttrElevation:25,ThingAttrLyingCorpse:26,ThingAttrAnimateAlways:27,ThingAttrMinimapColor:28,ThingAttrLensHelp:29,ThingAttrFullGround:30,ThingAttrLook:31,ThingAttrCloth:32,ThingAttrMarket:33,ThingAttrUsable:34,ThingAttrWrapable:35,ThingAttrUnwrapable:36,ThingAttrTopEffect:37,ThingAttrNoMoveAnimation:253,ThingAttrChargeable:254,ThingAttrLast:255};function N0(o,n,i){const a=l=>{if(i>=1e3){if(l===Te.ThingAttrNoMoveAnimation){o.writeUInt8(16);return}if(l===Te.ThingAttrChargeable){o.writeUInt8(Te.ThingAttrChargeable+1);return}if(l>=16){o.writeUInt8(l+1);return}}o.writeUInt8(l)};n.ground&&(a(Te.ThingAttrGround),o.writeUInt16(n.groundSpeed??0)),n.groundBorder&&a(Te.ThingAttrGroundBorder),n.onBottom&&a(Te.ThingAttrOnBottom),n.onTop&&a(Te.ThingAttrOnTop),n.container&&a(Te.ThingAttrContainer),n.stackable&&a(Te.ThingAttrStackable),n.forceUse&&a(Te.ThingAttrForceUse),n.multiUse&&a(Te.ThingAttrMultiUse),n.writable&&(a(Te.ThingAttrWritable),o.writeUInt16(n.writableMaxLen??0)),n.writableOnce&&(a(Te.ThingAttrWritableOnce),o.writeUInt16(n.writableOnceMaxLen??0)),n.fluidContainer&&a(Te.ThingAttrFluidContainer),n.splash&&a(Te.ThingAttrSplash),n.notWalkable&&a(Te.ThingAttrNotWalkable),n.notMoveable&&a(Te.ThingAttrNotMoveable),n.blockProjectile&&a(Te.ThingAttrBlockProjectile),n.notPathable&&a(Te.ThingAttrNotPathable),n.pickupable&&a(Te.ThingAttrPickupable),n.hangable&&a(Te.ThingAttrHangable),n.hookSouth&&a(Te.ThingAttrHookSouth),n.hookEast&&a(Te.ThingAttrHookEast),n.rotateable&&a(Te.ThingAttrRotateable),n.hasLight&&(a(Te.ThingAttrLight),o.writeUInt16(n.lightLevel??0),o.writeUInt16(n.lightColor??0)),n.dontHide&&a(Te.ThingAttrDontHide),n.translucent&&a(Te.ThingAttrTranslucent),n.hasDisplacement&&(a(Te.ThingAttrDisplacement),i>=755&&(o.writeUInt16((n.displacementX??0)&65535),o.writeUInt16((n.displacementY??0)&65535))),n.hasElevation&&(a(Te.ThingAttrElevation),o.writeUInt16(n.elevation??0)),n.lyingCorpse&&a(Te.ThingAttrLyingCorpse),n.animateAlways&&a(Te.ThingAttrAnimateAlways),n.hasMinimapColor&&(a(Te.ThingAttrMinimapColor),o.writeUInt16(n.minimapColor??0)),n.lensHelp!=null&&(a(Te.ThingAttrLensHelp),o.writeUInt16(n.lensHelp)),n.fullGround&&a(Te.ThingAttrFullGround),n.look&&a(Te.ThingAttrLook),n.cloth&&(a(Te.ThingAttrCloth),o.writeUInt16(n.clothSlot??0)),n.hasMarket&&(a(Te.ThingAttrMarket),o.writeUInt16(n.marketCategory??0),o.writeUInt16(n.marketTradeAs??0),o.writeUInt16(n.marketShowAs??0),o.writeString(n.marketName??""),o.writeUInt16(n.marketRestrictVocation??0),o.writeUInt16(n.marketRequiredLevel??0)),n.usable&&(a(Te.ThingAttrUsable),o.writeUInt16(n.usableActionId??0)),n.wrapable&&a(Te.ThingAttrWrapable),n.unwrapable&&a(Te.ThingAttrUnwrapable),n.topEffect&&a(Te.ThingAttrTopEffect),n.noMoveAnimation&&a(Te.ThingAttrNoMoveAnimation),n.chargeable&&a(Te.ThingAttrChargeable),o.writeUInt8(Te.ThingAttrLast)}function D0(o,n,i,a){if(a&&o.writeUInt8(n.type),o.writeUInt8(n.width),o.writeUInt8(n.height),(n.width>1||n.height>1)&&o.writeUInt8(Math.max(n.width,n.height)),o.writeUInt8(n.layers),o.writeUInt8(n.patternX),o.writeUInt8(n.patternY),i>=755&&o.writeUInt8(n.patternZ),o.writeUInt8(n.animationLength),n.animationLength>1&&i>=1050){o.writeUInt8(n.asynchronous),o.writeUInt32(n.nLoop),o.writeUInt8(n.start&255);for(let l=0;l<n.animationLength;l++){const d=n.animationLengths[l]??{min:100,max:100};o.writeUInt32(d.min),o.writeUInt32(d.max)}}for(const l of n.sprites)i>=960?o.writeUInt32(l):o.writeUInt16(l)}function j0(o,n){if(!n||n.size===0){console.log("[OB] Compile: no edits, returning original buffer");const S=o.originalBuffer.slice(0),g=new Uint8Array(S);if(g.length>=Jr&&oc(g)){const w=o.version>=960,_=o.version>=960,E=o.version>=1050,P=o.version>=1050;let k=0;w&&(k|=1),_&&(k|=2),E&&(k|=4),P&&(k|=8),g[15]=k}return S}console.log(`[OB] Compile: rebuilding with ${n.size} edited thing(s)`);const i=new Bf(1024*1024),a=new Uint8Array(o.originalBuffer.slice(0,Jr)),l=o.version>=960,d=o.version>=960,m=o.version>=1050,h=o.version>=1050;let p=0;l&&(p|=1),d&&(p|=2),m&&(p|=4),h&&(p|=8),a[15]=p,i.writeBytes(a),i.writeUInt16(o.itemCount),i.writeUInt16(o.outfitCount),i.writeUInt16(o.effectCount),i.writeUInt16(o.distanceCount);const v=o.itemCount+o.outfitCount+o.effectCount+o.distanceCount;for(let S=100;S<=v;S++){const g=o.things.get(S);if(!g){i.writeUInt8(Te.ThingAttrLast),i.writeUInt8(1),i.writeUInt8(1),i.writeUInt8(1),i.writeUInt8(1),i.writeUInt8(1),o.version>=755&&i.writeUInt8(1),i.writeUInt8(1),o.version>=960?i.writeUInt32(0):i.writeUInt16(0);continue}if(g.rawBytes&&!n.has(S)){i.writeBytes(g.rawBytes);continue}g.category==="outfit"&&g.flags.hasDisplacement&&console.log(`[OB] Writing outfit #${S} displacement: x=${g.flags.displacementX}, y=${g.flags.displacementY}`),N0(i,g.flags,o.version);const w=g.category==="outfit",_=o.version>=1050&&w;_&&i.writeUInt8(g.frameGroups.length);for(const E of g.frameGroups)D0(i,E,o.version,_)}return i.toArrayBuffer()}const tf=32,Ao=tf*tf;function A0(o){const n=new Uint32Array(o.data.buffer),i=[];let a=0;for(;a<Ao;){let h=0;for(;a+h<Ao&&!((n[a+h]>>24&255)>0);)h++;let p=a+h,v=0;for(;p+v<Ao&&(n[p+v]>>24&255)!==0;)v++;if(h>0&&v===0&&a+h>=Ao)break;const S=new Uint8Array(4+v*4),g=new DataView(S.buffer);g.setUint16(0,h,!0),g.setUint16(2,v,!0);for(let w=0;w<v;w++){const _=n[p+w];S[4+w*4+0]=_&255,S[4+w*4+1]=_>>8&255,S[4+w*4+2]=_>>16&255,S[4+w*4+3]=_>>24&255}i.push(S),a=p+v}const l=i.reduce((h,p)=>h+p.length,0),d=new Uint8Array(5+l);d[0]=255,d[1]=0,d[2]=255,d[3]=l&255,d[4]=l>>8&255;let m=5;for(const h of i)d.set(h,m),m+=h.length;return d}function Ff(o){let n=0;return o>=960&&(n|=1),o>=960&&(n|=2),o>=1050&&(n|=4),o>=1050&&(n|=8),n}function I0(o,n){const i=new Uint8Array(o);if(i.length>=Jr&&oc(i)){const a=Ff(n);if(i[15]!==a){const l=o.slice(0);return new Uint8Array(l)[15]=a,l}}return o.slice(0)}function T0(o,n){if(!n||n.size===0)return console.log("[OB] Sprite compile: no edits, returning original buffer"),I0(o.originalBuffer,o.version);console.log(`[OB] Sprite compile: rebuilding with ${n.size} modified sprite(s)`);const i=new Map;for(const[w,_]of n)i.set(w,A0(_));const a=new Map;for(let w=1;w<=o.spriteCount;w++){const _=i.get(w);if(_)a.set(w,_);else{const E=o.addresses.get(w);if(E!==void 0){const P=o.buffer,k=P[E+3]+(P[E+4]<<8);a.set(w,P.slice(E,E+5+k))}}}const l=Jr,d=o.version>760?4:2,m=o.spriteCount*4,h=l+d+m,p=new Map;let v=h;for(let w=1;w<=o.spriteCount;w++){const _=a.get(w);_&&(p.set(w,v),v+=_.length)}const S=new Bf(v+1024),g=Ff(o.version);for(let w=0;w<Oo.length;w++)S.writeUInt8(Oo[w]);S.writeUInt8(Vo.SPRITE_DATA),S.writeUInt16(1),S.writeUInt32(o.version),S.writeUInt8(g),S.writeUInt32(0),o.version>760?S.writeUInt32(o.spriteCount):S.writeUInt16(o.spriteCount);for(let w=1;w<=o.spriteCount;w++)S.writeUInt32(p.get(w)??0);for(let w=1;w<=o.spriteCount;w++){const _=a.get(w);_&&S.writeBytes(_)}return S.toArrayBuffer()}const nf=253,Hl=254,$l=255,L0=16,B0=17,F0=1,P0=3,M0=57,R0=62;function rf(o){const n=new Uint8Array(o.length*2);let i=0;for(let a=0;a<o.length;a++){const l=o[a];(l===nf||l===Hl||l===$l)&&(n[i++]=nf),n[i++]=l}return n.slice(0,i)}function O0(o,n,i,a){const l=new Uint8Array(15),d=new DataView(l.buffer);return l[0]=i&255,d.setUint32(1,a,!0),l[5]=L0,d.setUint16(6,2,!0),d.setUint16(8,o,!0),l[10]=B0,d.setUint16(11,2,!0),d.setUint16(13,n,!0),l}function U0(){const n=new Uint8Array(148),i=new DataView(n.buffer);return n[0]=0,i.setUint32(1,0,!0),n[5]=F0,i.setUint16(6,140,!0),i.setUint32(8,P0,!0),i.setUint32(12,M0,!0),i.setUint32(16,R0,!0),n}function z0(o){const n=[];n.push(new Uint8Array(4)),n.push(new Uint8Array([Hl])),n.push(rf(U0()));const i=Array.from(o.keys()).filter(m=>m>=100).sort((m,h)=>m-h);for(const m of i){const h=o.get(m);if(h.group===14)continue;const p=h.id??m,v=O0(m,p,h.group,h.flags),S=rf(v);n.push(new Uint8Array([Hl])),n.push(S),n.push(new Uint8Array([$l]))}n.push(new Uint8Array([$l]));const a=n.reduce((m,h)=>m+h.length,0),l=new Uint8Array(a);let d=0;for(const m of n)l.set(m,d),d+=m.length;return l.buffer}const Pf=["Objects (.eobj)","Sprites (.espr)","Definitions (.json)","Sprite Map (.json)","Items OTB (.otb)","Hair Definitions","Asset Manifest"],sf={active:!1,steps:Pf.map(o=>({label:o,status:"pending"})),currentStep:-1,startTime:0,totalElapsed:0};function Gl(o){return o<1e3?`${Math.round(o)}ms`:`${(o/1e3).toFixed(1)}s`}function H0(o){return o<1024?`${o} B`:o<1024*1024?`${(o/1024).toFixed(1)} KB`:`${(o/(1024*1024)).toFixed(1)} MB`}const Vl=[];let Wl=null;function Mf(){if(Vl.length===0){Wl=null;return}const{buffer:o,filename:n}=Vl.shift(),i=new Blob([o],{type:"application/octet-stream"}),a=URL.createObjectURL(i),l=document.createElement("a");l.href=a,l.download=n,l.click(),setTimeout(()=>URL.revokeObjectURL(a),1e3),Wl=window.setTimeout(Mf,150)}function $0(o,n){Vl.push({buffer:o,filename:n}),Wl==null&&Mf()}async function G0(o,n){const{objectData:i,spriteData:a,dirtyIds:l,spriteOverrides:d,itemDefinitions:m,sourceDir:h,sourceNames:p,sourceHandles:v}=I.getState();if(!i||!a)return;const S=performance.now(),g=Pf.map(D=>({label:D,status:"pending"}));o({active:!0,steps:[...g],currentStep:0,startTime:S,totalElapsed:0});function w(D,T){Object.assign(g[D],T),o(A=>({...A,steps:[...g],currentStep:D,totalElapsed:performance.now()-S}))}async function _(D,T){w(D,{status:"running"}),await new Promise(G=>setTimeout(G,0));const A=performance.now();try{const G=await T();return w(D,{status:"done",elapsed:performance.now()-A,size:typeof G=="number"?G:void 0}),!0}catch(G){const M=G instanceof Error?G.message:String(G);return console.error(`[OB] Step "${g[D].label}" failed:`,G),w(D,{status:"error",elapsed:performance.now()-A,error:M}),!1}}function E(D){w(D,{status:"skipped"})}async function P(D,T,A,G){if(T)try{const M=await T.createWritable();await M.write(D),await M.close();return}catch(M){console.warn(`[OB] Failed to write via file handle (${T.name}), trying folder fallback:`,M)}if(h&&A)try{const Z=await(await h.getFileHandle(A,{create:!0})).createWritable();await Z.write(D),await Z.close();return}catch(M){console.warn(`[OB] Failed to write ${A} to folder, falling back to download:`,M)}$0(D,G)}console.log(`[OB] Compiling: ${l.size} dirty thing(s), ${d.size} sprite override(s)`),await _(0,async()=>{const D=new Set;for(let A=100;A<=i.itemCount+i.outfitCount+i.effectCount+i.distanceCount;A++)D.add(A);const T=j0(i,D);return await P(T,v.obj,p.obj,"emperia.eobj"),i.originalBuffer=T,T.byteLength}),await _(1,async()=>{const D=T0(a,d),T=await Am(D);return await P(T,v.spr,p.spr,"emperia.espr"),a.originalBuffer=D,T.byteLength}),await _(2,async()=>{const D=Array.from(m.keys()).sort((M,Z)=>M-Z),T={};for(const M of D){const Z=m.get(M);let de=null;if(Z.properties){de={};for(const[_e,Y]of Object.entries(Z.properties))Y!=null&&Y!==""&&(de[_e]=Y);Object.keys(de).length===0&&(de=null)}const he=Z.id??M,Se=i.things.get(he);if((Se==null?void 0:Se.category)==="item"&&Se.flags.ground){const _e=Se.flags.groundSpeed??100;_e!==100?(de=de??{},de.friction=_e):de&&(delete de.friction,Object.keys(de).length===0&&(de=null))}const Ee={};Z.id!=null&&(Ee.id=Z.id),Ee.flags=Z.flags,Ee.group=Z.group,Ee.properties=de,T[String(M)]=Ee}const A=JSON.stringify(T,null,4),G=new TextEncoder().encode(A).buffer;return await P(G,v.def,p.def,"definitions.json"),G.byteLength});{const{spriteMapLoaded:D,exportSpriteMapJson:T}=I.getState();D?await _(3,async()=>{const A=T(),G=new TextEncoder().encode(A).buffer;return await P(G,v.spriteMap,p.spriteMap,"item-to-sprite.json"),G.byteLength}):E(3)}m.size>0?await _(4,async()=>{const D=z0(m);return await P(D,null,"items.otb","items.otb"),D.byteLength}):E(4);{const{hairDefsLoaded:D,exportHairDefinitionsJson:T}=I.getState();D?await _(5,async()=>{const A=T(),G=new TextEncoder().encode(A).buffer;return await P(G,null,"hair-definitions.json","hair-definitions.json"),G.byteLength}):E(5)}await _(6,async()=>{const D=JSON.stringify({version:1,features:{spriteDataSize:4096,transparency:!0,spriteSize:32,frameDurations:!0,extended:!0,frameGroups:!0},contentVersion:i.version,format:"emperia-asset-manifest",files:{sprites:"emperia.espr",objects:"emperia.eobj"}},null,2),T=new TextEncoder().encode(D).buffer;return await P(T,null,"emperia.easset","emperia.easset"),T.byteLength});const k=performance.now(),N=g.some(D=>D.status==="error");N||n(),o(D=>({...D,active:!1,endTime:k,totalElapsed:k-S})),h&&console.log("[OB] Saved to source folder:",h.name),console.log(`[OB] Compile ${N?"finished with errors":"complete"} in ${Gl(k-S)}`)}function V0(){const o=I(k=>k.objectData);I(k=>k.spriteData);const n=I(k=>k.reset),i=I(k=>k.dirty),a=I(k=>k.undo),l=I(k=>k.redo),d=I(k=>k.undoStack),m=I(k=>k.redoStack),h=I(k=>k.markClean),[p,v]=H.useState(sf),S=H.useRef(null);H.useEffect(()=>(p.active&&!p.endTime?S.current=window.setInterval(()=>{v(k=>({...k,totalElapsed:performance.now()-k.startTime}))},100):S.current&&(clearInterval(S.current),S.current=null),()=>{S.current&&clearInterval(S.current)}),[p.active,p.endTime]),H.useEffect(()=>{if(p.endTime&&p.steps.every(k=>k.status==="done"||k.status==="skipped")){const k=window.setTimeout(()=>v(sf),4e3);return()=>clearTimeout(k)}},[p.endTime,p.steps]),H.useEffect(()=>{const k=N=>{i&&N.preventDefault()};return window.addEventListener("beforeunload",k),()=>window.removeEventListener("beforeunload",k)},[i]);const g=H.useCallback(async()=>{p.active||await G0(v,h)},[p.active,h]);H.useEffect(()=>{const k=N=>{(N.ctrlKey||N.metaKey)&&N.key==="z"&&!N.shiftKey&&(N.preventDefault(),a()),(N.ctrlKey||N.metaKey)&&(N.key==="y"||N.key==="z"&&N.shiftKey)&&(N.preventDefault(),l()),(N.ctrlKey||N.metaKey)&&N.key==="s"&&(N.preventDefault(),g())};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)});const w=p.active||!!p.endTime,_=p.steps.filter(k=>k.status==="error").length,E=p.steps.filter(k=>k.status==="done").length,P=p.steps.filter(k=>k.status!=="skipped").length;return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"h-10 flex items-center px-3 gap-2 bg-emperia-surface border-b border-emperia-border shrink-0",children:[u.jsx("span",{className:"text-sm font-bold text-emperia-text tracking-wide",children:"Emperia Object Builder"}),u.jsx("span",{className:"text-xs text-emperia-muted",children:"v1.0.0"}),i&&!p.active&&u.jsx("span",{title:"Unsaved changes",children:u.jsx(qd,{className:"w-2 h-2 fill-amber-400 text-amber-400"})}),u.jsx("div",{className:"flex-1"}),w&&u.jsxs("div",{className:"flex items-center gap-2 text-xs mr-2",children:[p.active?u.jsx(Bo,{className:"w-3.5 h-3.5 text-emperia-accent animate-spin"}):_>0?u.jsx(g0,{className:"w-3.5 h-3.5 text-amber-400"}):u.jsx(Zd,{className:"w-3.5 h-3.5 text-emerald-400"}),u.jsx("span",{className:p.active?"text-emperia-accent":_>0?"text-amber-400":"text-emerald-400",children:p.active?`Compiling ${E}/${P}...`:_>0?`Done with ${_} error${_>1?"s":""}`:"Compiled"}),u.jsx("span",{className:"text-emperia-muted",children:Gl(p.totalElapsed)})]}),o&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex items-center gap-3 text-xs text-emperia-muted mr-2",children:[u.jsxs("span",{className:"flex items-center gap-1",children:[u.jsx(s0,{className:"w-3 h-3"}),"v",o.version]}),u.jsxs("span",{children:[o.things.size," objects"]})]}),u.jsx("button",{onClick:a,disabled:d.length===0||p.active,className:`p-1.5 rounded text-emperia-muted hover:text-emperia-text hover:bg-emperia-hover
                         disabled:opacity-30 disabled:cursor-default transition-colors`,title:"Undo (Ctrl+Z)",children:u.jsx(x0,{className:"w-3.5 h-3.5"})}),u.jsx("button",{onClick:l,disabled:m.length===0||p.active,className:`p-1.5 rounded text-emperia-muted hover:text-emperia-text hover:bg-emperia-hover
                         disabled:opacity-30 disabled:cursor-default transition-colors`,title:"Redo (Ctrl+Y)",children:u.jsx(f0,{className:"w-3.5 h-3.5"})}),u.jsx("div",{className:"w-px h-5 bg-emperia-border mx-1"}),u.jsxs("button",{onClick:g,disabled:p.active,className:`flex items-center gap-1.5 px-2.5 py-1 rounded text-xs font-medium
                         bg-emperia-accent/20 text-emperia-accent hover:bg-emperia-accent/30
                         disabled:opacity-50 disabled:cursor-default transition-colors`,title:"Compile and save all files (Ctrl+S)",children:[p.active?u.jsx(Bo,{className:"w-3.5 h-3.5 animate-spin"}):u.jsx(cc,{className:"w-3.5 h-3.5"}),p.active?"Compiling...":"Compile"]})]}),u.jsxs("button",{onClick:n,disabled:p.active,className:`flex items-center gap-1.5 px-2 py-1 rounded text-xs
                     text-emperia-muted hover:text-emperia-text hover:bg-emperia-hover
                     disabled:opacity-50 disabled:cursor-default transition-colors`,children:[u.jsx(Af,{className:"w-3.5 h-3.5"}),"Open"]})]}),w&&u.jsx("div",{className:"flex items-center gap-1 px-3 py-1 bg-emperia-bg border-b border-emperia-border text-[11px] overflow-x-auto",children:p.steps.map((k,N)=>k.status==="skipped"?null:u.jsxs("div",{className:`flex items-center gap-1 px-2 py-0.5 rounded whitespace-nowrap ${k.status==="running"?"bg-emperia-accent/10 text-emperia-accent":k.status==="done"?"text-emerald-400/80":k.status==="error"?"bg-red-500/10 text-red-400":"text-emperia-muted/50"}`,title:k.error||void 0,children:[k.status==="running"&&u.jsx(Bo,{className:"w-3 h-3 animate-spin shrink-0"}),k.status==="done"&&u.jsx(Zd,{className:"w-3 h-3 shrink-0"}),k.status==="error"&&u.jsx(Xo,{className:"w-3 h-3 shrink-0"}),k.status==="pending"&&u.jsx(qd,{className:"w-2 h-2 shrink-0 opacity-30"}),u.jsx("span",{children:k.label}),k.elapsed!=null&&u.jsx("span",{className:"opacity-60",children:Gl(k.elapsed)}),k.size!=null&&u.jsx("span",{className:"opacity-40",children:H0(k.size)})]},N))})]})}function W0(o){let n=4294967295;for(let i=0;i<o.length;i++){n^=o[i];for(let a=0;a<8;a++)n=n>>>1^(n&1?3988292384:0)}return(n^4294967295)>>>0}function Y0(o){const n=new TextEncoder,i=[],a=[];let l=0;for(const w of o){const _=n.encode(w.name),E=W0(w.data),P=w.data.length,k=new Uint8Array(30+_.length),N=new DataView(k.buffer);N.setUint32(0,67324752,!0),N.setUint16(4,20,!0),N.setUint16(6,0,!0),N.setUint16(8,0,!0),N.setUint16(10,0,!0),N.setUint16(12,0,!0),N.setUint32(14,E,!0),N.setUint32(18,P,!0),N.setUint32(22,P,!0),N.setUint16(26,_.length,!0),N.setUint16(28,0,!0),k.set(_,30),i.push(k),i.push(w.data);const D=new Uint8Array(46+_.length),T=new DataView(D.buffer);T.setUint32(0,33639248,!0),T.setUint16(4,20,!0),T.setUint16(6,20,!0),T.setUint16(8,0,!0),T.setUint16(10,0,!0),T.setUint16(12,0,!0),T.setUint16(14,0,!0),T.setUint32(16,E,!0),T.setUint32(20,P,!0),T.setUint32(24,P,!0),T.setUint16(28,_.length,!0),T.setUint16(30,0,!0),T.setUint16(32,0,!0),T.setUint16(34,0,!0),T.setUint16(36,0,!0),T.setUint32(38,32,!0),T.setUint32(42,l,!0),D.set(_,46),a.push(D),l+=k.length+w.data.length}const d=l;for(const w of a)i.push(w),l+=w.length;const m=l-d,h=new Uint8Array(22),p=new DataView(h.buffer);p.setUint32(0,101010256,!0),p.setUint16(4,0,!0),p.setUint16(6,0,!0),p.setUint16(8,o.length,!0),p.setUint16(10,o.length,!0),p.setUint32(12,m,!0),p.setUint32(16,d,!0),p.setUint16(20,0,!0),i.push(h);const v=i.reduce((w,_)=>w+_.length,0),S=new Uint8Array(v);let g=0;for(const w of i)S.set(w,g),g+=w.length;return S}const Qo=document.createElement("canvas");Qo.width=32;Qo.height=32;const of=Qo.getContext("2d");function X0(o){return of.clearRect(0,0,32,32),of.putImageData(o,0,0),new Promise(n=>{Qo.toBlob(i=>{i.arrayBuffer().then(a=>n(new Uint8Array(a)))},"image/png")})}function K0(o){return o.replace(/[^a-zA-Z0-9_\-]/g,"_")}async function Q0(o,n){var a;if(o.length===0)return;const i=[];for(const l of o){const d=n.objectData.things.get(l);if(!d)continue;const m=[];for(const g of d.frameGroups)for(const w of g.sprites)w!==0&&!m.includes(w)&&m.push(w);if(m.length===0)continue;const h=n.clientToServerIds.get(l),p=h!=null?n.itemDefinitions.get(h):void 0,v=(a=p==null?void 0:p.properties)==null?void 0:a.name,S=v?`${l}_${K0(v)}`:`${l}`;for(const g of m){const _=n.spriteOverrides.get(g)??mn(n.spriteData,g);if(!_)continue;const E=await X0(_),P=m.length===1?`${S}.png`:`${S}_spr${g}.png`;i.push({name:P,data:E})}}if(i.length!==0)if(i.length===1)af(i[0].data,i[0].name,"image/png");else{const l=Y0(i);af(l,"sprites_export.zip","application/zip")}}function af(o,n,i){const a=new Blob([o.buffer],{type:i}),l=URL.createObjectURL(a),d=document.createElement("a");d.href=l,d.download=n,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(l)}const Z0={0:"None",1:"Ground",2:"Container",3:"Weapon",4:"Ammunition",5:"Armor",6:"Charges",7:"Teleport",9:"Write",10:"Write Once",11:"Fluid",12:"Splash"},q0=[{key:"item",label:"Items",icon:l0},{key:"outfit",label:"Outfits",icon:p0},{key:"effect",label:"Effects",icon:m0},{key:"distance",label:"Distance",icon:Km}];function J0(){const o=I(A=>A.activeCategory),n=I(A=>A.setActiveCategory),i=I(A=>A.objectData),a=I(A=>A.searchQuery),l=I(A=>A.setSearchQuery),d=I(A=>A.selectedThingId),m=I(A=>A.addThing),h=I(A=>A.removeThing),p=I(A=>A.getCategoryRange),v=I(A=>A.filterGroup),S=I(A=>A.setFilterGroup),g=I(A=>A.definitionsLoaded),w=I(A=>A.selectedThingIds),_=I(A=>A.spriteData),E=I(A=>A.spriteOverrides),P=I(A=>A.itemDefinitions),k=I(A=>A.clientToServerIds);I(A=>A.editVersion);const N=w.size,D=async()=>{if(!i||!_)return;const A=N>0?Array.from(w):d!=null?[d]:[];A.length!==0&&await Q0(A,{objectData:i,spriteData:_,spriteOverrides:E,itemDefinitions:P,clientToServerIds:k})},T=A=>{if(!i)return 0;switch(A){case"item":return i.itemCount-99;case"outfit":return i.outfitCount;case"effect":return i.effectCount;case"distance":return i.distanceCount}};return u.jsxs("div",{className:"shrink-0",children:[u.jsx("div",{className:"flex border-b border-emperia-border",children:q0.map(({key:A,label:G,icon:M})=>u.jsxs("button",{onClick:()=>n(A),className:`
              flex-1 flex flex-col items-center gap-0.5 py-2 text-xs transition-colors
              ${o===A?"text-emperia-accent border-b-2 border-emperia-accent bg-emperia-accent/5":"text-emperia-muted hover:text-emperia-text hover:bg-emperia-hover"}
            `,children:[u.jsx(M,{className:"w-4 h-4"}),u.jsx("span",{children:G}),u.jsx("span",{className:"text-[10px] opacity-60",children:T(A)})]},A))}),u.jsxs("div",{className:"px-2 py-1.5 border-b border-emperia-border flex items-center gap-1",children:[u.jsxs("div",{className:"flex items-center gap-1.5 bg-emperia-surface rounded px-2 py-1 flex-1",children:[u.jsx(Ii,{className:"w-3.5 h-3.5 text-emperia-muted shrink-0"}),u.jsx("input",{type:"text",placeholder:g?"Search by ID or name":"Search by ID",value:a,onChange:A=>l(A.target.value),className:"bg-transparent text-xs text-emperia-text placeholder-emperia-muted/50 outline-none w-full"}),N>0&&u.jsxs("span",{className:"text-[10px] text-emperia-accent font-medium shrink-0",children:[N," sel"]})]}),g&&o==="item"&&u.jsxs("select",{value:v,onChange:A=>S(parseInt(A.target.value,10)),className:"text-[10px] bg-emperia-surface border border-emperia-border rounded px-1 py-1 text-emperia-text outline-none cursor-pointer max-w-[80px]",title:"Filter by group",children:[u.jsx("option",{value:-1,children:"All"}),Object.entries(Z0).map(([A,G])=>u.jsx("option",{value:A,children:G},A))]}),u.jsx("button",{onClick:D,disabled:!i||!_||N===0&&d==null,className:"p-1 rounded bg-emperia-surface border border-emperia-border text-emperia-muted hover:text-blue-400 hover:border-blue-400/50 disabled:opacity-30 transition-colors",title:N>0?`Export ${N} selected sprites`:"Export selected sprite",children:u.jsx(cc,{className:"w-3.5 h-3.5"})}),u.jsx("button",{onClick:()=>m(o),disabled:!i,className:"p-1 rounded bg-emperia-surface border border-emperia-border text-emperia-muted hover:text-green-400 hover:border-green-400/50 disabled:opacity-30 transition-colors",title:`Add new ${o}`,children:u.jsx(ys,{className:"w-3.5 h-3.5"})}),u.jsx("button",{onClick:()=>{if(!d||!i)return;const A=p(o);if(!A||d!==A.end)return;const G=i?Hn(i,d):d;confirm(`Remove ${o} #${G}? Only the last entry can be removed.`)&&h(d)},disabled:!i||!d||(()=>{const A=p(o);return!A||d!==A.end})(),className:"p-1 rounded bg-emperia-surface border border-emperia-border text-emperia-muted hover:text-red-400 hover:border-red-400/50 disabled:opacity-30 transition-colors",title:`Remove last ${o}`,children:u.jsx(a0,{className:"w-3.5 h-3.5"})})]})]})}const Jn=40,lf=20;function eg(){const o=I(Y=>Y.objectData),n=I(Y=>Y.activeCategory),i=I(Y=>Y.searchQuery),a=I(Y=>Y.getCategoryRange),l=I(Y=>Y.selectedThingId),d=I(Y=>Y.setSelectedThingId),m=I(Y=>Y.selectedThingIds),h=I(Y=>Y.toggleThingSelection),p=I(Y=>Y.spriteData),v=I(Y=>Y.spriteOverrides),S=I(Y=>Y.editVersion),g=I(Y=>Y.filterGroup),w=I(Y=>Y.itemDefinitions),_=I(Y=>Y.clientToServerIds),E=H.useMemo(()=>Vm(o,n,i,g,a,w,_),[o,n,i,g,a,w,_,S]),P=H.useRef(null),[k,N]=H.useState(0),[D,T]=H.useState(0),A=6,G=Math.ceil(E.length/A),M=G*Jn,Z=Math.max(0,Math.floor(k/Jn)-lf),de=Math.min(G,Math.ceil((k+D)/Jn)+lf),he=Z*A,Se=Math.min(E.length,de*A),Ee=E.slice(he,Se),_e=H.useCallback(()=>{P.current&&N(P.current.scrollTop)},[]);return H.useEffect(()=>{const Y=P.current;if(!Y)return;const re=new ResizeObserver(()=>T(Y.clientHeight));return re.observe(Y),T(Y.clientHeight),()=>re.disconnect()},[]),H.useEffect(()=>{const Y=re=>{var X;if(!E.length||l==null)return;const ve=(X=re.target)==null?void 0:X.tagName;if(ve==="INPUT"||ve==="TEXTAREA"||ve==="SELECT")return;const ge=E.findIndex(ue=>ue.id===l);if(ge<0)return;let ie=ge;switch(re.key){case"ArrowRight":ie=Math.min(E.length-1,ge+1);break;case"ArrowLeft":ie=Math.max(0,ge-1);break;case"ArrowDown":ie=Math.min(E.length-1,ge+A);break;case"ArrowUp":ie=Math.max(0,ge-A);break;default:return}ie!==ge&&(re.preventDefault(),d(E[ie].id))};return window.addEventListener("keydown",Y),()=>window.removeEventListener("keydown",Y)},[E,l,d]),H.useEffect(()=>{if(l==null||!P.current)return;const Y=E.findIndex(ie=>ie.id===l);if(Y<0)return;const ve=Math.floor(Y/A)*Jn,ge=P.current;(ve<ge.scrollTop||ve+Jn>ge.scrollTop+ge.clientHeight)&&(ge.scrollTop=Math.max(0,ve-ge.clientHeight/2+Jn/2))},[l,E]),u.jsx("div",{ref:P,onScroll:_e,className:"flex-1 overflow-y-auto",children:u.jsx("div",{style:{height:M,position:"relative"},children:u.jsx("div",{style:{position:"absolute",top:Z*Jn,left:0,right:0,display:"grid",gridTemplateColumns:`repeat(${A}, 1fr)`},children:Ee.map(Y=>{var V,Q;const re=((V=Y.frameGroups[0])==null?void 0:V.sprites.find(ee=>ee>0))??0,ve=p?Yo(p,re,v):null,ge=Y.id===l,ie=o?Hn(o,Y.id):Y.id,X=_==null?void 0:_.get(Y.id),ue=X!=null?w==null?void 0:w.get(X):void 0,te=(Q=ue==null?void 0:ue.properties)==null?void 0:Q.name,B=te?`#${ie}  ${te}`:`#${ie}`,b=m.has(Y.id);return u.jsxs("button",{onClick:ee=>{if(ee.ctrlKey||ee.metaKey)h(Y.id);else if(ee.shiftKey&&l!=null){const K=E.findIndex(ae=>ae.id===l),oe=E.findIndex(ae=>ae.id===Y.id);if(K>=0&&oe>=0){const ae=Math.min(K,oe),Ce=Math.max(K,oe),Le=E.slice(ae,Ce+1).map(yt=>yt.id);h(Y.id,Le)}}else d(Y.id)},className:`
                  relative flex items-center justify-center
                  border transition-colors
                  ${ge?"bg-emperia-accent/20 border-emperia-accent":b?"bg-emperia-accent/10 border-emperia-accent/50":"border-transparent hover:bg-emperia-hover"}
                `,style:{width:Jn,height:Jn},title:B,children:[ve?u.jsx("img",{src:ve,alt:"",className:"w-8 h-8 pixelated",style:{imageRendering:"pixelated"}}):u.jsx("div",{className:"w-8 h-8 bg-emperia-border/30 rounded-sm"}),u.jsx("span",{className:"absolute bottom-0 right-0.5 text-[8px] text-emperia-muted/60 leading-none",children:ie})]},Y.id)})})})})}const Qr=[16777215,12571903,12577279,12582911,12582889,12582868,12582847,13959103,15335359,16777151,16771519,16766143,16760767,16760788,16760809,16760831,15319039,13942783,12566527,14342874,9412543,9416639,9420735,9420719,9420703,9420687,10469263,11517839,12566415,12562319,12558223,12554127,12554143,12554159,12554175,11505599,10457023,9408447,11974326,6258623,9416639,6275007,6274975,6274943,6274911,8372063,10469215,12566367,12558175,12549983,12541791,12541823,12541855,12541887,10444735,8347583,6250431,9539985,4156095,4166847,4177855,4177812,4177770,4177727,6995775,9748287,12566335,12555327,12544575,12533567,12533610,12533652,12533695,9715647,6963135,4145087,7171437,22015,43775,65535,65450,65364,65280,5570304,11206400,16776960,16754944,16733440,16711680,16711765,16711849,16711934,11141375,5570815,255,4737096,16319,32703,49087,49023,48959,48896,4177664,8371968,12566272,12549888,12533504,12517376,12517439,12517503,12517567,8323263,4128959,191,2368548,10879,21887,32639,32597,32554,32512,2785024,5603072,8355584,8344576,8333824,8323072,8323114,8323156,8323199,5570687,2752639,127],Ni=Qr.length,tg=4278255615,ng=4278190335,rg=4278255360,ig=4294901760;function zo(o,n,i){const a=Qr[Math.max(0,Math.min(Ni-1,i.head))],l=Qr[Math.max(0,Math.min(Ni-1,i.body))],d=Qr[Math.max(0,Math.min(Ni-1,i.legs))],m=Qr[Math.max(0,Math.min(Ni-1,i.feet))],h=new Uint32Array(n.data.buffer),p=o.data;for(let v=0;v<h.length;v++){const S=4*v;let g;switch(h[v]){case tg:g=a;break;case ng:g=l;break;case rg:g=d;break;case ig:g=m;break;default:continue}p[S+0]=p[S+0]*(g>>0&255)/255,p[S+1]=p[S+1]*(g>>8&255)/255,p[S+2]=p[S+2]*(g>>16&255)/255}}function cf(o){const n=Qr[Math.max(0,Math.min(Ni-1,o))],i=n>>0&255,a=n>>8&255,l=n>>16&255;return`#${i.toString(16).padStart(2,"0")}${a.toString(16).padStart(2,"0")}${l.toString(16).padStart(2,"0")}`}function tn({label:o,value:n,onChange:i,min:a,max:l,readOnly:d,labelClassName:m}){return u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("span",{className:m??"text-[10px] text-emperia-muted",children:[o,":"]}),d?u.jsx("span",{className:"text-[10px] text-emperia-text font-mono w-14 text-right",children:n}):u.jsxs("div",{className:"flex items-center gap-0.5",children:[u.jsx("button",{onClick:()=>i==null?void 0:i(Math.max(a??0,n-1)),className:"w-4 h-4 flex items-center justify-center rounded bg-emperia-surface border border-emperia-border text-emperia-muted hover:text-emperia-text text-[10px]",children:"-"}),u.jsx("input",{type:"number",value:n,min:a,max:l,onChange:h=>{const p=parseInt(h.target.value,10);isNaN(p)||i==null||i(Math.max(a??0,Math.min(l??9999,p)))},className:"w-10 px-1 py-0 bg-emperia-surface border border-emperia-border rounded text-[10px] text-emperia-text font-mono text-center outline-none focus:border-emperia-accent"}),u.jsx("button",{onClick:()=>i==null?void 0:i(Math.min(l??9999,n+1)),className:"w-4 h-4 flex items-center justify-center rounded bg-emperia-surface border border-emperia-border text-emperia-muted hover:text-emperia-text text-[10px]",children:"+"})]})]})}function pn({onClick:o,disabled:n,children:i}){return u.jsx("button",{onClick:o,disabled:n,className:"w-5 h-5 flex items-center justify-center rounded bg-emperia-surface border border-emperia-border text-emperia-muted hover:text-emperia-text text-[10px] disabled:opacity-30",children:i})}function er(o,n,i,a,l,d,m,h){return(((((n*o.patternZ+l)*o.patternY+a)*o.patternX+i)*o.layers+d)*o.height+h)*o.width+m}const Dn=4294967296,uf=2147483647,df=-2147483648,Ci=268435455,sg=4294967295,Rf=1073741823,ff=192,Io=12,og=114,ag=768,lg=4096,cg=2,Ol=[4294967295,-Dn],Ei=[0,0],ug=[1,0],To=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],nt=fg(),Nr=hg();function Be(o,n=0){const i=[];if(i[o-1]=void 0,n!==0)for(let a=0;a<o;a++)i[a]=n;return i}function Of(o,n,i,a,l){if(!(n<0||a<0||l<0||n+l>o.length||a+l>i.length))if(o===i&&n<a&&a<n+l)for(let d=l-1;d>=0;d--)i[a+d]=o[n+d];else for(let d=0;d<l;d++)i[a+d]=o[n+d]}function $n(o,n){return nt[((o-n^-n)&2047)>>>2]}function vs(o,n){let i,a;for(n%=18446744073709552e3,o%=18446744073709552e3,i=n%Dn,a=Math.floor(o/Dn)*Dn,n=n-i+a,o=o-a+i;o<0;)o+=Dn,n-=Dn;for(;o>4294967295;)o-=Dn,n+=Dn;for(n=n%18446744073709552e3;n>9223372032559809e3;)n-=18446744073709552e3;for(;n<-9223372036854776e3;)n+=18446744073709552e3;return[o,n]}function Gn(o,n){return vs(o[0]+n[0],o[1]+n[1])}function Uf(o,n){return vs(o[0]-n[0],o[1]-n[1])}function tr(o,n){if(o[0]==n[0]&&o[1]==n[1])return 0;const i=o[1]<0,a=n[1]<0;return i&&!a?-1:!i&&a?1:Uf(o,n)[1]<0?-1:1}function Yt(o){return o[0]>=2147483648?~~Math.max(Math.min(o[0]-Dn,uf),df):~~Math.max(Math.min(o[0],uf),df)}function Zr(o){return o>=0?[o,0]:[o+Dn,-Dn]}function dg(o,n){if(n&=63,n<=30){const a=1<<n;return vs(Math.floor(o[0]/a),o[1]/a)}const i=(1<<30)*(1<<n-30);return vs(Math.floor(o[0]/i),o[1]/i)}function Oe(o){for(let n=o.length-1;n>=0;--n)o[n]=1024}function Ho(o){return o-=2,o<4?o:3}function Er(o){return o<4?0:o<10?o-3:o-6}function $t(o){return{numBitLevels:o,models:Be(1<<o)}}function fg(){const o=[];for(let n=8;n>=0;--n){let i=1<<9-n-1,a=1<<9-n;for(let l=i;l<a;++l)o[l]=(n<<6)+(a-l<<6>>>9-n-1)}return o}function hg(){const o=[0,1];let n=2;for(let i=2;i<22;++i){let a=1<<(i>>1)-1;for(let l=0;l<a;++l,++n)o[n]=i}return o}class pg{constructor(n){$(this,"encoder",null);$(this,"decoder",null);$(this,"alive",0);$(this,"inBytesProcessed",[0,0]);$(this,"lzma");this.lzma=n}processChunk(){if(!this.alive)throw new Error("bad state");if(!this.encoder)throw new Error("No decoding");return this.lzma.codeOneBlock(),this.inBytesProcessed=this.encoder.processedInSize[0],this.encoder.finished[0]&&(this.lzma.releaseStreams(),this.alive=0),this.alive}}class hf{constructor(n){$(this,"encoder",null);$(this,"decoder");$(this,"alive",0);$(this,"inBytesProcessed",[0,0]);this.decoder=n}processChunk(){if(!this.alive)throw new Error("Bad state");if(this.encoder)throw new Error("No encoding");const n=this.decoder.codeOneChunk();if(n===-1)throw new Error("Corrupted input");this.inBytesProcessed=this.decoder.nowPos64;const i=tr(this.decoder.outSize,Ei)>=0&&tr(this.decoder.nowPos64,this.decoder.outSize)>=0;return(n||i)&&(this.decoder.flush(),this.decoder.cleanup(),this.alive=0),this.alive}}class mg{constructor(n=null,i=4096){$(this,"buffer",null);$(this,"pos",0);$(this,"streamPos",0);$(this,"stream",null);$(this,"windowSize",0);$(this,"w",null);$(this,"buf",[]);this.w=n,this.stream=n,this.windowSize=i,this.buf=new Array(i),this.buffer=this.buf,this.pos=0,this.streamPos=0}copyBlock(n,i){if(this.buffer)for(let a=0;a<i;a++){let l=this.pos-n-1;l<0&&(l+=this.windowSize);const d=this.buffer[l];this.putByte(d)}}putByte(n){this.buffer&&(this.buffer[this.pos]=n,this.pos++,this.streamPos++,this.pos>=this.windowSize&&this.flush())}getByte(n){if(!this.buffer)return 0;let i=this.pos+n;return i<0?i+=this.windowSize:i>=this.windowSize&&(i-=this.windowSize),this.buffer[i]}flush(){if(this.w&&this.buffer&&this.pos>0){const n=this.buffer.slice(0,this.pos);this.w.write(n),this.pos=0}}isEmpty(){return this.streamPos===0}reset(){this.pos=0,this.streamPos=0,this.buffer&&this.buffer.fill(0)}}class gg{constructor(){$(this,"stream",null);$(this,"code",0);$(this,"rrange",0)}setStream(n){this.stream=n}init(){this.code=0,this.rrange=-1;for(let n=0;n<5;++n)this.code=this.code<<8|this.readFromStream()}decodeBit(n,i){let a,l=n[i];return a=(this.rrange>>>11)*l,(this.code^-2147483648)<(a^-2147483648)?(this.rrange=a,n[i]=l+(2048-l>>>5)<<16>>16,this.rrange&-16777216||(this.code=this.code<<8|this.readFromStream(),this.rrange<<=8),0):(this.rrange-=a,this.code-=a,n[i]=l-(l>>>5)<<16>>16,this.rrange&-16777216||(this.code=this.code<<8|this.readFromStream(),this.rrange<<=8),1)}decodeDirectBits(n){let i=0;for(let a=n;a!=0;a-=1){this.rrange>>>=1;let l=this.code-this.rrange>>>31;this.code-=this.rrange&l-1,i=i<<1|1-l,this.rrange&-16777216||(this.code=this.code<<8|this.readFromStream(),this.rrange<<=8)}return i}get currentCode(){return this.code}get currentRange(){return this.rrange}readFromStream(){if(!this.stream)return 0;if(this.stream.pos>=this.stream.count)return-1;let n;return this.stream.buf instanceof ArrayBuffer?n=new Uint8Array(this.stream.buf)[this.stream.pos++]:this.stream.buf instanceof Uint8Array?n=this.stream.buf[this.stream.pos++]:n=this.stream.buf[this.stream.pos++],n&255}}class xg{constructor(){$(this,"rangeDecoder");$(this,"outWindow");$(this,"state",0);$(this,"rep0",0);$(this,"rep1",0);$(this,"rep2",0);$(this,"rep3",0);$(this,"prevByte",0);$(this,"nowPos64",[0,0]);$(this,"outSize",[0,0]);$(this,"posStateMask",0);$(this,"dictSizeCheck",0);$(this,"matchDecoders",[]);$(this,"rep0LongDecoders",[]);$(this,"repDecoders",[]);$(this,"repG0Decoders",[]);$(this,"repG1Decoders",[]);$(this,"repG2Decoders",[]);$(this,"posDecoders",[]);$(this,"literalDecoder");$(this,"posSlotDecoders",[]);$(this,"lenDecoder");$(this,"repLenDecoder");$(this,"posAlignDecoder");$(this,"decoder");$(this,"encoder",null);$(this,"alive",0);$(this,"inBytesProcessed",[0,0]);this.rangeDecoder=new gg,this.outWindow=new mg(null,lg),this.matchDecoders=Be(ff),this.rep0LongDecoders=Be(ff),this.repDecoders=Be(Io),this.repG0Decoders=Be(Io),this.repG1Decoders=Be(Io),this.repG2Decoders=Be(Io),this.posDecoders=Be(og),this.literalDecoder={coders:[],numPrevBits:0,numPosBits:0,posMask:0,init:()=>this.initLiteralDecoder()};for(let n=0;n<4;n++)this.posSlotDecoders[n]=$t(6);this.lenDecoder=this.createLenDecoder(),this.repLenDecoder=this.createLenDecoder(),this.posAlignDecoder=$t(4),this.decoder=this}get literalCoder(){return this.literalDecoder}createLenDecoder(){return{choice:Be(cg),lowCoder:[],midCoder:[],highCoder:$t(8),numPosStates:0}}setDecoderProperties(n){if(n.length<5)return!1;const i=n[0]%9,a=Math.floor(n[0]/9),l=a%5,d=Math.floor(a/5);if(d>4)return!1;this.literalDecoder.numPrevBits=i,this.literalDecoder.numPosBits=l,this.literalDecoder.posMask=(1<<l)-1,this.posStateMask=(1<<d)-1;let m=0;for(let p=0;p<4;p++){const v=n[1+p]&255;m+=v<<p*8}this.dictSizeCheck=Math.max(m,1),m>0&&(this.outWindow.windowSize=Math.max(m,4096),this.outWindow.buffer=Be(this.outWindow.windowSize));const h=1<<this.literalDecoder.numPrevBits+this.literalDecoder.numPosBits;this.literalDecoder.coders=[];for(let p=0;p<h;p++)this.literalDecoder.coders[p]={decoders:Be(ag)};this.lenDecoder.numPosStates=1<<d,this.repLenDecoder.numPosStates=1<<d,this.lenDecoder.lowCoder=[],this.lenDecoder.midCoder=[],this.repLenDecoder.lowCoder=[],this.repLenDecoder.midCoder=[];for(let p=0;p<1<<d;p++)this.lenDecoder.lowCoder[p]=$t(3),this.lenDecoder.midCoder[p]=$t(3),this.repLenDecoder.lowCoder[p]=$t(3),this.repLenDecoder.midCoder[p]=$t(3);return!0}copyBlock(n){const i=this.outWindow,a=this.rep0;let l=i.pos-a-1;for(l<0&&(l+=i.windowSize);n!=0;n-=1)l>=i.windowSize&&(l=0),i.buffer[i.pos]=i.buffer[l],i.pos+=1,l+=1,i.pos>=i.windowSize&&this.flush()}putByte(n){this.outWindow.buffer[this.outWindow.pos]=n,this.outWindow.pos+=1,this.outWindow.pos>=this.outWindow.windowSize&&this.flush()}getByte(n){const i=this.outWindow;let a=i.pos-n-1;return a<0&&(a+=i.windowSize),i.buffer[a]}getDecoder(n,i){const a=n&this.literalDecoder.posMask,l=(i&255)>>>8-this.literalDecoder.numPrevBits,d=(a<<this.literalDecoder.numPrevBits)+l;return this.literalDecoder.coders[d]}initLiteralDecoder(){let n=1<<this.literalDecoder.numPrevBits+this.literalDecoder.numPosBits;for(let i=0;i<n;++i)for(let a=0;a<this.literalDecoder.coders[i].decoders.length;a++)this.literalDecoder.coders[i].decoders[a]=1024}init(){this.outWindow.streamPos=0,this.outWindow.pos=0,Oe(this.matchDecoders),Oe(this.rep0LongDecoders),Oe(this.repDecoders),Oe(this.repG0Decoders),Oe(this.repG1Decoders),Oe(this.repG2Decoders),Oe(this.posDecoders),this.initLiteralDecoder();for(let n=0;n<4;++n)Oe(this.posSlotDecoders[n].models);this.initLenDecoder(this.lenDecoder),this.initLenDecoder(this.repLenDecoder),Oe(this.posAlignDecoder.models),this.initRangeDecoder()}initLenDecoder(n){Oe(n.choice);for(let i=0;i<n.numPosStates;++i)Oe(n.lowCoder[i].models),Oe(n.midCoder[i].models);Oe(n.highCoder.models)}outWindowReleaseStream(){this.flush(),this.outWindow.stream=null}decodeBit(n,i){return this.rangeDecoder.decodeBit(n,i)}decodeDirectBits(n){return this.rangeDecoder.decodeDirectBits(n)}initRangeDecoder(){this.rangeDecoder.init()}rangeBitTreeDecoder(n){let i,a=1;for(i=n.numBitLevels;i!=0;i-=1)a=(a<<1)+this.decodeBit(n.models,a);return a-(1<<n.numBitLevels)}reverseDecode(n,i,a){let l=0;for(let d=0,m=1,h;d<a;++d)h=this.decodeBit(n,i+m),m<<=1,m+=h,l|=h<<d;return l}reverseDecodeAlignDecoder(){let n=0;for(let i=1,a=0,l;a<this.posAlignDecoder.numBitLevels;++a)l=this.decodeBit(this.posAlignDecoder.models,i),i<<=1,i+=l,n|=l<<a;return n}decodeNormalWithRangeDecoder(n){let i=1;do i=i<<1|this.decodeBit(n.decoders,i);while(i<256);return i<<24>>24}decodeWithMatchByteWithRangeDecoder(n,i){let a,l,d=1;do if(l=i>>7&1,i<<=1,a=this.decodeBit(n.decoders,(1+l<<8)+d),d=d<<1|a,l!=a){for(;d<256;)d=d<<1|this.decodeBit(n.decoders,d);break}while(d<256);return d<<24>>24}decodeLenWithRangeDecoder(n,i){if(!this.decodeBit(n.choice,0))return this.rangeBitTreeDecoder(n.lowCoder[i]);let a=8;return this.decodeBit(n.choice,1)?a+=8+this.rangeBitTreeDecoder(n.highCoder):a+=this.rangeBitTreeDecoder(n.midCoder[i]),a}codeOneChunk(){let n,i,a,l,d,m=Yt(this.nowPos64)&this.posStateMask;if(!this.decodeBit(this.matchDecoders,(this.state<<4)+m))n=this.getDecoder(Yt(this.nowPos64),this.prevByte),this.state<7?this.prevByte=this.decodeNormalWithRangeDecoder(n):this.prevByte=this.decodeWithMatchByteWithRangeDecoder(n,this.getByte(this.rep0)),this.putByte(this.prevByte),this.state=Er(this.state),this.nowPos64=Gn(this.nowPos64,[1,0]);else{if(this.decodeBit(this.repDecoders,this.state))a=0,this.decodeBit(this.repG0Decoders,this.state)?(this.decodeBit(this.repG1Decoders,this.state)?(this.decodeBit(this.repG2Decoders,this.state)?(i=this.rep3,this.rep3=this.rep2):i=this.rep2,this.rep2=this.rep1):i=this.rep1,this.rep1=this.rep0,this.rep0=i):this.decodeBit(this.rep0LongDecoders,(this.state<<4)+m)||(this.state=this.state<7?9:11,a=1),a||(a=this.decodeLenWithRangeDecoder(this.repLenDecoder,m)+2,this.state=this.state<7?8:11);else if(this.rep3=this.rep2,this.rep2=this.rep1,this.rep1=this.rep0,a=2+this.decodeLenWithRangeDecoder(this.lenDecoder,m),this.state=this.state<7?7:10,d=this.rangeBitTreeDecoder(this.posSlotDecoders[Ho(a)]),d>=4){if(l=(d>>1)-1,this.rep0=(2|d&1)<<l,d<14)this.rep0+=this.reverseDecode(this.posDecoders,this.rep0-d-1,l);else if(this.rep0+=this.decodeDirectBits(l-4)<<4,this.rep0+=this.reverseDecodeAlignDecoder(),this.rep0<0)return this.rep0==-1?1:-1}else this.rep0=d;if(tr([this.rep0,0],this.nowPos64)>=0||this.rep0>=this.dictSizeCheck)return-1;this.copyBlock(a),this.nowPos64=Gn(this.nowPos64,[a,0]),this.prevByte=this.getByte(0)}return 0}setupForDecoding(n,i,a){this.rangeDecoder.setStream(n),this.outSize=i,this.outWindowReleaseStream(),this.outWindow.stream=a,this.init(),this.state=0,this.rep0=0,this.rep1=0,this.rep2=0,this.rep3=0,this.outSize=i,this.nowPos64=[0,0],this.prevByte=0,this.decoder=this,this.encoder=null,this.alive=1}processChunk(){if(!this.alive)throw new Error("Bad state");if(this.encoder)throw new Error("No encoding");const n=this.codeOneChunk();if(n===-1)throw new Error("Corrupted input");const i=tr(this.outSize,[0,0])>=0&&tr(this.nowPos64,this.outSize)>=0;return(n||i)&&(this.flush(),this.outWindowReleaseStream(),this.rangeDecoder.setStream(null),this.alive=0),this.alive}writeToOutput(n,i,a,l){const d=n.count+l;if(d>n.buf.length){const m=Math.max(n.buf.length*2,d),h=new Array(m);for(let p=0;p<n.count;p++)h[p]=n.buf[p];n.buf=h}for(let m=0;m<l;m++)n.buf[n.count+m]=i[a+m];n.count+=l}isBufferWithCount(n){const i=n;return!!i&&Array.isArray(i.buf)&&typeof i.count=="number"&&typeof i.write=="function"}flush(){const n=this.outWindow.pos-this.outWindow.streamPos;if(n){if(this.outWindow.stream&&this.outWindow.buffer){const i=this.outWindow.stream;if(this.isBufferWithCount(i))this.writeToOutput(i,this.outWindow.buffer,this.outWindow.streamPos,n);else if(typeof i.write=="function"){const a=this.outWindow.buffer.slice(this.outWindow.streamPos,this.outWindow.streamPos+n);i.write(a)}}this.outWindow.pos>=this.outWindow.windowSize&&(this.outWindow.pos=0),this.outWindow.streamPos=this.outWindow.pos}}cleanup(){this.outWindow.stream=null,this.rangeDecoder.stream=null}}class yg{constructor(){$(this,"choice",Be(2));$(this,"lowCoder",[]);$(this,"midCoder",[]);$(this,"highCoder",$t(8));$(this,"tableSize",0);$(this,"prices",[]);$(this,"counters",[]);for(let n=0;n<16;++n)this.lowCoder[n]=$t(3),this.midCoder[n]=$t(3)}init(n){Oe(this.choice);for(let i=0;i<n;++i)Oe(this.lowCoder[i].models),Oe(this.midCoder[i].models);Oe(this.highCoder.models)}encode(n,i,a){n<8?(a.encodeBit(this.choice,0,0),a.encodeBitTree(this.lowCoder[i],n)):(n-=8,a.encodeBit(this.choice,0,1),n<8?(a.encodeBit(this.choice,1,0),a.encodeBitTree(this.midCoder[i],n)):(a.encodeBit(this.choice,1,1),a.encodeBitTree(this.highCoder,n-8)))}encodeWithUpdate(n,i,a){this.encode(n,i,a),this.counters&&(this.counters[i]-=1)==0&&(this.counters[i]=this.tableSize)}getPrice(n,i){return this.prices[i*272+n]}initPriceTable(){this.prices=[],this.counters=[]}setTableSize(n){this.tableSize=n}setTableSizeAndInitCounters(n,i){if(this.tableSize=n,this.counters)for(let a=0;a<i;++a)this.counters[a]=n}getTableSize(){return this.tableSize}updateTables(n){(!this.prices||!this.counters)&&this.initPriceTable();for(let i=0;i<n;++i)this.setPrices(i,this.tableSize,this.prices,0),this.counters&&(this.counters[i]=this.tableSize)}getBitTreePrice(n,i){let a,l,d=1,m=0;for(l=n.numBitLevels;l!=0;)l-=1,a=i>>>l&1,m+=this.getBitPrice(n.models[d],a),d=(d<<1)+a;return m}getBitPrice(n,i){return $n(n,i)}setPrices(n,i,a,l){const d=this.getBitPrice(this.choice[0],0),m=this.getBitPrice(this.choice[0],1),h=m+this.getBitPrice(this.choice[1],0),p=m+this.getBitPrice(this.choice[1],1);let v=0;const S=l+n*272;for(v=0;v<8;++v){if(v>=i)return;a[S+v]=d+this.getBitTreePrice(this.lowCoder[n],v)}for(;v<16;++v){if(v>=i)return;a[S+v]=h+this.getBitTreePrice(this.midCoder[n],v-8)}for(;v<i;++v)a[S+v]=p+this.getBitTreePrice(this.highCoder,v-8-8)}}class vg{constructor(){$(this,"coders");this.coders=Be(768,1024)}decodeNormal(n){let i=1;for(;i<256;){const a=n.decodeBit(this.coders,i);i=i<<1|a}return i&255}decodeWithMatchByte(n,i){let a=i,l=1;for(;l<256;){const d=a>>7&1;a<<=1;const m=n.decodeBit(this.coders,(1+d<<8)+l);if(l=l<<1|m,d!==m){for(;l<256;){const h=n.decodeBit(this.coders,l);l=l<<1|h}break}}return l&255}encode(n,i){let a=1;for(let l=7;l>=0;l--){const d=i>>l&1;n.encodeBit(this.coders,a,d),a=a<<1|d}}encodeMatched(n,i,a){let l=i,d=1,m=!0;for(let h=7;h>=0;h--){const p=a>>h&1;let v=d;if(m){const S=l>>h&1;v+=1+S<<8,m=S===p}n.encodeBit(this.coders,v,p),d=d<<1|p}}getPrice(n,i,a){let l=i,d=0,m=1,h=7;if(n)for(;h>=0;){const p=l>>h&1,v=a>>h&1;if(d+=$n(this.coders[1+p<<8+m],v),m=m<<1|v,p!==v){h--;break}h--}for(;h>=0;){const p=a>>h&1;d+=$n(this.coders[m],p),m=m<<1|p,h--}return d}reset(){this.coders.fill(1024)}get decoders(){return this.coders}}class wg{constructor(n,i){$(this,"_coders");$(this,"_numPrevBits");$(this,"_posMask");const a=1<<i+n;this._coders=[],this._numPrevBits=i,this._posMask=(1<<n)-1;for(let l=0;l<a;l++)this._coders[l]=new vg}getSubCoder(n,i){return this._coders[((n&this._posMask)<<this._numPrevBits)+(i>>8-this._numPrevBits)]}reset(){this._coders.forEach(n=>n.reset())}get numPrevBits(){return this._numPrevBits}get numPosBits(){return Math.log2(this._posMask+1)}get posMask(){return this._posMask}get coders(){return this._coders}}const Lo=new Map;function bg(o){return o<<6}function Yl(o,n){const i=`${o.numBitLevels}-${n}`;if(Lo.has(i))return Lo.get(i);let a=0,l=1;for(let d=o.numBitLevels;d>0;d--){const m=n>>>d-1&1;a+=$n(o.models[l],m),l=(l<<1)+m}return Lo.size<1e4&&Lo.set(i,a),a}class kg{constructor(){$(this,"state",0);$(this,"previousByte",0);$(this,"position",[0,0]);$(this,"repDistances",[0,0,0,0]);$(this,"longestMatchLength",0);$(this,"longestMatchWasFound",!1);$(this,"additionalOffset",0);$(this,"isMatch",Be(192));$(this,"isRep",Be(12));$(this,"isRepG0",Be(12));$(this,"isRepG1",Be(12));$(this,"isRepG2",Be(12));$(this,"isRep0Long",Be(192))}initModels(){Oe(this.isMatch),Oe(this.isRep),Oe(this.isRepG0),Oe(this.isRepG1),Oe(this.isRepG2),Oe(this.isRep0Long)}updateRepDistances(n,i){if(i===0)this.repDistances[3]=this.repDistances[2],this.repDistances[2]=this.repDistances[1],this.repDistances[1]=this.repDistances[0],this.repDistances[0]=n;else{const a=this.repDistances[i];for(let l=i;l>0;l--)this.repDistances[l]=this.repDistances[l-1];this.repDistances[0]=a}}}class Sg{constructor(){$(this,"posSlotEncoder",[]);$(this,"posEncoders",Be(114));$(this,"posAlignEncoder");for(let n=0;n<4;n++)this.posSlotEncoder[n]=$t(6);this.posAlignEncoder=$t(4)}init(){for(const n of this.posSlotEncoder)Oe(n.models);Oe(this.posEncoders),Oe(this.posAlignEncoder.models)}encodePosition(n,i,a){const l=this.getPosSlot(n);if(a.encodeBitTree(this.posSlotEncoder[i],l),l>=4){const d=(l>>1)-1,m=(2|l&1)<<d,h=n-m;l<14?this.encodeReverseBits(h,d,a):(a.encodeDirectBits(h>>4,d-4),a.encodeBitTree(this.posAlignEncoder,h&15))}}getPositionPrice(n,i){const a=this.getPosSlot(n);let l=Yl(this.posSlotEncoder[i],a);if(a>=4){const d=(a>>1)-1,m=(2|a&1)<<d,h=n-m;a<14?l+=this.getReverseBitsPrice(h,d):(l+=bg(d-4),l+=Yl(this.posAlignEncoder,h&15))}return l}getPosSlot(n){return n<4?n:n<1<<20?Nr[n>>6]+12:Nr[n>>26]+52}encodeReverseBits(n,i,a){let l=1;for(let d=0;d<i;d++){const m=n&1;a.encodeBit(this.posEncoders,l,m),l=l<<1|m,n>>>=1}}getReverseBitsPrice(n,i){let a=0,l=1;for(let d=0;d<i;d++){const m=n&1;a+=$n(this.posEncoders[l],m),l=l<<1|m,n>>>=1}return a}}class _g{constructor(){$(this,"encoderState",new kg);$(this,"positionEncoder",new Sg);$(this,"_state",0);$(this,"_previousByte",0);$(this,"_distTableSize",0);$(this,"_longestMatchWasFound",0);$(this,"_optimumEndIndex",0);$(this,"_optimumCurrentIndex",0);$(this,"_additionalOffset",0);$(this,"_dictionarySize",0);$(this,"_matchFinder",null);$(this,"_dictionarySizePrev",0);$(this,"_numFastBytes",0);$(this,"_numLiteralContextBits",0);$(this,"_numLiteralPosStateBits",0);$(this,"_posStateBits",0);$(this,"_posStateMask",0);$(this,"_needReleaseMFStream",0);$(this,"_inStream",null);$(this,"_finished",0);$(this,"nowPos64",[0,0]);$(this,"_repDistances",Be(4));$(this,"_optimum",[]);$(this,"_rangeEncoder",{stream:{buf:[],count:0},rrange:0,cache:0,low:[0,0],cacheSize:0,position:[0,0],encodeBit:()=>{},encodeBitTree:()=>{},encodeDirectBits:()=>{}});$(this,"_isMatch",Be(192));$(this,"_isRep",Be(12));$(this,"_isRepG0",Be(12));$(this,"_isRepG1",Be(12));$(this,"_isRepG2",Be(12));$(this,"_isRep0Long",Be(192));$(this,"_posSlotEncoder",[]);$(this,"_posEncoders",Be(114));$(this,"_posAlignEncoder",null);$(this,"_lenEncoder",null);$(this,"_repMatchLenEncoder",null);$(this,"_literalEncoder",null);$(this,"_matchDistances",[]);$(this,"_posSlotPrices",[]);$(this,"_distancesPrices",[]);$(this,"_alignPrices",Be(16));$(this,"_matchPriceCount",0);$(this,"_alignPriceCount",0);$(this,"reps",Be(4));$(this,"repLens",Be(4));$(this,"processedInSize",[[0,0]]);$(this,"processedOutSize",[[0,0]]);$(this,"finished",[0]);$(this,"properties",Be(5));$(this,"tempPrices",Be(128));$(this,"_longestMatchLength",0);$(this,"_matchFinderType",1);$(this,"_numDistancePairs",0);$(this,"_numFastBytesPrev",-1);$(this,"backRes",0)}baseInit(){this._state=0,this._previousByte=0;for(let n=0;n<4;++n)this._repDistances[n]=0}getOptimum(){return this._optimum}getBackRes(){return this.backRes}setBackRes(n){this.backRes=n}init(){this.baseInit(),this.encoderState.initModels(),this.positionEncoder.init(),this._optimum=[];for(let n=0;n<4096;n++)this._optimum[n]={};this.initEncoderState(),Oe(this._isMatch),Oe(this._isRep0Long),Oe(this._isRep),Oe(this._isRepG0),Oe(this._isRepG1),Oe(this._isRepG2),Oe(this._posEncoders),this.initLiteralEncoder();for(let n=0;n<4;++n)Oe(this._posSlotEncoder[n].models);this._lenEncoder&&this._lenEncoder.init(1<<this._posStateBits),this._repMatchLenEncoder&&this._repMatchLenEncoder.init(1<<this._posStateBits),this._posAlignEncoder&&Oe(this._posAlignEncoder.models),this._longestMatchWasFound=0,this._optimumEndIndex=0,this._optimumCurrentIndex=0,this._additionalOffset=0}initEncoderState(){this._rangeEncoder.low=[0,0],this._rangeEncoder.rrange=4294967295,this._rangeEncoder.cacheSize=1,this._rangeEncoder.cache=0,this._rangeEncoder.position=[0,0]}initLiteralEncoder(){const n=1<<this._literalEncoder.numPrevBits+this._literalEncoder.numPosBits;for(let i=0;i<n;++i)Oe(this._literalEncoder.coders[i].decoders)}createOptimumStructures(){for(let n=0;n<4096;++n)this._optimum[n]={};for(let n=0;n<4;++n)this._posSlotEncoder[n]=$t(6)}createLenPriceTableEncoder(){const n=new yg;return n.initPriceTable(),n}createLiteralEncoderEncoder2(){return{decoders:Be(768)}}createLiteralEncoder(){this._literalEncoder!=null&&this._literalEncoder.numPrevBits==this._numLiteralContextBits&&this._literalEncoder.numPosBits==this._numLiteralPosStateBits||(this._literalEncoder=new wg(this._numLiteralPosStateBits,this._numLiteralContextBits))}initialize(){this._lenEncoder=this.createLenPriceTableEncoder(),this._repMatchLenEncoder=this.createLenPriceTableEncoder(),this._posAlignEncoder=$t(4),this._optimum=[],this.createOptimumStructures(),this.createLiteralEncoder(),this.init()}configure(n){this.setDictionarySize(1<<n.searchDepth),this._numFastBytes=n.filterStrength,this._matchFinderType=n.modeIndex,this._numLiteralContextBits=3,this._numLiteralPosStateBits=0,this._posStateBits=2,this._posStateMask=3}setDictionarySize(n){this._dictionarySize=n;let i=0;for(;n>1<<i;++i);this._distTableSize=i*2}encodeBit(n,i,a){const l=this._rangeEncoder;let d,m=n[i];d=(l.rrange>>>11)*m,a?(l.low=Gn(l.low,this.and64(Zr(d),[4294967295,0])),l.rrange-=d,n[i]=m-(m>>>5)<<16>>16):(l.rrange=d,n[i]=m+(2048-m>>>5)<<16>>16),l.rrange&-16777216||(l.rrange<<=8,this.shiftLow())}encodeBitTree(n,i){let a,l,d=1;for(l=n.numBitLevels;l!=0;)l-=1,a=i>>>l&1,this.encodeBit(n.models,d,a),d=d<<1|a}encodeLiteral(n,i){let a,l=1;for(let d=7;d>=0;--d)a=i>>d&1,this.encodeBit(n.decoders,l,a),l=l<<1|a}encodeMatched(n,i,a){let l,d,m,h=!0,p=1;for(let v=7;v>=0;--v)l=a>>v&1,m=p,h&&(d=i>>v&1,m+=1+d<<8,h=d===l),this.encodeBit(n.decoders,m,l),p=p<<1|l}encodeLength(n,i,a){n.encode(i,a,this)}encodeDirectBits(n,i){const a=this._rangeEncoder;for(let l=i-1;l>=0;l-=1)a.rrange>>>=1,(n>>>l&1)==1&&(a.low=Gn(a.low,Zr(a.rrange))),a.rrange&-16777216||(a.rrange<<=8,this.shiftLow())}reverseEncode(n){const i=this._posAlignEncoder;if(!i)return;let a,l=1;for(let d=0;d<i.numBitLevels;++d)a=n&1,this.encodeBit(i.models,l,a),l=l<<1|a,n>>=1}reverseEncodeRange(n,i,a){let l,d=1;for(let m=0;m<i;++m)l=a&1,this.encodeBit(this._posEncoders,n+d,l),d=d<<1|l,a>>=1}writeEndMarker(n){this.encodeBit(this._isMatch,(this._state<<4)+n,1),this.encodeBit(this._isRep,this._state,0),this._state=this._state<7?7:10,this.encodeLength(this._lenEncoder,0,n);const i=63,a=Ho(2);this.encodeBitTree(this._posSlotEncoder[a],i),this.encodeDirectBits(67108863,26),this.reverseEncode(15)}encodeLengthWithPriceUpdate(n,i,a){n.encodeWithUpdate(i,a,this)}and64(n,i){const a=~~Math.max(Math.min(n[1]/4294967296,2147483647),-2147483648)&~~Math.max(Math.min(i[1]/4294967296,2147483647),-2147483648),l=Yt(n)&Yt(i);let d=a*4294967296,m=l;return l<0&&(m+=4294967296),[m,d]}shru64(n,i){i&=63;let a=this.pwrAsDouble(i),l=vs(Math.floor(n[0]/a),n[1]/a);return n[1]<0&&(l=Gn(l,this.shl64([2,0],63-i))),l}shl64(n,i){let a,l,d,m;if(i&=63,n[0]==0&&n[1]==-9223372036854776e3)return i?[0,0]:n;if(n[1]<0)throw new Error("Neg");return m=this.pwrAsDouble(i),l=n[1]*m%18446744073709552e3,d=n[0]*m,a=d-d%4294967296,l+=a,d-=a,l>=9223372036854776e3&&(l-=18446744073709552e3),[d,l]}pwrAsDouble(n){return n<=30?1<<n:this.pwrAsDouble(30)*this.pwrAsDouble(n-30)}shiftLow(){const n=this._rangeEncoder,i=Yt(this.shru64(n.low,32));if(i!=0||tr(n.low,[4278190080,0])<0){n.position=Gn(n.position,Zr(n.cacheSize));let a=n.cache;do this.writeToStream(n.stream,a+i),a=255;while((n.cacheSize-=1)!=0);n.cache=Yt(n.low)>>>24}n.cacheSize+=1,n.low=this.shl64(this.and64(n.low,[16777215,0]),8)}writeToStream(n,i){if(n){if(n.count>=n.buf.length){const a=Math.max(n.buf.length*2,n.count+1),l=new Array(a);for(let d=0;d<n.count;d++)l[d]=n.buf[d];n.buf=l}n.buf[n.count++]=i<<24>>24}}initRangeEncoder(){this._rangeEncoder.position=[0,0],this._rangeEncoder.low=[0,0],this._rangeEncoder.rrange=-1,this._rangeEncoder.cacheSize=1,this._rangeEncoder.cache=0}fillAlignPrices(){for(let n=0;n<16;++n)this._alignPrices[n]=this.reverseGetPrice(this._posAlignEncoder,n);this._alignPriceCount=0}fillDistancesPrices(){let n,i,a,l,d,m;for(let h=4;h<128;++h)l=this.getPosSlot(h),a=(l>>1)-1,n=(2|l&1)<<a,this.tempPrices[h]=this.reverseGetPriceArray(this._posEncoders,n-l-1,a,h-n);for(let h=0;h<4;++h){for(i=this._posSlotEncoder[h],d=h<<6,l=0;l<this._distTableSize;l+=1)this._posSlotPrices[d+l]=this.rangeCoder_Encoder_GetPrice_1(i,l);for(l=14;l<this._distTableSize;l+=1)this._posSlotPrices[d+l]+=(l>>1)-1-4<<6;m=h*128;for(let p=0;p<4;++p)this._distancesPrices[m+p]=this._posSlotPrices[d+p];for(let p=4;p<128;++p)this._distancesPrices[m+p]=this._posSlotPrices[d+this.getPosSlot(p)]+this.tempPrices[p]}this._matchPriceCount=0}getPosSlot(n){return n<2048?Nr[n]:n<2097152?Nr[n>>10]+20:Nr[n>>20]+40}reverseGetPrice(n,i){let a,l=1,d=0;for(let m=n.numBitLevels;m!=0;m-=1)a=i&1,i>>>=1,d+=this.getPrice(n.models[l],a),l=l<<1|a;return d}reverseGetPriceArray(n,i,a,l){let d,m=1,h=0;for(let p=a;p!=0;p-=1)d=l&1,l>>>=1,h+=nt[((n[i+m]-d^-d)&2047)>>>2],m=m<<1|d;return h}getPrice(n,i){return $n(n,i)}rangeCoder_Encoder_GetPrice_1(n,i){return Yl(n,i)}createEncoderStructures(){this._optimum=[];for(let n=0;n<4096;n++)this._optimum[n]={};for(let n=0;n<4096;++n)this._optimum[n]={};this._posSlotEncoder=new Array(4);for(let n=0;n<4;++n)this._posSlotEncoder[n]=$t(6)}createMatchFinderAndStructures(){if(!this._matchFinder){const n={};let i=4;this._matchFinderType||(i=2),n.HASH_ARRAY=i>2,n.HASH_ARRAY?(n.kNumHashDirectBytes=0,n.kMinMatchCheck=4,n.kFixHashSize=66560):(n.kNumHashDirectBytes=2,n.kMinMatchCheck=3,n.kFixHashSize=0),n._cyclicBufferSize=0,n._cyclicBufferPos=0,n._streamPos=0,n._cutValue=255,n._matchMaxLen=0,n._streamEndWasReached=0,n._pos=0,n._posLimit=0,n._son=[],n._hash=[],n._bufferBase=[],n._blockSize=0,n._keepSizeAfter=0,n._keepSizeBefore=0,n._pointerToLastSafePosition=0,this._matchFinder=n}this.createLiteralEncoder(),!(this._dictionarySize==this._dictionarySizePrev&&this._numFastBytesPrev==this._numFastBytes)&&(this._dictionarySizePrev=this._dictionarySize,this._numFastBytesPrev=this._numFastBytes)}getSubCoderUtility(n,i){const l=(n&this._literalEncoder.posMask)<<this._literalEncoder.numPrevBits,d=8-this._literalEncoder.numPrevBits,m=(i&255)>>>d,h=l+m;return this._literalEncoder.coders[h]}}class Cg{constructor(n){$(this,"matchFinder");this.matchFinder=n}getIndexByte(n){return this.matchFinder._bufferBase[this.matchFinder._bufferOffset+this.matchFinder._pos+n]}getMatchLen(n,i,a){this.matchFinder._streamEndWasReached&&this.matchFinder._pos+n+a>this.matchFinder._streamPos&&(a=this.matchFinder._streamPos-(this.matchFinder._pos+n)),++i;let l;const d=this.matchFinder._bufferOffset+this.matchFinder._pos+n;for(l=0;l<a&&this.matchFinder._bufferBase[d+l]==this.matchFinder._bufferBase[d+l-i];++l);return l}getNumAvailableBytes(){return this.matchFinder._streamPos-this.matchFinder._pos}moveBlock(){let n=this.matchFinder._bufferOffset+this.matchFinder._pos-this.matchFinder._keepSizeBefore;n>0&&--n;const i=this.matchFinder._bufferOffset+this.matchFinder._streamPos-n;for(let a=0;a<i;++a)this.matchFinder._bufferBase[a]=this.matchFinder._bufferBase[n+a];this.matchFinder._bufferOffset-=n}movePos(){this.matchFinder._pos+=1,this.matchFinder._pos>this.matchFinder._posLimit&&(this.matchFinder._bufferOffset+this.matchFinder._pos>this.matchFinder._pointerToLastSafePosition&&this.moveBlock(),this.readBlock())}readBlock(){if(!this.matchFinder._streamEndWasReached)for(;;){const n=-this.matchFinder._bufferOffset+this.matchFinder._blockSize-this.matchFinder._streamPos;if(!n)return;const i=this.readFromStream(this.matchFinder._bufferOffset+this.matchFinder._streamPos,n);if(i==-1){this.matchFinder._posLimit=this.matchFinder._streamPos,this.matchFinder._bufferOffset+this.matchFinder._posLimit>this.matchFinder._pointerToLastSafePosition&&(this.matchFinder._posLimit=this.matchFinder._pointerToLastSafePosition-this.matchFinder._bufferOffset),this.matchFinder._streamEndWasReached=1;return}this.matchFinder._streamPos+=i,this.matchFinder._streamPos>=this.matchFinder._pos+this.matchFinder._keepSizeAfter&&(this.matchFinder._posLimit=this.matchFinder._streamPos-this.matchFinder._keepSizeAfter)}}reduceOffsets(n){this.matchFinder._bufferOffset+=n,this.matchFinder._posLimit-=n,this.matchFinder._pos-=n,this.matchFinder._streamPos-=n}readFromStream(n,i){const a=this.matchFinder._stream,l=this.matchFinder._bufferBase;if(a.pos>=a.count)return-1;let d;return a.buf instanceof Uint8Array?d=Array.from(a.buf):a.buf instanceof ArrayBuffer?d=Array.from(new Uint8Array(a.buf)):d=a.buf,i=Math.min(i,a.count-a.pos),Of(d,a.pos,l,n,i),a.pos+=i,i}}function Eg(o,n,i,a){return~~((o+n+i+a)/2)+256}function Ng(o,n){const i=n+1;if(o._cyclicBufferSize!==i){const a=(o._cyclicBufferSize=i)*2;o._son=Be(a)}}function Dg(o,n){let i=65536,a=0;return n&&(i=o-1,i|=i>>1,i|=i>>2,i|=i>>4,i|=i>>8,i>>=1,i|=65535,i>16777216&&(i>>=1),a=i,i+=1),{hashMask:a,hashSizeSum:i}}function jg(o){return 16+(o>>1)}function Ag(o){return o<Rf}const Ig={1:{searchDepth:16,filterStrength:64,modeIndex:0},2:{searchDepth:20,filterStrength:64,modeIndex:0},3:{searchDepth:19,filterStrength:64,modeIndex:1},4:{searchDepth:20,filterStrength:64,modeIndex:1},5:{searchDepth:21,filterStrength:128,modeIndex:1},6:{searchDepth:22,filterStrength:128,modeIndex:1},7:{searchDepth:23,filterStrength:128,modeIndex:1},8:{searchDepth:24,filterStrength:255,modeIndex:1},9:{searchDepth:25,filterStrength:255,modeIndex:1}};var me,kt,ze,O,Nn,W,Hf,$f,Xl,Fo,Gf,Vf,Wf,Yf,Xf,Kf,Qf,Kl,Zf,qf,Jf,eh,th,ps,Ql,nh,rh,ih,sh,Zl,oh,ah,lh,ch,Po,uh,ql,Xr,dh,Jl,Mo,ec,fh,Kr,ms,tc,hh,ph,mh,gh;class zf{constructor(){Wr(this,W);Wr(this,me);Wr(this,kt);Wr(this,ze,null);Wr(this,O);Wr(this,Nn);_i(this,me,new _g),_i(this,kt,new xg),_i(this,O,fe(this,W,Hf).call(this)),_i(this,Nn,fe(this,W,$f).call(this))}writeHeaderProperties(){C(this,me).properties[0]=(C(this,me)._posStateBits*5+C(this,me)._numLiteralPosStateBits)*9+C(this,me)._numLiteralContextBits&255;for(let i=0;i<4;i++)C(this,me).properties[1+i]=C(this,me)._dictionarySize>>8*i&255;fe(this,W,Vf).call(this,C(this,O).output,C(this,me).properties,0,5)}GetPosSlot2(n){return n<131072?Nr[n>>6]+12:n<134217728?Nr[n>>16]+32:Nr[n>>26]+52}ReverseEncode(n,i,a){let l,d=1;for(let m=0;m<i;++m)l=a&1,C(this,O).chunker.encoder.encodeBit(C(this,O).chunker.encoder._posEncoders,n+d,l),d=d<<1|l,a>>=1}encodeString(n){let i,a=[],l=0,d=n.length;fe(this,W,Wf).call(this,n,0,d,a,0);for(let h=0;h<d;++h)i=a[h],i>=1&&i<=127?++l:!i||i>=128&&i<=2047?l+=2:l+=3;const m=[];l=0;for(let h=0;h<d;++h)i=a[h],i>=1&&i<=127?m[l++]=i<<24>>24:!i||i>=128&&i<=2047?(m[l++]=(192|i>>6&31)<<24>>24,m[l++]=(128|i&63)<<24>>24):(m[l++]=(224|i>>12&15)<<24>>24,m[l++]=(128|i>>6&63)<<24>>24,m[l++]=(128|i&63)<<24>>24);return m}compress(n,i=5){const a=Ig[i];for(fe(this,W,Kf).call(this,n,a);C(this,O).chunker.processChunk(););const l=fe(this,W,Fo).call(this,C(this,O).output);return new Int8Array(l)}compressString(n,i=5){const a=this.encodeString(n);return this.compress(new Uint8Array(a),i)}decompress(n){for(fe(this,W,Kl).call(this,n);C(this,Nn).chunker.processChunk(););return fe(this,W,Fo).call(this,C(this,Nn).output)}decompressString(n){for(fe(this,W,Kl).call(this,n);C(this,Nn).chunker.processChunk(););const i=fe(this,W,Fo).call(this,C(this,Nn).output),a=fe(this,W,gh).call(this,i);return typeof a=="string"?a:String.fromCharCode(...a)}codeOneBlock(){fe(this,W,oh).call(this)}releaseStreams(){fe(this,W,fh).call(this)}}me=new WeakMap,kt=new WeakMap,ze=new WeakMap,O=new WeakMap,Nn=new WeakMap,W=new WeakSet,Hf=function(){return{chunker:new pg(this),output:{buf:Be(32),count:0,write:()=>{}}}},$f=function(){return{chunker:new hf(C(this,kt)),output:{buf:Be(32),count:0,write:()=>{}}}},Xl=function(n){if(n.pos>=n.count)return-1;let i;return n.buf instanceof ArrayBuffer?i=new Uint8Array(n.buf)[n.pos++]:(n.buf instanceof Uint8Array,i=n.buf[n.pos++]),i&255},Fo=function(n){return n.buf.slice(0,n.count)},Gf=function(n,i){if(n){if(n.count>=n.buf.length){const a=Math.max(n.buf.length*2,n.count+1),l=new Array(a);for(let d=0;d<n.count;d++)l[d]=n.buf[d];n.buf=l}n.buf[n.count++]=i<<24>>24}},Vf=function(n,i,a,l){const d=n.count+l;if(d>n.buf.length){const m=Math.max(n.buf.length*2,d),h=new Array(m);for(let p=0;p<n.count;p++)h[p]=n.buf[p];n.buf=h}Of(i,a,n.buf,n.count,l),n.count+=l},Wf=function(n,i,a,l,d){for(let m=i;m<a;++m)l[d++]=n.charCodeAt(m)},Yf=function(n){C(this,me).initialize(),C(this,me).configure(n)},Xf=function(n,i,a){if(tr(i,Ol)<0)throw new Error("invalid length "+i);C(this,O).length_0=i,fe(this,W,lh).call(this),fe(this,W,Yf).call(this,a),this.writeHeaderProperties();for(let l=0;l<64;l+=8)fe(this,W,Gf).call(this,C(this,O).output,Yt(dg(i,l))&255);C(this,me)._needReleaseMFStream=0,C(this,me)._inStream=n,C(this,me)._finished=0,fe(this,W,ah).call(this),C(this,me)._rangeEncoder.stream=C(this,O).output,C(this,me).init(),C(this,me).fillDistancesPrices(),C(this,me).fillAlignPrices(),C(this,me)._lenEncoder.setTableSize(C(this,me)._numFastBytes+1-2),C(this,me)._lenEncoder.updateTables(1<<C(this,me)._posStateBits),C(this,me)._repMatchLenEncoder.setTableSize(C(this,me)._numFastBytes+1-2),C(this,me)._repMatchLenEncoder.updateTables(1<<C(this,me)._posStateBits),C(this,me).nowPos64=Ei,C(this,O).chunker.encoder=C(this,me),C(this,O).chunker.alive=1},Kf=function(n,i){const a=n instanceof ArrayBuffer?n.byteLength:n.length,l=Math.max(32,Math.ceil(a*1.2));C(this,O).output={buf:Be(l),count:0,write:()=>{}};const d={pos:0,buf:n instanceof ArrayBuffer?new Uint8Array(n):n,count:n instanceof ArrayBuffer?new Uint8Array(n).length:n.length};fe(this,W,Xf).call(this,d,Zr(n instanceof ArrayBuffer?n.byteLength:n.length),i)},Qf=function(n){let i="",a=[],l,d;for(let h=0;h<5;++h){if(l=fe(this,W,Xl).call(this,n),l==-1)throw new Error("truncated input");a[h]=l<<24>>24}if(C(this,kt).setDecoderProperties(a)?0:1)throw new Error("corrupted input");for(let h=0;h<64;h+=8){if(l=fe(this,W,Xl).call(this,n),l==-1)throw new Error("truncated input");l=l.toString(16),l.length==1&&(l="0"+l),i=l+""+i}/^0+$|^f+$/i.test(i)?C(this,O).length_0=Ol:(d=parseInt(i,16),d>sg?C(this,O).length_0=Ol:C(this,O).length_0=Zr(d)),C(this,Nn).chunker=fe(this,W,ih).call(this,n,C(this,O).length_0)},Kl=function(n){const i=n instanceof ArrayBuffer?n.byteLength:n.length,a=32,l=i*2,d=Math.max(a,l);C(this,Nn).output={buf:Be(d),count:0,write:()=>{}};const m={buf:n,pos:0,count:n instanceof ArrayBuffer?n.byteLength:n.length};fe(this,W,Qf).call(this,m)},Zf=function(n,i,a){let l;C(this,me)._matchFinder._keepSizeBefore=n,C(this,me)._matchFinder._keepSizeAfter=i,l=n+i+a,(C(this,me)._matchFinder._bufferBase==null||C(this,me)._matchFinder._blockSize!=l)&&(C(this,me)._matchFinder._bufferBase=Be(l),C(this,me)._matchFinder._blockSize=l),C(this,me)._matchFinder._pointerToLastSafePosition=C(this,me)._matchFinder._blockSize-i},qf=function(){const n=C(this,O).chunker.encoder._matchFinder;let i;n._pos+=1,n._pos>n._posLimit&&(i=n._bufferOffset+n._pos,i>n._pointerToLastSafePosition&&C(this,ze).moveBlock(),C(this,ze).readBlock())},Jf=function(n,i){const a=C(this,me)._dictionarySize,l=C(this,me)._numFastBytes;if(Ag(a)){C(this,me)._matchFinder._cutValue=jg(l);const d=Eg(a,n,l,i);fe(this,W,Zf).call(this,a+n,l+i,d),C(this,me)._matchFinder._matchMaxLen=l,Ng(C(this,me)._matchFinder,a);const{hashMask:m,hashSizeSum:h}=Dg(a,C(this,me)._matchFinder.HASH_ARRAY);if(C(this,me)._matchFinder.HASH_ARRAY){C(this,me)._matchFinder._hashMask=m;const p=h+C(this,me)._matchFinder.kFixHashSize;p!==C(this,me)._matchFinder._hashSizeSum&&(C(this,me)._matchFinder._hashSizeSum=p,C(this,me)._matchFinder._hash=Be(p))}else h!==C(this,me)._matchFinder._hashSizeSum&&(C(this,me)._matchFinder._hashSizeSum=h,C(this,me)._matchFinder._hash=Be(h))}},eh=function(){let n,i,a,l,d,m,h,p,v,S,g,w,_,E,P,k,N,D,T,A,G;const M=C(this,O).chunker.encoder._matchFinder,Z=C(this,O).chunker.encoder._matchDistances;if(M._pos+M._matchMaxLen<=M._streamPos)E=M._matchMaxLen;else if(E=M._streamPos-M._pos,E<M.kMinMatchCheck)return fe(this,W,ps).call(this),0;for(N=0,P=M._pos>M._cyclicBufferSize?M._pos-M._cyclicBufferSize:0,i=M._bufferOffset+M._pos,k=1,p=0,v=0,M.HASH_ARRAY?(G=To[M._bufferBase[i]&255]^M._bufferBase[i+1]&255,p=G&1023,G^=(M._bufferBase[i+2]&255)<<8,v=G&65535,S=(G^To[M._bufferBase[i+3]&255]<<5)&M._hashMask):S=M._bufferBase[i]&255^(M._bufferBase[i+1]&255)<<8,a=M._hash[M.kFixHashSize+S]||0,M.HASH_ARRAY&&(l=M._hash[p]||0,d=M._hash[1024+v]||0,M._hash[p]=M._pos,M._hash[1024+v]=M._pos,l>P&&M._bufferBase[M._bufferOffset+l]==M._bufferBase[i]&&(Z[N++]=k=2,Z[N++]=M._pos-l-1),d>P&&M._bufferBase[M._bufferOffset+d]==M._bufferBase[i]&&(d==l&&(N-=2),Z[N++]=k=3,Z[N++]=M._pos-d-1,l=d),N!=0&&l==a&&(N-=2,k=1)),M._hash[M.kFixHashSize+S]=M._pos,T=(M._cyclicBufferPos<<1)+1,A=M._cyclicBufferPos<<1,w=_=M.kNumHashDirectBytes,M.kNumHashDirectBytes!=0&&a>P&&M._bufferBase[M._bufferOffset+a+M.kNumHashDirectBytes]!=M._bufferBase[i+M.kNumHashDirectBytes]&&(Z[N++]=k=M.kNumHashDirectBytes,Z[N++]=M._pos-a-1),n=M._cutValue;;){if(a<=P||n==0){n-=1,M._son[T]=M._son[A]=0;break}if(h=M._pos-a,m=(h<=M._cyclicBufferPos?M._cyclicBufferPos-h:M._cyclicBufferPos-h+M._cyclicBufferSize)<<1,D=M._bufferOffset+a,g=w<_?w:_,M._bufferBase[D+g]==M._bufferBase[i+g]){for(;(g+=1)!=E&&M._bufferBase[D+g]==M._bufferBase[i+g];);if(k<g&&(Z[N++]=k=g,Z[N++]=h-1,g==E)){M._son[A]=M._son[m],M._son[T]=M._son[m+1];break}}(M._bufferBase[D+g]&255)<(M._bufferBase[i+g]&255)?(M._son[A]=a,A=m+1,a=M._son[A],_=g):(M._son[T]=a,T=m,a=M._son[T],w=g)}return fe(this,W,ps).call(this),N},th=function(){C(this,O).chunker.encoder._matchFinder._bufferOffset=0,C(this,O).chunker.encoder._matchFinder._pos=0,C(this,O).chunker.encoder._matchFinder._streamPos=0,C(this,O).chunker.encoder._matchFinder._streamEndWasReached=0,C(this,ze).readBlock(),C(this,O).chunker.encoder._matchFinder._cyclicBufferPos=0,C(this,ze).reduceOffsets(-1)},ps=function(){let n;const i=C(this,O).chunker.encoder._matchFinder;(i._cyclicBufferPos+=1)>=i._cyclicBufferSize&&(i._cyclicBufferPos=0),fe(this,W,qf).call(this),i._pos==Rf&&(n=i._pos-i._cyclicBufferSize,fe(this,W,Ql).call(this,i._cyclicBufferSize*2,n),fe(this,W,Ql).call(this,i._hashSizeSum,n),C(this,ze).reduceOffsets(n))},Ql=function(n,i){const a=C(this,O).chunker.encoder._matchFinder._son;for(let l=0,d;l<n;++l)d=a[l]||0,d<=i?d=0:d-=i,a[l]=d},nh=function(n,i){n.HASH_ARRAY=i>2,n.HASH_ARRAY?(n.kNumHashDirectBytes=0,n.kMinMatchCheck=4,n.kFixHashSize=66560):(n.kNumHashDirectBytes=2,n.kMinMatchCheck=3,n.kFixHashSize=0)},rh=function(n){const i=C(this,O).chunker.encoder._matchFinder;let a,l,d,m,h,p,v,S,g,w,_,E,P,k,N,D,T;do{if(i._pos+i._matchMaxLen<=i._streamPos)E=i._matchMaxLen;else if(E=i._streamPos-i._pos,E<i.kMinMatchCheck){fe(this,W,ps).call(this);continue}for(P=i._pos>i._cyclicBufferSize?i._pos-i._cyclicBufferSize:0,l=i._bufferOffset+i._pos,i.HASH_ARRAY?(T=To[i._bufferBase[l]&255]^i._bufferBase[l+1]&255,p=T&1023,i._hash[p]=i._pos,T^=(i._bufferBase[l+2]&255)<<8,v=T&65535,i._hash[1024+v]=i._pos,S=(T^To[i._bufferBase[l+3]&255]<<5)&i._hashMask):S=i._bufferBase[l]&255^(i._bufferBase[l+1]&255)<<8,d=i._hash[i.kFixHashSize+S],i._hash[i.kFixHashSize+S]=i._pos,N=(i._cyclicBufferPos<<1)+1,D=i._cyclicBufferPos<<1,w=_=i.kNumHashDirectBytes,a=i._cutValue;;){if(d<=P||a==0){a-=1,i._son[N]=i._son[D]=0;break}if(h=i._pos-d,m=(h<=i._cyclicBufferPos?i._cyclicBufferPos-h:i._cyclicBufferPos-h+i._cyclicBufferSize)<<1,k=i._bufferOffset+d,g=w<_?w:_,i._bufferBase[k+g]==i._bufferBase[l+g]){for(;(g+=1)!=E&&i._bufferBase[k+g]==i._bufferBase[l+g];);if(g==E){i._son[D]=i._son[m],i._son[N]=i._son[m+1];break}}(i._bufferBase[k+g]&255)<(i._bufferBase[l+g]&255)?(i._son[D]=d,D=m+1,d=i._son[D],_=g):(i._son[N]=d,N=m,d=i._son[N],w=g)}fe(this,W,ps).call(this)}while((n-=1)!=0)},ih=function(n,i){C(this,kt).rangeDecoder.stream=n,C(this,kt).flush(),C(this,kt).outWindow.stream=null,C(this,kt).outWindow.stream=C(this,Nn).output,fe(this,W,sh).call(this),C(this,kt).state=0,C(this,kt).rep0=0,C(this,kt).rep1=0,C(this,kt).rep2=0,C(this,kt).rep3=0,C(this,kt).outSize=i,C(this,kt).nowPos64=Ei,C(this,kt).prevByte=0;const a=new hf(C(this,kt));return a.alive=1,a},sh=function(){C(this,kt).init()},Zl=function(n){const i=C(this,O).chunker.encoder;let a,l,d,m;i._optimumEndIndex=n,d=i._optimum[n].posPrev,l=i._optimum[n].backPrev;do i._optimum[n].prev1IsChar&&(fe(this,W,tc).call(this,i._optimum[d]),i._optimum[d].posPrev=d-1,i._optimum[n].prev2&&(i._optimum[d-1].prev1IsChar=0,i._optimum[d-1].posPrev=i._optimum[n].posPrev2,i._optimum[d-1].backPrev=i._optimum[n].backPrev2)),m=d,a=l,l=i._optimum[m].backPrev,d=i._optimum[m].posPrev,i._optimum[m].backPrev=a,i._optimum[m].posPrev=n,n=m;while(n>0);return i.backRes=i._optimum[0].backPrev,i._optimumCurrentIndex=i._optimum[0].posPrev,i._optimumCurrentIndex},oh=function(){let n,i,a,l,d,m,h,p,v,S,g,w,_,E;if(C(this,O).chunker.encoder.processedInSize[0]=Ei,C(this,O).chunker.encoder.processedOutSize[0]=Ei,C(this,O).chunker.encoder.finished[0]=1,_=C(this,O).chunker.encoder.nowPos64,C(this,O).chunker.encoder._inStream&&(C(this,O).chunker.encoder._matchFinder._stream=C(this,O).chunker.encoder._inStream,fe(this,W,th).call(this),C(this,O).chunker.encoder._needReleaseMFStream=1,C(this,O).chunker.encoder._inStream=null),!C(this,O).chunker.encoder._finished){if(C(this,O).chunker.encoder._finished=1,tr(C(this,O).chunker.encoder.nowPos64,Ei)===0){if(!C(this,ze).getNumAvailableBytes()){fe(this,W,Po).call(this,Yt(C(this,O).chunker.encoder.nowPos64));return}fe(this,W,Mo).call(this),w=Yt(C(this,O).chunker.encoder.nowPos64)&C(this,O).chunker.encoder._posStateMask,C(this,O).chunker.encoder.encodeBit(C(this,O).chunker.encoder._isMatch,(C(this,O).chunker.encoder._state<<4)+w,0),C(this,O).chunker.encoder._state=Er(C(this,O).chunker.encoder._state),a=C(this,ze).getIndexByte(-C(this,O).chunker.encoder._additionalOffset),C(this,O).chunker.encoder.encodeLiteral(fe(this,W,Kr).call(this,Yt(C(this,O).chunker.encoder.nowPos64),C(this,O).chunker.encoder._previousByte),a),C(this,O).chunker.encoder._previousByte=a,C(this,O).chunker.encoder._additionalOffset-=1,C(this,O).chunker.encoder.nowPos64=Gn(C(this,O).chunker.encoder.nowPos64,ug)}if(!C(this,ze).getNumAvailableBytes()){fe(this,W,Po).call(this,Yt(C(this,O).chunker.encoder.nowPos64));return}for(;;){if(m=fe(this,W,uh).call(this,Yt(C(this,O).chunker.encoder.nowPos64)),v=C(this,O).chunker.encoder.backRes,w=Yt(C(this,O).chunker.encoder.nowPos64)&C(this,O).chunker.encoder._posStateMask,i=(C(this,O).chunker.encoder._state<<4)+w,m==1&&v==-1)C(this,O).chunker.encoder.encodeBit(C(this,O).chunker.encoder._isMatch,i,0),a=C(this,ze).getIndexByte(-C(this,O).chunker.encoder._additionalOffset),E=fe(this,W,Kr).call(this,Yt(C(this,O).chunker.encoder.nowPos64),C(this,O).chunker.encoder._previousByte),C(this,O).chunker.encoder._state<7?C(this,O).chunker.encoder.encodeLiteral(E,a):(p=C(this,ze).getIndexByte(-C(this,O).chunker.encoder._repDistances[0]-1-C(this,O).chunker.encoder._additionalOffset),C(this,O).chunker.encoder.encodeMatched(E,p,a)),C(this,O).chunker.encoder._previousByte=a,C(this,O).chunker.encoder._state=Er(C(this,O).chunker.encoder._state);else{if(C(this,O).chunker.encoder.encodeBit(C(this,O).chunker.encoder._isMatch,i,1),v<4){if(C(this,O).chunker.encoder.encodeBit(C(this,O).chunker.encoder._isRep,C(this,O).chunker.encoder._state,1),v?(C(this,O).chunker.encoder.encodeBit(C(this,O).chunker.encoder._isRepG0,C(this,O).chunker.encoder._state,1),v==1?C(this,O).chunker.encoder.encodeBit(C(this,O).chunker.encoder._isRepG1,C(this,O).chunker.encoder._state,0):(C(this,O).chunker.encoder.encodeBit(C(this,O).chunker.encoder._isRepG1,C(this,O).chunker.encoder._state,1),C(this,O).chunker.encoder.encodeBit(C(this,O).chunker.encoder._isRepG2,C(this,O).chunker.encoder._state,v-2))):(C(this,O).chunker.encoder.encodeBit(C(this,O).chunker.encoder._isRepG0,C(this,O).chunker.encoder._state,0),m==1?C(this,O).chunker.encoder.encodeBit(C(this,O).chunker.encoder._isRep0Long,i,0):C(this,O).chunker.encoder.encodeBit(C(this,O).chunker.encoder._isRep0Long,i,1)),m==1?C(this,O).chunker.encoder._state=C(this,O).chunker.encoder._state<7?9:11:(C(this,O).chunker.encoder.encodeLength(C(this,O).chunker.encoder._repMatchLenEncoder,m-2,w),C(this,O).chunker.encoder._state=C(this,O).chunker.encoder._state<7?8:11),l=C(this,O).chunker.encoder._repDistances[v],v!=0){const P=C(this,O).chunker.encoder;for(let k=v;k>=1;--k)P._repDistances[k]=P._repDistances[k-1];P._repDistances[0]=l}}else{C(this,O).chunker.encoder.encodeBit(C(this,O).chunker.encoder._isRep,C(this,O).chunker.encoder._state,0),C(this,O).chunker.encoder._state=C(this,O).chunker.encoder._state<7?7:10,C(this,O).chunker.encoder.encodeLength(C(this,O).chunker.encoder._lenEncoder,m-2,w),v-=4,g=C(this,O).chunker.encoder.getPosSlot(v),h=Ho(m),C(this,O).chunker.encoder.encodeBitTree(C(this,O).chunker.encoder._posSlotEncoder[h],g),g>=4&&(d=(g>>1)-1,n=(2|g&1)<<d,S=v-n,g<14?C(this,O).chunker.encoder.reverseEncodeRange(n-g-1,d,S):(C(this,O).chunker.encoder.encodeDirectBits(S>>4,d-4),C(this,O).chunker.encoder.reverseEncode(S&15),C(this,O).chunker.encoder._alignPriceCount+=1)),l=v;const P=C(this,O).chunker.encoder;for(let k=3;k>=1;--k)P._repDistances[k]=P._repDistances[k-1];P._repDistances[0]=l,P._matchPriceCount+=1}C(this,O).chunker.encoder._previousByte=C(this,ze).getIndexByte(m-1-C(this,O).chunker.encoder._additionalOffset)}if(C(this,O).chunker.encoder._additionalOffset-=m,C(this,O).chunker.encoder.nowPos64=Gn(C(this,O).chunker.encoder.nowPos64,Zr(m)),!C(this,O).chunker.encoder._additionalOffset){if(C(this,O).chunker.encoder._matchPriceCount>=128&&C(this,O).chunker.encoder.fillDistancesPrices(),C(this,O).chunker.encoder._alignPriceCount>=16&&fe(this,W,ch).call(this,C(this,O).chunker.encoder),C(this,O).chunker.encoder.processedInSize[0]=C(this,O).chunker.encoder.nowPos64,C(this,O).chunker.encoder.processedOutSize[0]=fe(this,W,mh).call(this),!C(this,ze).getNumAvailableBytes()){fe(this,W,Po).call(this,Yt(C(this,O).chunker.encoder.nowPos64));return}if(tr(Uf(C(this,O).chunker.encoder.nowPos64,_),[4096,0])>=0){C(this,O).chunker.encoder._finished=0,C(this,O).chunker.encoder.finished[0]=0;return}}}}},ah=function(){let n,i;C(this,me)._matchFinder||(n={},i=4,C(this,me)._matchFinderType||(i=2),fe(this,W,nh).call(this,n,i),C(this,me)._matchFinder=n,_i(this,ze,new Cg(n))),C(this,me).createLiteralEncoder(),!(C(this,me)._dictionarySize==C(this,me)._dictionarySizePrev&&C(this,me)._numFastBytesPrev==C(this,me)._numFastBytes)&&(fe(this,W,Jf).call(this,4096,274),C(this,me)._dictionarySizePrev=C(this,me)._dictionarySize,C(this,me)._numFastBytesPrev=C(this,me)._numFastBytes)},lh=function(){for(let n=0;n<4096;++n)C(this,me)._optimum[n]={};for(let n=0;n<4;++n)C(this,me)._posSlotEncoder[n]=$t(6)},ch=function(n){for(let i=0;i<16;++i)n._alignPrices[i]=fe(this,W,ph).call(this,n._posAlignEncoder,i);n._alignPriceCount=0},Po=function(n){fe(this,W,ec).call(this),C(this,O).chunker.encoder.writeEndMarker(n&C(this,O).chunker.encoder._posStateMask);for(let i=0;i<5;++i)C(this,O).chunker.encoder.shiftLow()},uh=function(n){let i,a,l,d,m,h,p,v,S,g,w,_,E,P,k,N,D,T,A,G,M,Z,de,he,Se,Ee,_e,Y,re,ve,ge,ie,X,ue,te,B,b,V,Q,ee,K,oe,ae,Ce,Le,yt,St,vt,Fe;const y=C(this,O).chunker.encoder;if(y._optimumEndIndex!=y._optimumCurrentIndex)return Fe=y._optimum[y._optimumCurrentIndex].posPrev-y._optimumCurrentIndex,y.backRes=y._optimum[y._optimumCurrentIndex].backPrev,y._optimumCurrentIndex=y._optimum[y._optimumCurrentIndex].posPrev,Fe;if(y._optimumCurrentIndex=y._optimumEndIndex=0,y._longestMatchWasFound?(w=y._longestMatchLength,y._longestMatchWasFound=0):w=fe(this,W,Mo).call(this),Se=y._numDistancePairs,de=C(this,ze).getNumAvailableBytes()+1,de<2)return y.backRes=-1,1;de>273&&(de=273),V=0;for(let Ue=0;Ue<4;++Ue)y.reps[Ue]=y._repDistances[Ue],y.repLens[Ue]=C(this,ze).getMatchLen(-1,y.reps[Ue],273),y.repLens[Ue]>y.repLens[V]&&(V=Ue);if(y.repLens[V]>=y._numFastBytes)return y.backRes=V,Fe=y.repLens[V],fe(this,W,Jl).call(this,Fe-1),Fe;if(w>=y._numFastBytes)return y.backRes=C(this,O).chunker.encoder._matchDistances[Se-1]+4,fe(this,W,Jl).call(this,w-1),w;if(p=C(this,ze).getIndexByte(-1),k=C(this,ze).getIndexByte(-y._repDistances[0]-1-1),w<2&&p!=k&&y.repLens[V]<2)return y.backRes=-1,1;if(y._optimum[0].state=y._state,ie=n&y._posStateMask,y._optimum[1].price=nt[y._isMatch[(y._state<<4)+ie]>>>2]+fe(this,W,ms).call(this,fe(this,W,Kr).call(this,n,y._previousByte),y._state>=7,k,p),fe(this,W,tc).call(this,y._optimum[1]),N=nt[2048-y._isMatch[(y._state<<4)+ie]>>>2],b=N+nt[2048-y._isRep[y._state]>>>2],k==p&&(Q=b+fe(this,W,dh).call(this,ie),Q<y._optimum[1].price&&(y._optimum[1].price=Q,fe(this,W,hh).call(this,y._optimum[1]))),g=w>=y.repLens[V]?w:y.repLens[V],g<2)return y.backRes=y._optimum[1].backPrev,1;y._optimum[1].posPrev=0,y._optimum[0].backs0=y.reps[0],y._optimum[0].backs1=y.reps[1],y._optimum[0].backs2=y.reps[2],y._optimum[0].backs3=y.reps[3],S=g;do y._optimum[S].price=Ci,S-=1;while(S>=2);for(let Ue=0;Ue<4;++Ue)if(B=y.repLens[Ue],!(B<2)){ue=b+fe(this,W,Xr).call(this,Ue,y._state,ie);do d=ue+y._repMatchLenEncoder.getPrice(B-2,ie),re=y._optimum[B],d<re.price&&(re.price=d,re.posPrev=0,re.backPrev=Ue,re.prev1IsChar=0);while((B-=1)>=2)}if(Z=N+nt[y._isRep[y._state]>>>2],S=y.repLens[0]>=2?y.repLens[0]+1:2,S<=w){for(Ee=0;S>y._matchDistances[Ee];)Ee+=2;for(;v=y._matchDistances[Ee+1],d=Z+fe(this,W,ql).call(this,v,S,ie),re=y._optimum[S],d<re.price&&(re.price=d,re.posPrev=0,re.backPrev=v+4,re.prev1IsChar=0),!(S==y._matchDistances[Ee]&&(Ee+=2,Ee==Se));S+=1);}for(i=0;;){if(++i,i==g)return fe(this,W,Zl).call(this,i);if(D=fe(this,W,Mo).call(this),Se=y._numDistancePairs,D>=y._numFastBytes)return y._longestMatchLength=D,y._longestMatchWasFound=1,fe(this,W,Zl).call(this,i);if(n+=1,ge=y._optimum[i].posPrev,y._optimum[i].prev1IsChar?(ge-=1,y._optimum[i].prev2?(K=y._optimum[y._optimum[i].posPrev2].state,y._optimum[i].backPrev2<4?K=K<7?8:11:K=K<7?7:10):K=y._optimum[ge].state,K=Er(K)):K=y._optimum[ge].state,ge==i-1?y._optimum[i].backPrev?K=Er(K):K=K<7?9:11:(y._optimum[i].prev1IsChar&&y._optimum[i].prev2?(ge=y._optimum[i].posPrev2,ve=y._optimum[i].backPrev2,K=K<7?8:11):(ve=y._optimum[i].backPrev,ve<4?K=K<7?8:11:K=K<7?7:10),Y=y._optimum[ge],ve<4?ve?ve==1?(y.reps[0]=Y.backs1,y.reps[1]=Y.backs0,y.reps[2]=Y.backs2,y.reps[3]=Y.backs3):ve==2?(y.reps[0]=Y.backs2,y.reps[1]=Y.backs0,y.reps[2]=Y.backs1,y.reps[3]=Y.backs3):(y.reps[0]=Y.backs3,y.reps[1]=Y.backs0,y.reps[2]=Y.backs1,y.reps[3]=Y.backs2):(y.reps[0]=Y.backs0,y.reps[1]=Y.backs1,y.reps[2]=Y.backs2,y.reps[3]=Y.backs3):(y.reps[0]=ve-4,y.reps[1]=Y.backs0,y.reps[2]=Y.backs1,y.reps[3]=Y.backs2)),y._optimum[i].state=K,y._optimum[i].backs0=y.reps[0],y._optimum[i].backs1=y.reps[1],y._optimum[i].backs2=y.reps[2],y._optimum[i].backs3=y.reps[3],h=y._optimum[i].price,p=C(this,ze).getIndexByte(-1),k=C(this,ze).getIndexByte(-y.reps[0]-1-1),ie=n&y._posStateMask,a=h+nt[y._isMatch[(K<<4)+ie]>>>2]+fe(this,W,ms).call(this,fe(this,W,Kr).call(this,n,C(this,ze).getIndexByte(-2)),K>=7,k,p),G=y._optimum[i+1],T=0,a<G.price&&(G.price=a,G.posPrev=i,G.backPrev=-1,G.prev1IsChar=0,T=1),N=h+nt[2048-y._isMatch[(K<<4)+ie]>>>2],b=N+nt[2048-y._isRep[K]>>>2],k==p&&!(G.posPrev<i&&!G.backPrev)&&(Q=b+(nt[y._isRepG0[K]>>>2]+nt[y._isRep0Long[(K<<4)+ie]>>>2]),Q<=G.price&&(G.price=Q,G.posPrev=i,G.backPrev=0,G.prev1IsChar=0,T=1)),he=C(this,ze).getNumAvailableBytes()+1,he=4095-i<he?4095-i:he,de=he,!(de<2)){if(de>y._numFastBytes&&(de=y._numFastBytes),!T&&k!=p&&(ae=Math.min(he-1,y._numFastBytes),E=C(this,ze).getMatchLen(0,y.reps[0],ae),E>=2)){for(oe=Er(K),X=n+1&y._posStateMask,M=a+nt[2048-y._isMatch[(oe<<4)+X]>>>2]+nt[2048-y._isRep[oe]>>>2],_e=i+1+E;g<_e;)y._optimum[g+=1].price=Ci;d=M+(Ce=y._repMatchLenEncoder.getPrice(E-2,X),Ce+fe(this,W,Xr).call(this,0,oe,X)),re=y._optimum[_e],d<re.price&&(re.price=d,re.posPrev=i+1,re.backPrev=0,re.prev1IsChar=1,re.prev2=0)}for(ee=2,te=0;te<4;++te)if(_=C(this,ze).getMatchLen(-1,y.reps[te],de),!(_<2)){P=_;do{for(;g<i+_;)y._optimum[g+=1].price=Ci;d=b+(Le=y._repMatchLenEncoder.getPrice(_-2,ie),Le+fe(this,W,Xr).call(this,te,K,ie)),re=y._optimum[i+_],d<re.price&&(re.price=d,re.posPrev=i,re.backPrev=te,re.prev1IsChar=0)}while((_-=1)>=2);if(_=P,te||(ee=_+1),_<he&&(ae=Math.min(he-1-_,y._numFastBytes),E=C(this,ze).getMatchLen(_,y.reps[te],ae),E>=2)){for(oe=K<7?8:11,X=n+_&y._posStateMask,l=b+(yt=y._repMatchLenEncoder.getPrice(_-2,ie),yt+fe(this,W,Xr).call(this,te,K,ie))+nt[y._isMatch[(oe<<4)+X]>>>2]+fe(this,W,ms).call(this,fe(this,W,Kr).call(this,n+_,C(this,ze).getIndexByte(_-1-1)),!0,C(this,ze).getIndexByte(_-1-(y.reps[te]+1)),C(this,ze).getIndexByte(_-1)),oe=Er(oe),X=n+_+1&y._posStateMask,A=l+nt[2048-y._isMatch[(oe<<4)+X]>>>2],M=A+nt[2048-y._isRep[oe]>>>2],_e=_+1+E;g<i+_e;)y._optimum[g+=1].price=Ci;d=M+(St=y._repMatchLenEncoder.getPrice(E-2,X),St+fe(this,W,Xr).call(this,0,oe,X)),re=y._optimum[i+_e],d<re.price&&(re.price=d,re.posPrev=i+_+1,re.backPrev=0,re.prev1IsChar=1,re.prev2=1,re.posPrev2=i,re.backPrev2=te)}}if(D>de){for(D=de,Se=0;D>y._matchDistances[Se];Se+=2);y._matchDistances[Se]=D,Se+=2}if(D>=ee){for(Z=N+nt[y._isRep[K]>>>2];g<i+D;)y._optimum[g+=1].price=Ci;for(Ee=0;ee>y._matchDistances[Ee];)Ee+=2;for(_=ee;;_+=1)if(m=y._matchDistances[Ee+1],d=Z+fe(this,W,ql).call(this,m,_,ie),re=y._optimum[i+_],d<re.price&&(re.price=d,re.posPrev=i,re.backPrev=m+4,re.prev1IsChar=0),_==y._matchDistances[Ee]){if(_<he&&(ae=Math.min(he-1-_,y._numFastBytes),E=C(this,ze).getMatchLen(_,m,ae),E>=2)){for(oe=K<7?7:10,X=n+_&y._posStateMask,l=d+nt[y._isMatch[(oe<<4)+X]>>>2]+fe(this,W,ms).call(this,fe(this,W,Kr).call(this,n+_,C(this,ze).getIndexByte(_-1-1)),!0,C(this,ze).getIndexByte(_-(m+1)-1),C(this,ze).getIndexByte(_-1)),oe=Er(oe),X=n+_+1&y._posStateMask,A=l+nt[2048-y._isMatch[(oe<<4)+X]>>>2],M=A+nt[2048-y._isRep[oe]>>>2],_e=_+1+E;g<i+_e;)y._optimum[g+=1].price=Ci;d=M+(vt=y._repMatchLenEncoder.getPrice(E-2,X),vt+fe(this,W,Xr).call(this,0,oe,X)),re=y._optimum[i+_e],d<re.price&&(re.price=d,re.posPrev=i+_+1,re.backPrev=0,re.prev1IsChar=1,re.prev2=1,re.posPrev2=i,re.backPrev2=m+4)}if(Ee+=2,Ee==Se)break}}}}return 1},ql=function(n,i,a){const l=C(this,O).chunker.encoder;let d,m=Ho(i);if(n<128)d=l._distancesPrices[m*128+n];else{const h=(m<<6)+this.GetPosSlot2(n);d=l._posSlotPrices[h]+l._alignPrices[n&15]}return d+l._lenEncoder.getPrice(i-2,a)},Xr=function(n,i,a){const l=C(this,O).chunker.encoder;let d;return n?(d=nt[2048-C(this,O).chunker.encoder._isRepG0[i]>>>2],n==1?d+=nt[C(this,O).chunker.encoder._isRepG1[i]>>>2]:(d+=nt[2048-C(this,O).chunker.encoder._isRepG1[i]>>>2],d+=$n(C(this,O).chunker.encoder._isRepG2[i],n-2))):(d=nt[l._isRepG0[i]>>>2],d+=nt[2048-C(this,O).chunker.encoder._isRep0Long[(i<<4)+a]>>>2]),d},dh=function(n){const i=C(this,O).chunker.encoder,a=nt[i._isRepG0[i._state]>>>2],l=nt[i._isRep0Long[(i._state<<4)+n]>>>2];return a+l},Jl=function(n){n>0&&(fe(this,W,rh).call(this,n),C(this,O).chunker.encoder._additionalOffset+=n)},Mo=function(){let n=0;const i=C(this,O).chunker.encoder;return i._numDistancePairs=fe(this,W,eh).call(this),i._numDistancePairs>0&&(n=i._matchDistances[i._numDistancePairs-2],n==i._numFastBytes&&(n+=C(this,ze).getMatchLen(n-1,i._matchDistances[i._numDistancePairs-1],273-n))),i._additionalOffset+=1,n},ec=function(){const n=C(this,O).chunker.encoder;n._matchFinder&&n._needReleaseMFStream&&(n._matchFinder._stream=null,n._needReleaseMFStream=0)},fh=function(){fe(this,W,ec).call(this),C(this,O).chunker.encoder._rangeEncoder.stream=null},Kr=function(n,i){return{decoders:C(this,O).chunker.encoder._literalEncoder.getSubCoder(n,i).decoders}},ms=function(n,i,a,l){let d,m=1,h=7,p,v=0;if(i){for(;h>=0;--h)if(p=a>>h&1,d=l>>h&1,v+=$n(n.decoders[(1+p<<8)+m],d),m=m<<1|d,p!=d){--h;break}}for(;h>=0;--h)d=l>>h&1,v+=$n(n.decoders[m],d),m=m<<1|d;return v},tc=function(n){n.backPrev=-1,n.prev1IsChar=0},hh=function(n){n.backPrev=0,n.prev1IsChar=0},ph=function(n,i){let a,l=1,d=0;for(let m=n.numBitLevels;m!=0;m-=1)a=i&1,i>>>=1,d+=$n(n.models[l],a),l=l<<1|a;return d},mh=function(){const n=Gn(Zr(C(this,O).chunker.encoder._rangeEncoder.cacheSize),C(this,O).chunker.encoder._rangeEncoder.position);return Gn(n,[4,0])},gh=function(n){let i=0,a,l,d,m=n.length,h=[],p=[];for(let v=0;v<m;++v,++i){if(a=n[v]&255,a&128)if((a&224)==192){if(v+1>=m)return String.fromCharCode(...n);if(l=n[++v]&255,(l&192)!=128)return String.fromCharCode(...n);p[i]=(a&31)<<6|l&63}else if((a&240)==224){if(v+2>=m||(l=n[++v]&255,(l&192)!=128)||(d=n[++v]&255,(d&192)!=128))return n;p[i]=(a&15)<<12|(l&63)<<6|d&63}else return n;else{if(!a)return n;p[i]=a}i==16383&&(h.push(String.fromCharCode.apply(String,p)),i=-1)}return i>0&&(p.length=i,h.push(String.fromCharCode.apply(String,p))),h.join("")};/**
 * @license
 * Copyright Filip Seman
 * SPDX-License-Identifier: MIT
 */function Tg(o,n=5){const i=o instanceof ArrayBuffer?new Uint8Array(o):o,a=new zf().compress(i,n);return new Uint8Array(a)}function Lg(o){const n=o instanceof ArrayBuffer?new Uint8Array(o):o,i=new zf().decompress(n);return new Uint8Array(i)}const Bg=300,xh=255,$o=4096,Fg={item:1,outfit:2,effect:3,distance:4},Pg={1:"item",2:"outfit",3:"effect",4:"distance"},ce={GROUND:0,GROUND_BORDER:1,ON_BOTTOM:2,ON_TOP:3,CONTAINER:4,STACKABLE:5,FORCE_USE:6,MULTI_USE:7,WRITABLE:8,WRITABLE_ONCE:9,FLUID_CONTAINER:10,FLUID:11,UNPASSABLE:12,UNMOVEABLE:13,BLOCK_MISSILE:14,BLOCK_PATHFIND:15,NO_MOVE_ANIMATION:16,PICKUPABLE:17,HANGABLE:18,HOOK_SOUTH:19,HOOK_EAST:20,ROTATABLE:21,HAS_LIGHT:22,DONT_HIDE:23,TRANSLUCENT:24,HAS_OFFSET:25,HAS_ELEVATION:26,LYING_OBJECT:27,ANIMATE_ALWAYS:28,MINI_MAP:29,LENS_HELP:30,FULL_GROUND:31,IGNORE_LOOK:32,CLOTH:33,MARKET_ITEM:34,DEFAULT_ACTION:35,WRAPPABLE:36,UNWRAPPABLE:37,TOP_EFFECT:38,HAS_CHARGES:252,FLOOR_CHANGE:253,USABLE:254};function Mg(o){const n=new Uint8Array(o.length);for(let i=0;i<o.length;i+=4)n[i]=o[i+3],n[i+1]=o[i],n[i+2]=o[i+1],n[i+3]=o[i+2];return n}function Rg(o){const n=new Uint8ClampedArray(o.length);for(let i=0;i<o.length;i+=4)n[i]=o[i+1],n[i+1]=o[i+2],n[i+2]=o[i+3],n[i+3]=o[i];return n}class Og{constructor(n=65536){$(this,"buf");$(this,"view");$(this,"pos",0);this.buf=new Uint8Array(n),this.view=new DataView(this.buf.buffer)}grow(n){for(;this.pos+n>this.buf.length;){const i=new Uint8Array(this.buf.length*2);i.set(this.buf),this.buf=i,this.view=new DataView(this.buf.buffer)}}u8(n){this.grow(1),this.view.setUint8(this.pos,n),this.pos+=1}u16(n){this.grow(2),this.view.setUint16(this.pos,n,!0),this.pos+=2}i16(n){this.grow(2),this.view.setInt16(this.pos,n,!0),this.pos+=2}u32(n){this.grow(4),this.view.setUint32(this.pos,n,!0),this.pos+=4}i32(n){this.grow(4),this.view.setInt32(this.pos,n,!0),this.pos+=4}bytes(n){this.grow(n.length),this.buf.set(n,this.pos),this.pos+=n.length}result(){return this.buf.slice(0,this.pos)}patchU32(n,i){this.view.setUint32(n,i,!0)}}class Ug{constructor(n){$(this,"view");$(this,"pos",0);this.data=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength)}u8(){const n=this.view.getUint8(this.pos);return this.pos+=1,n}u16(){const n=this.view.getUint16(this.pos,!0);return this.pos+=2,n}i16(){const n=this.view.getInt16(this.pos,!0);return this.pos+=2,n}u32(){const n=this.view.getUint32(this.pos,!0);return this.pos+=4,n}i32(){const n=this.view.getInt32(this.pos,!0);return this.pos+=4,n}bytes(n){const i=this.data.slice(this.pos,this.pos+n);return this.pos+=n,i}str(n){return new TextDecoder("latin1").decode(this.bytes(n))}}function zg(o,n){if(n.ground?(o.u8(ce.GROUND),o.u16(n.groundSpeed??0)):n.groundBorder?o.u8(ce.GROUND_BORDER):n.onBottom?o.u8(ce.ON_BOTTOM):n.onTop&&o.u8(ce.ON_TOP),n.container&&o.u8(ce.CONTAINER),n.stackable&&o.u8(ce.STACKABLE),n.forceUse&&o.u8(ce.FORCE_USE),n.multiUse&&o.u8(ce.MULTI_USE),n.writable&&(o.u8(ce.WRITABLE),o.u16(n.writableMaxLen??0)),n.writableOnce&&(o.u8(ce.WRITABLE_ONCE),o.u16(n.writableOnceMaxLen??0)),n.fluidContainer&&o.u8(ce.FLUID_CONTAINER),n.splash&&o.u8(ce.FLUID),n.notWalkable&&o.u8(ce.UNPASSABLE),n.notMoveable&&o.u8(ce.UNMOVEABLE),n.blockProjectile&&o.u8(ce.BLOCK_MISSILE),n.notPathable&&o.u8(ce.BLOCK_PATHFIND),n.noMoveAnimation&&o.u8(ce.NO_MOVE_ANIMATION),n.pickupable&&o.u8(ce.PICKUPABLE),n.hangable&&o.u8(ce.HANGABLE),n.hookSouth&&o.u8(ce.HOOK_SOUTH),n.hookEast&&o.u8(ce.HOOK_EAST),n.rotateable&&o.u8(ce.ROTATABLE),n.hasLight&&(o.u8(ce.HAS_LIGHT),o.u16(n.lightLevel??0),o.u16(n.lightColor??0)),n.dontHide&&o.u8(ce.DONT_HIDE),n.translucent&&o.u8(ce.TRANSLUCENT),n.hasDisplacement&&(o.u8(ce.HAS_OFFSET),o.i16(n.displacementX??0),o.i16(n.displacementY??0)),n.hasElevation&&(o.u8(ce.HAS_ELEVATION),o.u16(n.elevation??0)),n.lyingCorpse&&o.u8(ce.LYING_OBJECT),n.animateAlways&&o.u8(ce.ANIMATE_ALWAYS),n.hasMinimapColor&&(o.u8(ce.MINI_MAP),o.u16(n.minimapColor??0)),n.lensHelp!=null&&(o.u8(ce.LENS_HELP),o.u16(n.lensHelp)),n.fullGround&&o.u8(ce.FULL_GROUND),n.look&&o.u8(ce.IGNORE_LOOK),n.cloth&&(o.u8(ce.CLOTH),o.u16(n.clothSlot??0)),n.hasMarket){o.u8(ce.MARKET_ITEM),o.u16(n.marketCategory??0),o.u16(n.marketTradeAs??0),o.u16(n.marketShowAs??0);const i=n.marketName??"";o.u16(i.length);for(let a=0;a<i.length;a++)o.u8(i.charCodeAt(a)&255);o.u16(n.marketRestrictVocation??0),o.u16(n.marketRequiredLevel??0)}n.usable&&(o.u8(ce.DEFAULT_ACTION),o.u16(n.usableActionId??0)),n.wrapable&&o.u8(ce.WRAPPABLE),n.unwrapable&&o.u8(ce.UNWRAPPABLE),n.topEffect&&o.u8(ce.TOP_EFFECT),n.chargeable&&o.u8(ce.HAS_CHARGES),o.u8(xh)}function Hg(o){const n={ground:!1,groundBorder:!1,onBottom:!1,onTop:!1,container:!1,stackable:!1,forceUse:!1,multiUse:!1,writable:!1,writableOnce:!1,fluidContainer:!1,splash:!1,notWalkable:!1,notMoveable:!1,blockProjectile:!1,notPathable:!1,pickupable:!1,hangable:!1,hookSouth:!1,hookEast:!1,rotateable:!1,hasLight:!1,dontHide:!1,translucent:!1,hasDisplacement:!1,hasElevation:!1,lyingCorpse:!1,animateAlways:!1,hasMinimapColor:!1,fullGround:!1,look:!1,cloth:!1,hasMarket:!1,usable:!1,wrapable:!1,unwrapable:!1,topEffect:!1,noMoveAnimation:!1,chargeable:!1};for(;;){const i=o.u8();if(i===xh)break;switch(i){case ce.GROUND:n.ground=!0,n.groundSpeed=o.u16();break;case ce.GROUND_BORDER:n.groundBorder=!0;break;case ce.ON_BOTTOM:n.onBottom=!0;break;case ce.ON_TOP:n.onTop=!0;break;case ce.CONTAINER:n.container=!0;break;case ce.STACKABLE:n.stackable=!0;break;case ce.FORCE_USE:n.forceUse=!0;break;case ce.MULTI_USE:n.multiUse=!0;break;case ce.WRITABLE:n.writable=!0,n.writableMaxLen=o.u16();break;case ce.WRITABLE_ONCE:n.writableOnce=!0,n.writableOnceMaxLen=o.u16();break;case ce.FLUID_CONTAINER:n.fluidContainer=!0;break;case ce.FLUID:n.splash=!0;break;case ce.UNPASSABLE:n.notWalkable=!0;break;case ce.UNMOVEABLE:n.notMoveable=!0;break;case ce.BLOCK_MISSILE:n.blockProjectile=!0;break;case ce.BLOCK_PATHFIND:n.notPathable=!0;break;case ce.NO_MOVE_ANIMATION:n.noMoveAnimation=!0;break;case ce.PICKUPABLE:n.pickupable=!0;break;case ce.HANGABLE:n.hangable=!0;break;case ce.HOOK_SOUTH:n.hookSouth=!0;break;case ce.HOOK_EAST:n.hookEast=!0;break;case ce.ROTATABLE:n.rotateable=!0;break;case ce.HAS_LIGHT:n.hasLight=!0,n.lightLevel=o.u16(),n.lightColor=o.u16();break;case ce.DONT_HIDE:n.dontHide=!0;break;case ce.TRANSLUCENT:n.translucent=!0;break;case ce.HAS_OFFSET:n.hasDisplacement=!0,n.displacementX=o.i16(),n.displacementY=o.i16();break;case ce.HAS_ELEVATION:n.hasElevation=!0,n.elevation=o.u16();break;case ce.LYING_OBJECT:n.lyingCorpse=!0;break;case ce.ANIMATE_ALWAYS:n.animateAlways=!0;break;case ce.MINI_MAP:n.hasMinimapColor=!0,n.minimapColor=o.u16();break;case ce.LENS_HELP:n.lensHelp=o.u16();break;case ce.FULL_GROUND:n.fullGround=!0;break;case ce.IGNORE_LOOK:n.look=!0;break;case ce.CLOTH:n.cloth=!0,n.clothSlot=o.u16();break;case ce.MARKET_ITEM:{n.hasMarket=!0,n.marketCategory=o.u16(),n.marketTradeAs=o.u16(),n.marketShowAs=o.u16();const a=o.u16();n.marketName=o.str(a),n.marketRestrictVocation=o.u16(),n.marketRequiredLevel=o.u16();break}case ce.DEFAULT_ACTION:n.usable=!0,n.usableActionId=o.u16();break;case ce.HAS_CHARGES:n.chargeable=!0;break;case ce.FLOOR_CHANGE:break;case ce.WRAPPABLE:n.wrapable=!0;break;case ce.UNWRAPPABLE:n.unwrapable=!0;break;case ce.TOP_EFFECT:n.topEffect=!0;break;case ce.USABLE:n.usable=!0;break;default:throw new Error(`Unknown OBD flag 0x${i.toString(16)}`)}}return n}function $g(o){const{thing:n,clientVersion:i,spriteData:a,spriteOverrides:l}=o,d=new Og;d.u16(Bg),d.u16(i),d.u8(Fg[n.category]??1);const m=d.pos;d.u32(0),zg(d,n.flags),d.patchU32(m,d.pos);const h=n.category==="outfit",p=n.frameGroups.length;h&&d.u8(p);for(let v=0;v<p;v++){h&&d.u8(p<2?1:v);const S=n.frameGroups[v];if(d.u8(S.width),d.u8(S.height),(S.width>1||S.height>1)&&d.u8(32),d.u8(S.layers),d.u8(S.patternX),d.u8(S.patternY),d.u8(S.patternZ||1),d.u8(S.animationLength),S.animationLength>1){d.u8(S.asynchronous),d.i32(S.nLoop),d.u8(S.start);for(let g=0;g<S.animationLength;g++){const w=S.animationLengths[g]??{min:100,max:100};d.u32(w.min),d.u32(w.max)}}for(let g=0;g<S.sprites.length;g++){const w=S.sprites[g];d.u32(w);let _;if(w===0)_=new Uint8Array($o);else{const P=l.get(w)??mn(a,w);P?_=Mg(new Uint8Array(P.data.buffer,P.data.byteOffset,P.data.byteLength)):_=new Uint8Array($o)}d.u32(_.length),d.bytes(_)}}return Tg(d.result(),5)}function Gg(o){let n;try{n=Lg(o)}catch(k){throw new Error(`Failed to decompress OBD file. Ensure this is a valid .obd file.
${k instanceof Error?k.message:k}`)}if(n.length<9)throw new Error("OBD file too small.");const i=new Ug(n),a=i.u16();let l,d;if(a===300)l=3,d=i.u16();else if(a===200)l=2,d=i.u16();else throw a>=710?new Error(`This is an OBD Version 1 file (client ${a}). V1 is not supported  please re-export from the Object Builder as V2 or V3.`):new Error(`Unrecognised OBD header: 0x${a.toString(16)} (${a}). Not a valid .obd file.`);const m=i.u8(),h=Pg[m];if(!h)throw new Error(`Invalid category byte: ${m}`);i.u32();const p=Hg(i),v=h==="outfit";let S=1;v&&l===3&&(S=i.u8());const g=[],w=new Map;let _=2130706432;for(let k=0;k<S;k++){v&&l===3&&i.u8();const N=i.u8(),D=i.u8();(N>1||D>1)&&i.u8();const T=i.u8(),A=i.u8(),G=i.u8(),M=i.u8()||1,Z=i.u8();let de=0,he=0,Se=0;const Ee=[];if(Z>1){de=i.u8(),he=i.i32(),Se=i.u8();for(let re=0;re<Z;re++)Ee.push({min:i.u32(),max:i.u32()})}else Ee.push({min:0,max:0});const _e=N*D*T*A*G*M*Z,Y=[];for(let re=0;re<_e;re++){const ve=i.u32();let ge;if(l===3){const te=i.u32();ge=i.bytes(te)}else ge=i.bytes($o);if(ve===0||ge.length!==$o){Y.push(0);continue}_++;const ie=_;Y.push(ie);const X=Rg(ge),ue=new ImageData(X,32,32);w.set(ie,ue)}g.push({type:k,width:N,height:D,layers:T,patternX:A,patternY:G,patternZ:M,animationLength:Z,asynchronous:de,nLoop:he,start:Se,animationLengths:Ee,sprites:Y})}if(h==="outfit"&&g.length>=2){const k=g[0];for(let N=1;N<g.length;N++){const D=g[N];if(D.layers>=k.layers)continue;const T=D.width*D.height,A=D.patternX*D.patternY*D.patternZ,G=D.layers*T,M=k.layers*T,Z=A*M,de=D.sprites.slice(0,A*G),he=new Array(Z).fill(0);for(let Ee=0;Ee<A;Ee++){for(let _e=0;_e<T;_e++)he[Ee*M+_e]=de[Ee*G+_e];for(let _e=1;_e<k.layers;_e++)for(let Y=0;Y<T;Y++)he[Ee*M+_e*T+Y]=k.sprites[Ee*M+_e*T+Y]}const Se=k.sprites.slice(0,Z);for(D.layers=k.layers,D.sprites=[...he,...Se],D.animationLength=2;D.animationLengths.length>2;)D.animationLengths.pop();for(;D.animationLengths.length<2;)D.animationLengths.push({min:100,max:100})}}const E=k=>{if(!k)return"EMPTY";let N=0;for(let D=0;D<k.data.length;D+=4)k.data[D+3]>0&&(N=N*31+k.data[D]+k.data[D+1]*256+k.data[D+2]*65536|0);return N.toString(16).padStart(8,"0")};console.group("[OBD DIAGNOSTIC]"),console.log("OBD version:",l,"| Client:",d,"| Category:",h),console.log("Frame groups:",g.length);const P=new Map;if(h==="outfit"&&g.length>=1){const k=g[0],N=k.width*k.height;console.log(`  Idle (Group 0): w=${k.width} h=${k.height} layers=${k.layers} pX=${k.patternX} frames=${k.animationLength} sprites=${k.sprites.length}`);for(let D=0;D<k.sprites.length;D++){const T=E(w.get(k.sprites[D])),A=Math.floor(D/(k.layers*N)),G=Math.floor(D%(k.layers*N)/N),M=D%N,Z=`idle[${D}] dir=${A} L=${G} tile=${M}`;P.set(T+"_"+D,Z),console.log(`    [${D}] hash=${T}  ${Z}`)}}for(let k=1;k<g.length;k++){const N=g[k],D=N.width*N.height,T=N.layers*N.patternX*N.patternY*N.patternZ*D;console.log(`  Walking (Group ${k}): w=${N.width} h=${N.height} layers=${N.layers} pX=${N.patternX} frames=${N.animationLength} sprites=${N.sprites.length} spritesPerFrame=${T}`);for(let A=0;A<N.sprites.length;A++){const G=E(w.get(N.sprites[A])),M=Math.floor(A/T),Z=A%T,de=Math.floor(Z/(N.layers*D)),he=Math.floor(Z%(N.layers*D)/D),Se=Z%D;let Ee="";for(const[_e,Y]of P)if(_e.startsWith(G+"_")){Ee=`  MATCHES ${Y}`;break}console.log(`    [${A}] hash=${G} f=${M} dir=${de} L=${he} tile=${Se}${Ee}`)}}return console.groupEnd(),{category:h,clientVersion:d,flags:p,frameGroups:g,spritePixels:w}}function Vg({thing:o,group:n,objectData:i,spriteData:a,spriteOverrides:l,category:d,zoom:m,setZoom:h,showGrid:p,setShowGrid:v,showCropSize:S,setShowCropSize:g,previewMode:w,setPreviewMode:_,playing:E,setPlaying:P,currentFrame:k,setCurrentFrame:N,canvasRef:D,handleImageFiles:T,copyMenuOpen:A,setCopyMenuOpen:G,copyMenuRef:M,baseOutfitId:Z,setBaseOutfitId:de}){const he=H.useRef(null),Se=H.useRef(null),Ee=n?n.animationLength>1:!1,_e=()=>{const ve=D.current;if(!ve)return;const ge=ve.toDataURL("image/png"),ie=document.createElement("a");ie.href=ge,ie.download=`sprite_${o.id}_frame${k}.png`,ie.click()},Y=()=>{if(a)try{const ve=$g({thing:o,clientVersion:1098,spriteData:a,spriteOverrides:l}),ge=new Blob([new Uint8Array(ve)],{type:"application/octet-stream"}),ie=URL.createObjectURL(ge),X=document.createElement("a");X.href=ie;const ue=i?Hn(i,o.id):o.id;X.download=`${d}_${ue}.obd`,X.click(),URL.revokeObjectURL(ie)}catch(ve){alert(`Export failed: ${ve instanceof Error?ve.message:ve}`)}},re=ve=>{var X;const ge=(X=ve.target.files)==null?void 0:X[0];if(!ge)return;const ie=new FileReader;ie.onload=()=>{var ue;try{const te=new Uint8Array(ie.result),B=Gg(te),b=I.getState(),V=b.selectedThingId,Q=V!=null?(ue=b.objectData)==null?void 0:ue.things.get(V):null;if(V!=null&&Q&&Q.category===B.category)if(b.replaceThing(V,B.flags,B.frameGroups,B.spritePixels)){const K=I.getState().objectData,oe=K?Hn(K,V):V;alert(`Replaced ${B.category} #${oe} with ${B.spritePixels.size} sprites.`)}else alert("Replace failed  could not overwrite selected thing.");else{const ee=b.importThing(B.category,B.flags,B.frameGroups,B.spritePixels);if(ee!=null){const K=I.getState().objectData,oe=K?Hn(K,ee):ee;alert(`Imported ${B.category} #${oe} with ${B.spritePixels.size} sprites.`)}}}catch(te){alert(`Import failed: ${te instanceof Error?te.message:te}`)}},ie.readAsArrayBuffer(ge),ve.target.value=""};return u.jsxs("div",{className:"flex items-center px-3 py-1.5 gap-1 border-t border-emperia-border flex-wrap",children:[u.jsx("button",{onClick:()=>h(Math.max(1,m-1)),className:"p-1 rounded hover:bg-emperia-hover text-emperia-muted hover:text-emperia-text",title:"Zoom out",children:u.jsx(v0,{className:"w-3.5 h-3.5"})}),u.jsxs("span",{className:"text-[10px] text-emperia-muted w-6 text-center",children:[m,"x"]}),u.jsx("button",{onClick:()=>h(Math.min(8,m+1)),className:"p-1 rounded hover:bg-emperia-hover text-emperia-muted hover:text-emperia-text",title:"Zoom in",children:u.jsx(y0,{className:"w-3.5 h-3.5"})}),u.jsx("div",{className:"w-px h-4 bg-emperia-border mx-0.5"}),u.jsx("button",{onClick:()=>v(!p),className:`p-1 rounded transition-colors ${p?"bg-emperia-accent/20 text-emperia-accent":"text-emperia-muted hover:text-emperia-text hover:bg-emperia-hover"}`,title:"Toggle Grid",children:u.jsx(n0,{className:"w-3.5 h-3.5"})}),u.jsx("button",{onClick:()=>g(!S),className:`p-1 rounded transition-colors ${S?"bg-emperia-accent/20 text-emperia-accent":"text-emperia-muted hover:text-emperia-text hover:bg-emperia-hover"}`,title:"Toggle Crop Outline",children:u.jsx(qm,{className:"w-3.5 h-3.5"})}),n&&(n.patternX>1||n.patternY>1)&&u.jsx("button",{onClick:()=>_(!w),className:`p-1 rounded transition-colors ${w?"bg-emperia-accent/20 text-emperia-accent":"text-emperia-muted hover:text-emperia-text hover:bg-emperia-hover"}`,title:"Toggle Preview Mode",children:u.jsx(Jm,{className:"w-3.5 h-3.5"})}),u.jsx("div",{className:"w-px h-4 bg-emperia-border mx-0.5"}),u.jsx("input",{ref:he,type:"file",accept:"image/png,image/gif,image/bmp",className:"hidden",onChange:ve=>ve.target.files&&T(ve.target.files)}),u.jsx("button",{onClick:()=>{var ve;return(ve=he.current)==null?void 0:ve.click()},className:"p-1 rounded hover:bg-emperia-hover text-emperia-muted hover:text-emperia-text",title:"Import PNG",children:u.jsx(i0,{className:"w-3.5 h-3.5"})}),u.jsx("button",{onClick:_e,className:"p-1 rounded hover:bg-emperia-hover text-emperia-muted hover:text-emperia-text",title:"Export PNG",children:u.jsx(r0,{className:"w-3.5 h-3.5"})}),u.jsx("div",{className:"w-px h-4 bg-emperia-border mx-0.5"}),u.jsx("input",{ref:Se,type:"file",accept:".obd",className:"hidden",onChange:re}),u.jsx("button",{onClick:()=>{var ve;return(ve=Se.current)==null?void 0:ve.click()},className:"p-1 rounded hover:bg-emperia-hover text-emperia-muted hover:text-emperia-text",title:"Import OBD",children:u.jsx(If,{className:"w-3.5 h-3.5"})}),u.jsx("button",{onClick:Y,className:"p-1 rounded hover:bg-emperia-hover text-emperia-muted hover:text-emperia-text",title:"Export OBD",children:u.jsx(cc,{className:"w-3.5 h-3.5"})}),u.jsx("div",{className:"w-px h-4 bg-emperia-border mx-0.5"}),u.jsx(Wg,{thing:o,copyMenuOpen:A,setCopyMenuOpen:G,copyMenuRef:M}),Ee&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-px h-4 bg-emperia-border mx-0.5"}),u.jsx("button",{onClick:()=>{N((k-1+((n==null?void 0:n.animationLength)??1))%((n==null?void 0:n.animationLength)??1)),P(!1)},className:"p-1 rounded hover:bg-emperia-hover text-emperia-muted hover:text-emperia-text",title:"Previous frame",children:u.jsx(Qm,{className:"w-3.5 h-3.5"})}),u.jsx("button",{onClick:()=>P(!E),className:`p-1 rounded transition-colors ${E?"bg-emperia-accent/20 text-emperia-accent":"text-emperia-muted hover:text-emperia-text hover:bg-emperia-hover"}`,title:E?"Pause":"Play",children:E?u.jsx(c0,{className:"w-3.5 h-3.5"}):u.jsx(d0,{className:"w-3.5 h-3.5"})}),u.jsx("button",{onClick:()=>{N((k+1)%((n==null?void 0:n.animationLength)??1)),P(!1)},className:"p-1 rounded hover:bg-emperia-hover text-emperia-muted hover:text-emperia-text",title:"Next frame",children:u.jsx(Df,{className:"w-3.5 h-3.5"})}),u.jsxs("span",{className:"text-[10px] text-emperia-muted",children:[k+1,"/",n==null?void 0:n.animationLength]})]}),d==="outfit"&&i&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"flex-1"}),u.jsxs("div",{className:"flex items-center gap-0.5",children:[Z!=null&&Z!==o.id&&u.jsxs("span",{className:"text-[9px] text-amber-400/70 mr-0.5",children:["Base: #",Hn(i,Z)]}),(()=>{const ve=i.itemCount+134,ge=Z===ve;return u.jsxs("button",{onClick:()=>de(ge?null:ve),className:`p-1 rounded transition-colors ${ge?"bg-sky-500/20 text-sky-400":"text-emperia-muted hover:text-sky-400 hover:bg-sky-500/10"}`,title:ge?"Unpin character base (#134)":"Pin outfit #134 as base",children:[u.jsx(Jd,{className:"w-3.5 h-3.5"}),u.jsx("span",{className:"sr-only",children:"134"})]})})(),u.jsx("button",{onClick:()=>de(Z===o.id?null:o.id),className:`p-1 rounded transition-colors ${Z===o.id?"bg-amber-500/20 text-amber-400":Z!=null?"bg-amber-500/10 text-amber-400/60 hover:text-amber-400 hover:bg-amber-500/20":"text-emperia-muted hover:text-emperia-text hover:bg-emperia-hover"}`,title:Z===o.id?"Unpin base outfit":Z!=null?"Replace pinned base with this outfit":"Pin current as base outfit",children:Z===o.id?u.jsx(u0,{className:"w-3.5 h-3.5"}):u.jsx(Jd,{className:"w-3.5 h-3.5"})})]})]})]})}function Wg({thing:o,copyMenuOpen:n,setCopyMenuOpen:i,copyMenuRef:a}){var l;return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"relative",ref:a,children:[u.jsx("button",{onClick:()=>i(!n),className:"p-1 rounded hover:bg-emperia-hover text-emperia-muted hover:text-emperia-text",title:"Copy properties",children:u.jsx(jf,{className:"w-3.5 h-3.5"})}),n&&u.jsx("div",{className:"absolute bottom-full mb-1 left-0 bg-emperia-surface border border-emperia-border rounded shadow-lg py-1 z-50 min-w-[160px]",onClick:()=>i(!1),children:[{label:"Everything",key:"all"},{label:"Flags Only",key:"flags"},{label:"Server Properties",key:"server"},{label:"Sprites Only",key:"sprites"}].map(({label:d,key:m})=>u.jsx("button",{className:"w-full text-left px-3 py-1.5 text-[11px] text-emperia-text hover:bg-emperia-hover transition-colors",onClick:()=>{const{clientToServerIds:h,itemDefinitions:p}=I.getState(),v=h.get(o.id),S=v!=null?p.get(v)??null:null,g={label:d};(m==="all"||m==="flags")&&(g.flags={...o.flags}),(m==="all"||m==="sprites")&&(g.frameGroups=o.frameGroups.map(w=>({...w,sprites:[...w.sprites],animationLengths:w.animationLengths.map(_=>({..._}))}))),(m==="all"||m==="server")&&(g.serverDef=S?{...S,properties:S.properties?{...S.properties}:null}:null),I.setState({copiedThing:g})},children:d},m))})]}),u.jsx("button",{onClick:()=>{const{copiedThing:d}=I.getState();if(!d)return;const m=I.getState(),h=new Set(m.dirtyIds);if(h.add(o.id),d.frameGroups&&(o.frameGroups=d.frameGroups.map(p=>({...p,sprites:[...p.sprites],animationLengths:p.animationLengths.map(v=>({...v}))}))),o.rawBytes=void 0,zn(),d.serverDef&&o.category==="item"){const{clientToServerIds:p,itemDefinitions:v}=m,S=p.get(o.id);if(S!=null){const g=new Map(v);g.set(S,{...d.serverDef,serverId:S,id:o.id}),I.setState({dirty:!0,dirtyIds:h,editVersion:m.editVersion+1,itemDefinitions:g})}}d.flags?m.updateThingFlags(o.id,{...d.flags}):I.setState({dirty:!0,dirtyIds:h,editVersion:m.editVersion+1})},disabled:!I.getState().copiedThing,className:`p-1 rounded transition-colors ${I.getState().copiedThing?"hover:bg-emperia-hover text-emperia-muted hover:text-emperia-text":"text-emperia-muted/30 cursor-not-allowed"}`,title:(l=I.getState().copiedThing)!=null&&l.label?`Paste: ${I.getState().copiedThing.label}`:"Paste properties",children:u.jsx(Zm,{className:"w-3.5 h-3.5"})})]})}function Yg({thing:o,group:n,isOutfit:i,isDistance:a,previewMode:l,activeDirection:d,setActiveDirection:m,activePatternY:h,setActivePatternY:p,activeZ:v,setActiveZ:S,updateFrameGroupProp:g}){return u.jsxs("div",{className:"border-t border-emperia-border text-[10px]",children:[u.jsx(yh,{label:"Patterns"}),u.jsxs("div",{className:"px-4 py-1.5 space-y-1.5",children:[u.jsxs("div",{className:"grid grid-cols-3 gap-x-3 gap-y-1 bg-emperia-surface/40 rounded px-2 py-1.5",children:[u.jsx(tn,{label:"Width",value:n.width,onChange:w=>g("width",w),min:1,max:4}),u.jsx(tn,{label:"Height",value:n.height,onChange:w=>g("height",w),min:1,max:4}),u.jsx(tn,{label:"Crop Size",value:32,readOnly:!0})]}),u.jsxs("div",{className:"grid grid-cols-3 gap-x-3 gap-y-1 bg-blue-950/20 border border-blue-500/10 rounded px-2 py-1.5",children:[u.jsx(tn,{label:"Pattern X",value:n.patternX,onChange:w=>g("patternX",w),min:1,max:8,labelClassName:"text-[10px] text-blue-400/80"}),u.jsx(tn,{label:"Pattern Y",value:n.patternY,onChange:w=>g("patternY",w),min:1,max:8,labelClassName:"text-[10px] text-blue-400/80"}),u.jsx(tn,{label:"Pattern Z",value:n.patternZ,onChange:w=>g("patternZ",w),min:1,max:8,labelClassName:"text-[10px] text-blue-400/80"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-x-2",children:[u.jsx("div",{className:"bg-purple-950/20 border border-purple-500/10 rounded px-2 py-1.5",children:u.jsx(tn,{label:"Layers",value:n.layers,onChange:w=>g("layers",w),min:1,max:255,labelClassName:"text-[10px] text-purple-400/80"})}),u.jsx("div",{className:"bg-emerald-950/20 border border-emerald-500/10 rounded px-2 py-1.5",children:u.jsx(tn,{label:"Animations",value:n.animationLength,onChange:w=>g("animationLength",w),min:1,max:999,labelClassName:"text-[10px] text-emerald-400/80"})})]})]}),u.jsx(Xg,{group:n,isOutfit:i,isDistance:a,previewMode:l,activeDirection:d,setActiveDirection:m,activePatternY:h,setActivePatternY:p,activeZ:v,setActiveZ:S})]})}function yh({label:o,colorClass:n}){return u.jsx("div",{className:`px-4 py-1 border-y border-emperia-border/40 ${n??"bg-emperia-surface/60"}`,children:u.jsx("span",{className:`text-[9px] font-semibold uppercase tracking-wider ${n?"text-inherit opacity-80":"text-emperia-muted"}`,children:o})})}function Xg({group:o,isOutfit:n,isDistance:i,previewMode:a,activeDirection:l,setActiveDirection:d,activePatternY:m,setActivePatternY:h,activeZ:p,setActiveZ:v}){const S=o.patternX>4&&!i,g=o.patternY>1&&!i,w=o.patternZ>1;return!a||!(S||g||w)?null:u.jsxs(u.Fragment,{children:[u.jsx(yh,{label:"Preview"}),u.jsxs("div",{className:"px-4 py-1.5 flex flex-wrap items-center gap-x-3 gap-y-1",children:[S&&u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"text-emperia-muted shrink-0",children:"Direction:"}),u.jsx(pn,{onClick:()=>d(Math.max(0,l-1)),children:""}),u.jsxs("span",{className:"text-emperia-text font-mono w-10 text-center",children:[l+1,"/",o.patternX]}),u.jsx(pn,{onClick:()=>d(Math.min(o.patternX-1,l+1)),children:""})]}),g&&u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"text-emperia-muted shrink-0",children:n?"Addon:":"Pat Y:"}),u.jsx(pn,{onClick:()=>h(Math.max(0,m-1)),children:""}),u.jsx("span",{className:"text-emperia-text font-mono w-8 text-center text-[9px]",children:n?m===0?"None":`#${m}`:`${m+1}/${o.patternY}`}),u.jsx(pn,{onClick:()=>h(Math.min(o.patternY-1,m+1)),children:""})]}),w&&u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"text-emperia-muted shrink-0",children:n?"Mount:":"Pat Z:"}),u.jsx(pn,{onClick:()=>v(Math.max(0,p-1)),children:""}),u.jsxs("span",{className:"text-emperia-text font-mono w-8 text-center text-[9px]",children:[p+1,"/",o.patternZ]}),u.jsx(pn,{onClick:()=>v(Math.min(o.patternZ-1,p+1)),children:""})]})]})]})}function Kg({animationLength:o,currentFrame:n,setCurrentFrame:i,setPlaying:a,height:l}){return u.jsxs("div",{className:"relative flex flex-col items-center select-none ml-2",style:{height:Math.max(120,l),width:28},onMouseDown:d=>{const m=d.currentTarget,h=S=>{const g=m.getBoundingClientRect(),w=Math.max(0,Math.min(1,(S-g.top-8)/(g.height-16))),_=Math.round(w*(o-1));i(_),a(!1)};h(d.clientY);const p=S=>h(S.clientY),v=()=>{window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",v)};window.addEventListener("mousemove",p),window.addEventListener("mouseup",v)},children:[u.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-2 bottom-2 w-[3px] rounded-full bg-emperia-border"}),Array.from({length:o},(d,m)=>{const h=o<=1?50:8+m/(o-1)*84;return u.jsx("div",{className:`absolute left-1/2 -translate-x-1/2 rounded-full transition-all duration-75 ${m===n?"w-3.5 h-3.5 bg-emperia-accent shadow-lg shadow-emperia-accent/40 z-10":"w-1.5 h-1.5 bg-emperia-muted/40 hover:bg-emperia-muted"}`,style:{top:`${h}%`,transform:"translate(-50%, -50%)"}},m)}),u.jsxs("div",{className:"absolute -right-1 text-[8px] font-mono text-emperia-accent whitespace-nowrap",style:{top:`${o<=1?50:8+n/(o-1)*84}%`,transform:"translateY(-50%) translateX(100%)",paddingLeft:4},children:[n+1,"/",o]})]})}function Qg({layers:o,activeLayer:n,setActiveLayer:i,blendLayers:a,setBlendLayers:l,height:d}){return u.jsxs("div",{className:"relative flex flex-col items-center select-none ml-1",style:{height:Math.max(80,d),width:24},title:"Layer",onMouseDown:m=>{const h=m.currentTarget,p=g=>{const w=h.getBoundingClientRect(),_=Math.max(0,Math.min(1,(g-w.top-8)/(w.height-16))),E=Math.round(_*(o-1));i(E),l(!1)};p(m.clientY);const v=g=>p(g.clientY),S=()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",S)};window.addEventListener("mousemove",v),window.addEventListener("mouseup",S)},children:[u.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-2 bottom-2 w-[3px] rounded-full bg-purple-900/40"}),Array.from({length:o},(m,h)=>{const p=o<=1?50:8+h/(o-1)*84,v=!a&&h===n;return u.jsx("div",{className:`absolute left-1/2 -translate-x-1/2 rounded-full transition-all duration-75 ${v?"w-3 h-3 bg-purple-500 shadow-lg shadow-purple-500/40 z-10":"w-1.5 h-1.5 bg-purple-400/30 hover:bg-purple-400/60"}`,style:{top:`${p}%`,transform:"translate(-50%, -50%)"}},h)}),u.jsx("div",{className:"absolute -right-0.5 text-[7px] font-mono text-purple-400 whitespace-nowrap",style:{top:a?"50%":`${o<=1?50:8+n/(o-1)*84}%`,transform:"translateY(-50%) translateX(100%)",paddingLeft:3},children:a?"Blend":`L${n}`})]})}function Zg(){const o=I(le=>le.selectedThingId),n=I(le=>le.objectData),i=I(le=>le.spriteData),a=I(le=>le.spriteOverrides),l=I(le=>le.replaceSprite),d=I(le=>le.addSprite),m=I(le=>le.editVersion),h=o!=null?(n==null?void 0:n.things.get(o))??null:null,[p,v]=H.useState(0),S=I(le=>le.currentFrame),g=le=>{typeof le=="function"?I.setState(Ae=>({currentFrame:le(Ae.currentFrame)})):I.setState({currentFrame:le})},w=I(le=>le.playing),_=le=>I.setState({playing:le}),[E,P]=H.useState(4),[k,N]=H.useState(!1),[D,T]=H.useState(!1),[A,G]=H.useState(!1),[M,Z]=H.useState(null),[de,he]=H.useState(null),Se=I(le=>le.activeLayer),Ee=le=>I.setState({activeLayer:le}),[_e,Y]=H.useState(0),re=I(le=>le.blendLayers),ve=le=>I.setState({blendLayers:le}),ge=I(le=>le.outfitColors),[ie,X]=H.useState(!1),[ue,te]=H.useState(2),[B,b]=H.useState(0);I(le=>le.showColorPicker);const[V,Q]=H.useState(!1),ee=H.useRef(null),[K,oe]=H.useState(null),ae=H.useRef(null),Ce=H.useRef(0),Le=H.useRef(""),yt=I(le=>le.activeCategory),St=yt==="outfit",vt=yt==="effect",Fe=yt==="distance";H.useEffect(()=>{v(0),I.setState({currentFrame:0,playing:!1,activeLayer:0,blendLayers:!1,showColorPicker:null}),Y(0),te(2),b(0),X(St||vt||Fe)},[o,St,vt,Fe]),H.useEffect(()=>{if(!V)return;const le=Ae=>{ee.current&&!ee.current.contains(Ae.target)&&Q(!1)};return document.addEventListener("mousedown",le),()=>document.removeEventListener("mousedown",le)},[V]);const y=(h==null?void 0:h.frameGroups[p])??null,Ue=H.useCallback((le,Ae,Ge,et,He,We,rt,Pt,Xe,Ke,Ze=0,Ne=0)=>{if(!i)return;const Me=Xe?[0]:[0];for(const it of Me)for(let Qe=0;Qe<He.length;Qe++){const Ye=He[Qe];for(let tt=0;tt<et.length;tt++){const qe=et[tt],Mt=tt*We,Rt=Qe*rt;for(let mt=0;mt<Ae.height;mt++)for(let gt=0;gt<Ae.width;gt++){const At=er(Ae,Ge,qe,Ye,0,it,gt,mt);if(At>=Ae.sprites.length)continue;const Gt=Ae.sprites[At];if(Gt<=0)continue;const Xt=a.get(Gt)??mn(i,Gt);if(!Xt)continue;const In=new ImageData(new Uint8ClampedArray(Xt.data),32,32);if(Xe){const It=er(Ae,Ge,qe,Ye,0,1,gt,mt);if(It<Ae.sprites.length){const Tn=Ae.sprites[It];if(Tn>0){const Ir=a.get(Tn)??mn(i,Tn);Ir&&zo(In,Ir,Ke)}}}const Ar=Ze+Mt+(Ae.width-1-gt)*32,ei=Ne+Rt+(Ae.height-1-mt)*32;if(Pt||Xe){const It=document.createElement("canvas");It.width=32,It.height=32,It.getContext("2d").putImageData(In,0,0),le.drawImage(It,Ar,ei)}else le.putImageData(In,Ar,ei)}}}},[i,a]),Et=`${m}:${p}:${o}`;Le.current=Et;const Bt=H.useRef(!1),Ft=H.useCallback(le=>{const Ae=ae.current;if(!Ae||!y||!i||Le.current!==Et)return;if(St&&p>0&&!Bt.current){Bt.current=!0,console.group("[RENDER DIAG] Walking group post-remap"),console.log(`layers=${y.layers} frames=${y.animationLength} sprites=${y.sprites.length} pX=${y.patternX}`);const Rt=["N","E","S","W"];for(let mt=0;mt<y.animationLength;mt++)for(let gt=0;gt<y.patternX;gt++)for(let At=0;At<y.layers;At++){const Gt=er(y,mt,gt,0,0,At,0,0),Xt=Gt<y.sprites.length?y.sprites[Gt]:-1,In=Xt>0&&(a.has(Xt)||!!mn(i,Xt));console.log(`  f=${mt} ${Rt[gt]} L${At}: idx=${Gt} sid=${Xt} hasPixels=${In}`)}console.groupEnd()}const Ge=y.width*32,et=y.height*32,He=ie?[ue<y.patternX?ue:0]:Array.from({length:y.patternX},(Rt,mt)=>mt),We=ie?[B<y.patternY?B:0]:Array.from({length:y.patternY},(Rt,mt)=>mt),rt=He.length,Pt=We.length,Xe=K!=null&&K!==o,Ke=Xe&&(h!=null&&h.flags.hasDisplacement)?h.flags.displacementX??0:0,Ze=Xe&&(h!=null&&h.flags.hasDisplacement)?h.flags.displacementY??0:0,Ne=Xe&&(Ke!==0||Ze!==0),Me=Math.abs(Ke),it=Math.abs(Ze),Qe=Ge+Me,Ye=et+it,tt=rt*Qe,qe=Pt*Ye;Ae.width=tt,Ae.height=qe;const Mt=Ae.getContext("2d");Mt.clearRect(0,0,tt,qe);for(let Rt=0;Rt<We.length;Rt++){const mt=We[Rt];for(let gt=0;gt<He.length;gt++){const At=He[gt],Gt=gt*Qe,Xt=Rt*Ye,In=Gt+Math.max(0,Ke),Ar=Xt+Math.max(0,Ze),ei=Gt+Math.max(0,-Ke),It=Xt+Math.max(0,-Ze);if(Xe&&n){const yn=n.things.get(K),wt=yn==null?void 0:yn.frameGroups[0];if(wt){const Ln=At<wt.patternX?At:0,Tr=mt<wt.patternY?mt:0,or=wt.layers>=2;Ue(Mt,wt,0,[Ln],[Tr],wt.width*32,wt.height*32,!1,or,ge,In,Ar)}}const Tn=St&&re&&y.layers>=2,Ir=Tn?[0]:re?Array.from({length:y.layers},(yn,wt)=>wt):[Se];for(const yn of Ir)for(let wt=0;wt<y.height;wt++)for(let Ln=0;Ln<y.width;Ln++){const Tr=er(y,le,At,mt,_e,yn,Ln,wt);if(Tr>=y.sprites.length)continue;const or=y.sprites[Tr];if(or<=0)continue;const ks=a.get(or)??mn(i,or);if(!ks)continue;const Ti=new ImageData(new Uint8ClampedArray(ks.data),32,32);if(Tn){const vn=er(y,le,At,mt,_e,1,Ln,wt);if(vn<y.sprites.length){const ti=y.sprites[vn];if(ti>0){const Lr=a.get(ti)??mn(i,ti);Lr&&zo(Ti,Lr,ge)}}}const ct=ei+(y.width-1-Ln)*32,Ss=It+(y.height-1-wt)*32;if(Xe||Tn||re&&yn>0){const vn=document.createElement("canvas");vn.width=32,vn.height=32,vn.getContext("2d").putImageData(Ti,0,0),Mt.drawImage(vn,ct,Ss)}else Mt.putImageData(Ti,ct,Ss)}if(Ne){Mt.save(),Mt.strokeStyle="rgba(250, 204, 21, 0.7)",Mt.lineWidth=1,Mt.setLineDash([4,3]);const yn=In+Ge-32,wt=Ar+et-32;Mt.strokeRect(yn+.5,wt+.5,31,31),Mt.restore()}}}},[y,i,a,Se,_e,re,ie,ue,B,St,ge,K,o,n,Ue,h,m]);H.useEffect(()=>{Ft(S)},[S,Ft]),H.useEffect(()=>{var et;if(!w||!y||y.animationLength<=1)return;let le=S;const Ae=()=>{var We;le=(le+1)%y.animationLength,g(le),Ft(le);const He=((We=y.animationLengths[le])==null?void 0:We.min)??200;Ce.current=window.setTimeout(Ae,He)},Ge=((et=y.animationLengths[le])==null?void 0:et.min)??200;return Ce.current=window.setTimeout(Ae,Ge),()=>{clearTimeout(Ce.current)}},[w,y,Ft]);const ht=y?ie?1:y.patternX:1,lt=y?ie?1:y.patternY:1,nr=K!=null&&K!==o,rr=nr&&(h!=null&&h.flags.hasDisplacement)?Math.abs(h.flags.displacementX??0):0,Dr=nr&&(h!=null&&h.flags.hasDisplacement)?Math.abs(h.flags.displacementY??0):0,ir=y?ht*(y.width*32+rr):32,gn=y?lt*(y.height*32+Dr):32,xn=H.useCallback((le,Ae)=>{if(!y||!ae.current)return 0;const Ge=ae.current.getBoundingClientRect(),et=(le-Ge.left)/E,He=(Ae-Ge.top)/E,We=Math.floor(et/32),rt=Math.floor(He/32),Pt=ht*y.width,Xe=lt*y.height;if(We<0||We>=Pt||rt<0||rt>=Xe)return 0;const Ke=Math.floor(We/y.width),Ze=Math.floor(rt/y.height),Ne=ie?ue<y.patternX?ue:0:Ke,Me=ie?B<y.patternY?B:0:Ze,it=y.width-1-We%y.width,Qe=y.height-1-rt%y.height,Ye=er(y,S,Ne,Me,_e,Se,it,Qe);return Ye<y.sprites.length?y.sprites[Ye]:0},[y,E,S,Se,_e,ie,ue,B,ht,lt]),jn=H.useCallback((le,Ae)=>{if(!y||!ae.current)return-1;const Ge=ae.current.getBoundingClientRect(),et=(le-Ge.left)/E,He=(Ae-Ge.top)/E,We=Math.floor(et/32),rt=Math.floor(He/32),Pt=ht*y.width,Xe=lt*y.height;if(We<0||We>=Pt||rt<0||rt>=Xe)return-1;const Ke=Math.floor(We/y.width),Ze=Math.floor(rt/y.height),Ne=ie?ue<y.patternX?ue:0:Ke,Me=ie?B<y.patternY?B:0:Ze,it=y.width-1-We%y.width,Qe=y.height-1-rt%y.height,Ye=er(y,S,Ne,Me,_e,Se,it,Qe);return Ye<y.sprites.length?Ye:-1},[y,E,S,Se,_e,ie,ue,B,ht,lt]),An=H.useCallback((le,Ae,Ge)=>{if(!y||!i)return;const et=le[0];if(!et||!et.type.startsWith("image/"))return;const He=new Image;He.onload=()=>{const We=document.createElement("canvas");We.width=32,We.height=32;const rt=We.getContext("2d"),Pt=(Xe,Ke)=>{const Ze=y.sprites[Xe];if(Ze>0)l(Ze,Ke);else{const Ne=d(Ke);if(Ne!=null&&(y.sprites[Xe]=Ne,h)){const Me=new Set(I.getState().dirtyIds);Me.add(h.id),I.setState({dirty:!0,dirtyIds:Me})}}};if(He.width<=32&&He.height<=32){rt.clearRect(0,0,32,32),rt.drawImage(He,0,0,32,32);const Xe=rt.getImageData(0,0,32,32);let Ke=-1;if(Ae!=null&&Ge!=null){const Ze=xn(Ae,Ge);Ze>0&&(Ke=y.sprites.indexOf(Ze))}Ke<0&&(Ke=er(y,S,0,0,0,0,0,0)),Ke>=0&&Ke<y.sprites.length&&Pt(Ke,Xe)}else{const Xe=y.patternX*y.width,Ke=y.patternY*y.height;for(let Ze=0;Ze<Ke&&Ze*32<He.height;Ze++)for(let Ne=0;Ne<Xe&&Ne*32<He.width;Ne++){const Me=Math.floor(Ne/y.width),it=Math.floor(Ze/y.height),Qe=y.width-1-Ne%y.width,Ye=y.height-1-Ze%y.height,tt=er(y,S,Me,it,0,0,Qe,Ye);if(tt>=y.sprites.length)continue;rt.clearRect(0,0,32,32),rt.drawImage(He,Ne*32,Ze*32,32,32,0,0,32,32);const qe=rt.getImageData(0,0,32,32);Pt(tt,qe)}}},He.src=URL.createObjectURL(et)},[y,h,i,S,l,d,xn]),sr=H.useCallback(le=>{le.preventDefault(),G(!1),Z(null);const Ae=le.dataTransfer.getData("application/x-sprite-id");if(Ae&&h&&y){const Ge=parseInt(Ae,10);if(!isNaN(Ge)&&Ge>0){const et=jn(le.clientX,le.clientY);if(et>=0){y.sprites[et]=Ge,h.rawBytes=void 0,zn();const He=I.getState(),We=new Set(He.dirtyIds);We.add(h.id),I.setState({dirty:!0,dirtyIds:We,editVersion:He.editVersion+1})}return}}le.dataTransfer.files.length>0&&An(le.dataTransfer.files,le.clientX,le.clientY)},[An,h,y,jn]),jr=H.useCallback((le,Ae)=>{if(!h||!y)return;y[le]=Ae;const Ge=y.width*y.height*y.layers*y.patternX*y.patternY*y.patternZ*y.animationLength;if(y.sprites.length<Ge)for(;y.sprites.length<Ge;)y.sprites.push(0);else y.sprites.length>Ge&&(y.sprites.length=Ge);for(;y.animationLengths.length<y.animationLength;)y.animationLengths.push({min:100,max:100});y.animationLengths.length>y.animationLength&&(y.animationLengths.length=y.animationLength),h.rawBytes=void 0,zn();const et=I.getState(),He=new Set(et.dirtyIds);He.add(h.id),I.setState({dirty:!0,dirtyIds:He,editVersion:et.editVersion+1})},[h,y]);if(!h)return u.jsx("div",{className:"flex items-center justify-center h-full text-emperia-muted text-sm",children:"Select an object to preview"});const bs=y?y.animationLength>1:!1;return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsxs("div",{className:"flex items-center px-4 py-2 border-b border-emperia-border gap-3",children:[u.jsx("span",{className:"text-[10px] text-emperia-muted",children:"Zoom:"}),u.jsx("input",{type:"range",min:1,max:8,value:E,onChange:le=>P(Number(le.target.value)),className:"flex-1 h-1 accent-emperia-accent"}),u.jsxs("span",{className:"text-[10px] text-emperia-muted w-6 text-right",children:[E,"x"]})]}),u.jsx("div",{className:"flex-1 flex items-center justify-center overflow-auto min-h-0",onWheel:le=>{!bs||!y||(le.preventDefault(),_(!1),g(Ae=>{const Ge=le.deltaY>0?1:-1;return(Ae+Ge+y.animationLength)%y.animationLength}))},children:(()=>{const le=(y==null?void 0:y.patternX)??0,Ae=(y==null?void 0:y.patternY)??0,Ge=Fe&&le>=3&&Ae>=3,et=(St||vt)&&le>1&&le<=4,He=ie&&y&&(Ge||et),We=He?Ge?[{px:0,py:0,label:"NW",arrow:""},{px:1,py:0,label:"N",arrow:""},{px:2,py:0,label:"NE",arrow:""},{px:0,py:1,label:"W",arrow:""},"canvas",{px:2,py:1,label:"E",arrow:""},{px:0,py:2,label:"SW",arrow:""},{px:1,py:2,label:"S",arrow:""},{px:2,py:2,label:"SE",arrow:""}]:[null,{px:0,py:0,label:"N",arrow:""},null,{px:3,py:0,label:"W",arrow:""},"canvas",{px:1,py:0,label:"E",arrow:""},null,{px:2,py:0,label:"S",arrow:""},null]:[],rt=(Ne,Me)=>u.jsx("button",{onClick:()=>{te(Ne.px),b(Ne.py)},className:`w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-colors ${ue===Ne.px&&B===Ne.py?"bg-emperia-accent text-white shadow-lg shadow-emperia-accent/30":"bg-emperia-surface border border-emperia-border text-emperia-muted hover:text-emperia-text hover:bg-emperia-hover"}`,title:Ne.label,children:Ne.arrow},`dir-${Me}`),Pt=u.jsxs("div",{className:`checkerboard rounded-lg border relative transition-colors
                ${A?"border-emperia-accent border-2":"border-emperia-border"}`,style:{padding:8},onDragOver:Ne=>{if(Ne.preventDefault(),G(!0),ae.current&&y){const Me=ae.current.getBoundingClientRect(),it=Math.floor((Ne.clientX-Me.left)/(32*E)),Qe=Math.floor((Ne.clientY-Me.top)/(32*E)),Ye=ht*y.width,tt=lt*y.height;it>=0&&it<Ye&&Qe>=0&&Qe<tt?Z({col:it,row:Qe}):Z(null)}},onDragLeave:()=>{G(!1),Z(null)},onDrop:Ne=>{Z(null),sr(Ne)},onMouseMove:Ne=>{if(!ae.current||!y){he(null);return}const Me=ht*y.width,it=lt*y.height;if(Me<=1&&it<=1){he(null);return}const Qe=ae.current.getBoundingClientRect(),Ye=Math.floor((Ne.clientX-Qe.left)/(32*E)),tt=Math.floor((Ne.clientY-Qe.top)/(32*E));Ye>=0&&Ye<Me&&tt>=0&&tt<it?he(qe=>(qe==null?void 0:qe.col)===Ye&&(qe==null?void 0:qe.row)===tt?qe:{col:Ye,row:tt}):he(null)},onMouseLeave:()=>he(null),children:[u.jsx("canvas",{ref:ae,className:"cursor-pointer",onClick:Ne=>{const Me=xn(Ne.clientX,Ne.clientY);Me>0&&I.setState({focusSpriteId:Me})},style:{width:ir*E,height:gn*E,imageRendering:"pixelated"}}),k&&y&&u.jsx("div",{className:"absolute inset-2 pointer-events-none",style:{backgroundImage:`
                      repeating-linear-gradient(0deg, rgba(255,255,255,0.15), rgba(255,255,255,0.15) 1px, transparent 1px, transparent ${32*E}px),
                      repeating-linear-gradient(90deg, rgba(255,255,255,0.15), rgba(255,255,255,0.15) 1px, transparent 1px, transparent ${32*E}px)
                    `,backgroundSize:`${32*E}px ${32*E}px`}}),D&&y&&u.jsx("div",{className:"absolute pointer-events-none border border-yellow-400/60",style:{bottom:8,left:8,width:y.width*32*E,height:y.height*32*E}}),A&&!M&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-emperia-accent/10 rounded-lg pointer-events-none",children:u.jsx("span",{className:"text-emperia-accent text-xs font-medium",children:"Drop PNG to replace"})}),M&&u.jsx("div",{className:"absolute pointer-events-none border-2 border-emperia-accent bg-emperia-accent/15 rounded-sm",style:{left:8+M.col*32*E,top:8+M.row*32*E,width:32*E,height:32*E}}),de&&!A&&u.jsx("div",{className:"absolute pointer-events-none border border-white/40 bg-white/5 rounded-sm",style:{left:8+de.col*32*E,top:8+de.row*32*E,width:32*E,height:32*E}})]}),Xe=bs&&y?u.jsx(Kg,{animationLength:y.animationLength,currentFrame:S,setCurrentFrame:g,setPlaying:_,height:gn*E+16}):null,Ze=(y?y.layers>1:!1)&&y?u.jsx(Qg,{layers:y.layers,activeLayer:Se,setActiveLayer:Ee,blendLayers:re,setBlendLayers:ve,height:gn*E+16}):null;return He?u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"grid gap-1",style:{gridTemplateColumns:"auto auto auto",gridTemplateRows:"auto auto auto",justifyItems:"center",alignItems:"center"},children:We.map((Ne,Me)=>Ne==="canvas"?u.jsx("div",{children:Pt},"canvas"):Ne!=null?rt(Ne,Me):u.jsx("div",{className:"w-9 h-9"},`empty-${Me}`))}),Xe,Ze]}):u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:`checkerboard rounded-lg border relative transition-colors
            ${A?"border-emperia-accent border-2":"border-emperia-border"}`,style:{padding:8},onDragOver:Ne=>{if(Ne.preventDefault(),G(!0),ae.current&&y){const Me=ae.current.getBoundingClientRect(),it=Math.floor((Ne.clientX-Me.left)/(32*E)),Qe=Math.floor((Ne.clientY-Me.top)/(32*E)),Ye=ht*y.width,tt=lt*y.height;it>=0&&it<Ye&&Qe>=0&&Qe<tt?Z({col:it,row:Qe}):Z(null)}},onDragLeave:()=>{G(!1),Z(null)},onDrop:Ne=>{Z(null),sr(Ne)},onMouseMove:Ne=>{if(!ae.current||!y){he(null);return}const Me=ht*y.width,it=lt*y.height;if(Me<=1&&it<=1){he(null);return}const Qe=ae.current.getBoundingClientRect(),Ye=Math.floor((Ne.clientX-Qe.left)/(32*E)),tt=Math.floor((Ne.clientY-Qe.top)/(32*E));Ye>=0&&Ye<Me&&tt>=0&&tt<it?he(qe=>(qe==null?void 0:qe.col)===Ye&&(qe==null?void 0:qe.row)===tt?qe:{col:Ye,row:tt}):he(null)},onMouseLeave:()=>he(null),children:[u.jsx("canvas",{ref:ae,className:"cursor-pointer",onClick:Ne=>{const Me=xn(Ne.clientX,Ne.clientY);Me>0&&I.setState({focusSpriteId:Me})},style:{width:ir*E,height:gn*E,imageRendering:"pixelated"}}),k&&y&&u.jsx("div",{className:"absolute inset-2 pointer-events-none",style:{backgroundImage:`
                  repeating-linear-gradient(0deg, rgba(255,255,255,0.15), rgba(255,255,255,0.15) 1px, transparent 1px, transparent ${32*E}px),
                  repeating-linear-gradient(90deg, rgba(255,255,255,0.15), rgba(255,255,255,0.15) 1px, transparent 1px, transparent ${32*E}px)
                `,backgroundSize:`${32*E}px ${32*E}px`}}),D&&y&&u.jsx("div",{className:"absolute pointer-events-none border border-yellow-400/60",style:{bottom:8,left:8,width:y.width*32*E,height:y.height*32*E}}),A&&!M&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-emperia-accent/10 rounded-lg pointer-events-none",children:u.jsx("span",{className:"text-emperia-accent text-xs font-medium",children:"Drop PNG to replace"})}),M&&u.jsx("div",{className:"absolute pointer-events-none border-2 border-emperia-accent bg-emperia-accent/15 rounded-sm",style:{left:8+M.col*32*E,top:8+M.row*32*E,width:32*E,height:32*E}}),de&&!A&&u.jsx("div",{className:"absolute pointer-events-none border border-white/40 bg-white/5 rounded-sm",style:{left:8+de.col*32*E,top:8+de.row*32*E,width:32*E,height:32*E}})]}),Xe,Ze]})})()}),u.jsx(Vg,{thing:h,group:y,objectData:n,spriteData:i,spriteOverrides:a,category:yt,zoom:E,setZoom:P,showGrid:k,setShowGrid:N,showCropSize:D,setShowCropSize:T,previewMode:ie,setPreviewMode:X,playing:w,setPlaying:_,currentFrame:S,setCurrentFrame:g,canvasRef:ae,handleImageFiles:An,copyMenuOpen:V,setCopyMenuOpen:Q,copyMenuRef:ee,baseOutfitId:K,setBaseOutfitId:oe}),(h.frameGroups.length>1||St)&&u.jsxs("div",{className:"flex items-center justify-center px-4 py-1.5 gap-1 border-t border-emperia-border",children:[h.frameGroups.map((le,Ae)=>u.jsx("button",{onClick:()=>{v(Ae),g(0),_(!1),Ee(0),Y(0)},className:`px-3 py-1 rounded text-[11px] font-medium transition-colors
                ${p===Ae?"bg-emperia-accent text-white":"bg-emperia-surface text-emperia-muted hover:bg-emperia-hover border border-emperia-border"}
              `,children:Ae===0?"Idle":Ae===1?"Moving":`Group ${Ae}`},Ae)),u.jsxs("span",{className:"text-[9px] text-emperia-muted/50 ml-1",children:[h.frameGroups.length," grp"]})]}),y&&u.jsx(Yg,{thing:h,group:y,isOutfit:St,isDistance:Fe,previewMode:ie,activeDirection:ue,setActiveDirection:te,activePatternY:B,setActivePatternY:b,activeZ:_e,setActiveZ:Y,updateFrameGroupProp:jr})]})}const vh=[{title:"Ground & Stacking",wide:!0,flags:[{key:"ground",label:"Ground",numericProps:[{key:"groundSpeed",label:"Speed",min:0,max:65535}]},{key:"groundBorder",label:"Ground Border"},{key:"onBottom",label:"On Bottom"},{key:"onTop",label:"On Top"},{key:"fullGround",label:"Full Ground"},{key:"topEffect",label:"Top Effect"}]},{title:"Blocking",flags:[{key:"notWalkable",label:"Not Walkable"},{key:"notMoveable",label:"Not Moveable"},{key:"blockProjectile",label:"Block Projectile"},{key:"notPathable",label:"Not Pathable"}]},{title:"Fluids",flags:[{key:"fluidContainer",label:"Fluid Container"},{key:"splash",label:"Splash"}]},{title:"Interaction",flags:[{key:"pickupable",label:"Pickupable"},{key:"stackable",label:"Stackable"},{key:"container",label:"Container"},{key:"forceUse",label:"Force Use"},{key:"multiUse",label:"Multi Use"},{key:"usable",label:"Usable"},{key:"rotateable",label:"Rotateable"},{key:"wrapable",label:"Wrapable"},{key:"unwrapable",label:"Unwrapable"}]},{title:"Hooks & Hanging",flags:[{key:"hangable",label:"Hangable"},{key:"hookSouth",label:"Hook South"},{key:"hookEast",label:"Hook East"}]},{title:"Writing",wide:!0,flags:[{key:"writable",label:"Writable",numericProps:[{key:"writableMaxLen",label:"Max Length",min:0,max:65535}]},{key:"writableOnce",label:"Writable Once",numericProps:[{key:"writableOnceMaxLen",label:"Max Length",min:0,max:65535}]}]},{title:"Visual",wide:!0,flags:[{key:"hasLight",label:"Light",numericProps:[{key:"lightLevel",label:"Level",min:0,max:65535},{key:"lightColor",label:"Color",min:0,max:65535}]},{key:"hasDisplacement",label:"Displacement",numericProps:[{key:"displacementX",label:"X",min:-512,max:512},{key:"displacementY",label:"Y",min:-512,max:512}]},{key:"hasElevation",label:"Elevation",numericProps:[{key:"elevation",label:"Height",min:0,max:65535}]},{key:"hasMinimapColor",label:"Minimap Color",numericProps:[{key:"minimapColor",label:"Color",min:0,max:65535}]},{key:"translucent",label:"Translucent"},{key:"dontHide",label:"Don't Hide"},{key:"animateAlways",label:"Animate Always"},{key:"noMoveAnimation",label:"No Move Animation"}]},{title:"Equipment & Market",wide:!0,flags:[{key:"cloth",label:"Cloth",numericProps:[{key:"clothSlot",label:"Slot",min:0,max:65535}]},{key:"hasMarket",label:"Market"},{key:"chargeable",label:"Chargeable"}]},{title:"Miscellaneous",flags:[{key:"lyingCorpse",label:"Lying Corpse"},{key:"look",label:"Look"}]}],pf=vh.flatMap(o=>o.flags);function mf({showAttributesOnly:o}={}){const n=I(h=>h.selectedThingId),i=I(h=>h.objectData),a=I(h=>h.updateThingFlags);I(h=>h.editVersion);const l=n!=null?(i==null?void 0:i.things.get(n))??null:null,d=H.useCallback(h=>{if(!l)return;const p={...l.flags};p[h]=!p[h],p[h]||(h==="ground"&&(p.groundSpeed=void 0),h==="hasLight"&&(p.lightLevel=void 0,p.lightColor=void 0),h==="hasDisplacement"&&(p.displacementX=void 0,p.displacementY=void 0),h==="hasElevation"&&(p.elevation=void 0),h==="hasMinimapColor"&&(p.minimapColor=void 0),h==="cloth"&&(p.clothSlot=void 0)),p[h]&&(h==="ground"&&p.groundSpeed==null&&(p.groundSpeed=100),h==="hasLight"&&(p.lightLevel==null&&(p.lightLevel=7),p.lightColor==null&&(p.lightColor=215)),h==="hasDisplacement"&&(p.displacementX==null&&(p.displacementX=8),p.displacementY==null&&(p.displacementY=8)),h==="hasElevation"&&p.elevation==null&&(p.elevation=8),h==="hasMinimapColor"&&p.minimapColor==null&&(p.minimapColor=0),h==="cloth"&&p.clothSlot==null&&(p.clothSlot=0)),a(l.id,p)},[l,a]),m=H.useCallback((h,p)=>{if(!l)return;const v={...l.flags,[h]:p};a(l.id,v)},[l,a]);return l?o?u.jsxs("div",{className:"p-3 text-xs space-y-4",children:[l.frameGroups.map((h,p)=>u.jsxs(gf,{title:`Frame Group ${p}${l.category==="outfit"?p===0?" (Idle)":" (Moving)":""}`,children:[u.jsx(On,{label:"Size",value:`${h.width}x${h.height}`}),u.jsx(On,{label:"Layers",value:h.layers}),u.jsx(On,{label:"Pattern X",value:h.patternX}),u.jsx(On,{label:"Pattern Y",value:h.patternY}),u.jsx(On,{label:"Pattern Z",value:h.patternZ}),u.jsx(On,{label:"Animations",value:h.animationLength}),u.jsx(On,{label:"Sprites",value:h.sprites.length}),h.animationLength>1&&u.jsxs(u.Fragment,{children:[u.jsx(On,{label:"Async",value:h.asynchronous?"Yes":"No"}),u.jsx(On,{label:"Loop Count",value:h.nLoop===0?"Infinite":h.nLoop}),u.jsx(On,{label:"Start Frame",value:h.start})]})]},p)),u.jsx(gf,{title:"Active Flags",children:u.jsxs("div",{className:"space-y-0.5",children:[pf.filter(({key:h})=>!!l.flags[h]).map(({key:h,label:p})=>u.jsx("div",{className:"text-emperia-text text-xs",children:p},h)),pf.every(({key:h})=>!l.flags[h])&&u.jsx("span",{className:"text-emperia-muted italic",children:"None"})]})})]}):u.jsx("div",{className:"p-3 text-xs space-y-1",children:u.jsx("div",{className:"grid grid-cols-4 gap-1",children:vh.map(h=>{const p=h.flags.filter(S=>!!l.flags[S.key]).length,v=h.wide?"col-span-2":"";return u.jsx("div",{className:v,children:u.jsx(qg,{title:h.title,activeCount:p,flags:h.flags,thingFlags:l.flags,onToggle:d,onNumericChange:m})},h.title)})})}):u.jsx("div",{className:"p-4 text-emperia-muted text-sm",children:"No object selected"})}function gf({title:o,children:n}){return u.jsxs("div",{children:[u.jsx("h3",{className:"text-emperia-accent font-semibold text-[11px] uppercase tracking-wider mb-1.5 pb-1 border-b border-emperia-border",children:o}),u.jsx("div",{className:"space-y-0.5",children:n})]})}function On({label:o,value:n}){return u.jsxs("div",{className:"flex justify-between py-0.5",children:[u.jsx("span",{className:"text-emperia-muted",children:o}),u.jsx("span",{className:"text-emperia-text font-mono",children:String(n)})]})}function qg({title:o,activeCount:n,flags:i,thingFlags:a,onToggle:l,onNumericChange:d}){const[m,h]=H.useState(!0);return u.jsxs("div",{className:"border border-emperia-border/50 rounded overflow-hidden",children:[u.jsxs("button",{onClick:()=>h(!m),className:"w-full flex items-center gap-1.5 px-2 py-1.5 bg-emperia-surface/60 hover:bg-emperia-surface transition-colors text-left",children:[m?u.jsx(lc,{className:"w-3 h-3 text-emperia-muted shrink-0"}):u.jsx(Df,{className:"w-3 h-3 text-emperia-muted shrink-0"}),u.jsx("span",{className:"text-[10px] font-semibold text-emperia-text uppercase tracking-wider flex-1",children:o}),n>0&&u.jsx("span",{className:"text-[9px] font-medium text-emperia-accent bg-emperia-accent/15 px-1.5 py-0.5 rounded-full",children:n})]}),m&&u.jsx("div",{className:"px-1 py-0.5",children:i.map(({key:p,label:v,numericProps:S})=>{const g=!!a[p];return u.jsxs("div",{children:[u.jsxs("label",{className:"flex items-center gap-2 py-[3px] px-1 rounded hover:bg-emperia-hover cursor-pointer select-none",children:[u.jsx("input",{type:"checkbox",checked:g,onChange:()=>l(p),className:"w-3 h-3 rounded border-emperia-border bg-emperia-surface accent-emperia-accent cursor-pointer"}),u.jsx("span",{className:g?"text-emperia-text":"text-emperia-muted",children:v})]}),g&&S&&S.length>0&&u.jsx("div",{className:"ml-7 mb-1 flex flex-wrap gap-x-3 gap-y-0.5",children:S.map(w=>u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx("span",{className:"text-emperia-muted text-[10px]",children:w.label}),u.jsx("input",{type:"number",value:a[w.key]??0,min:w.min,max:w.max,onChange:_=>{const E=parseInt(_.target.value,10);isNaN(E)||d(w.key,Math.max(w.min??0,Math.min(w.max??65535,E)))},className:`w-16 px-1 py-0.5 rounded bg-emperia-surface border border-emperia-border
                                     text-emperia-text font-mono text-right text-[10px] outline-none
                                     focus:border-emperia-accent transition-colors`})]},w.key))})]},p)})})]})}const xf=40;function Jg({spriteId:o,spriteData:n,spriteOverrides:i,isHighlighted:a,isAtlasSelected:l,hasSelectedSlot:d,onClick:m,onContextMenu:h,onDragStart:p,onDelete:v}){const S=Yo(n,o,i);return u.jsxs("div",{draggable:!0,onDragStart:p,className:`group relative flex items-center justify-center border transition-colors cursor-grab active:cursor-grabbing
        ${l?"border-emperia-accent bg-emperia-accent/20":a?"border-green-400 bg-green-400/20":d?"border-transparent hover:bg-emperia-accent/10 hover:border-emperia-accent/30 cursor-pointer":"border-transparent hover:bg-emperia-hover"}
      `,style:{width:xf,height:xf},title:`#${o}${l?" (selected)":""}  Ctrl+click to multi-select, Shift+click for range`,onClick:m,onContextMenu:h,children:[S?u.jsx("img",{src:S,alt:"",draggable:!1,className:"w-8 h-8 pointer-events-none",style:{imageRendering:"pixelated"}}):u.jsx("div",{className:"w-6 h-6"}),u.jsx("span",{className:"absolute bottom-0 right-0.5 text-[6px] text-emperia-muted/40 leading-none",children:o}),!l&&u.jsx("button",{className:"absolute top-0 right-0 p-0.5 rounded-bl bg-red-500/80 text-white opacity-0 group-hover:opacity-100 transition-opacity",onClick:g=>{g.stopPropagation(),v()},title:`Delete sprite #${o}`,children:u.jsx(Di,{className:"w-2.5 h-2.5"})})]})}const yf=[{value:1,label:"11",desc:"no padding"},{value:2,label:"22",desc:"4 tiles/group"},{value:4,label:"44",desc:"16 tiles/group"}],Yr=40,Un=6;function e1(){var B;const o=I(b=>b.selectedThingId),n=I(b=>b.objectData),i=I(b=>b.spriteData),a=I(b=>b.spriteOverrides),l=I(b=>b.focusSpriteId),d=I(b=>b.importTileSize),m=I(b=>b.selectedSlots),[h,p]=H.useState(""),[v,S]=H.useState(0),[g,w]=H.useState(0),[_,E]=H.useState(null),[P,k]=H.useState(new Set),[N,D]=H.useState(null),T=H.useRef(null),A=H.useRef(null),G=o!=null?(n==null?void 0:n.things.get(o))??null:null,M=H.useCallback(b=>{const V=I.getState().addSprite,Q=d;Array.from(b).forEach(ee=>{const K=new Image;K.onload=()=>{const oe=document.createElement("canvas"),ae=oe.getContext("2d");oe.width=32,oe.height=32;const Ce=Math.max(1,Math.floor(K.width/32)),Le=Math.max(1,Math.floor(K.height/32)),yt=Q>1?Math.max(1,Math.floor(Ce/Q)):Ce,St=Q>1?Math.max(1,Math.floor(Le/Q)):Le,vt=[];let Fe=(i==null?void 0:i.spriteCount)??0;const y=()=>{const Ue=Fe%Un;if(Ue===0)return;const Et=Un-Ue,Bt=new ImageData(32,32);for(let Ft=0;Ft<Et;Ft++)V(Bt),Fe++};if(Q<=1)for(let Ue=0;Ue<Le;Ue++)for(let Et=0;Et<Ce;Et++){ae.clearRect(0,0,32,32),ae.drawImage(K,Et*32,Ue*32,32,32,0,0,32,32);const Bt=ae.getImageData(0,0,32,32);let Ft=!1;for(let lt=3;lt<Bt.data.length;lt+=4)if(Bt.data[lt]>0){Ft=!0;break}if(!Ft)continue;const ht=V(Bt);ht!=null&&(vt.push(ht),Fe++)}else{const Ue=Math.max(1,Math.floor(Un/Q));y();for(let Et=0;Et<St;Et++)for(let Bt=0;Bt<yt;Bt+=Ue){const Ft=Math.min(Ue,yt-Bt);for(let ht=0;ht<Q;ht++){for(let lt=0;lt<Ft;lt++){const nr=Bt+lt;for(let rr=0;rr<Q;rr++){const Dr=nr*Q+rr,ir=Et*Q+ht;if(Dr>=Ce||ir>=Le)continue;ae.clearRect(0,0,32,32),ae.drawImage(K,Dr*32,ir*32,32,32,0,0,32,32);const gn=ae.getImageData(0,0,32,32);let xn=!1;for(let An=3;An<gn.data.length;An+=4)if(gn.data[An]>0){xn=!0;break}const jn=V(xn?gn:new ImageData(32,32));jn!=null&&(vt.push(jn),Fe++)}}y()}}}if(vt.length>0&&(p(""),E(vt[0]),setTimeout(()=>E(null),2e3),T.current&&i)){const Ue=vt[0]-1,Et=Math.floor(Ue/Un);T.current.scrollTop=Et*Yr}},K.src=URL.createObjectURL(ee)})},[i,d]),Z=H.useCallback(b=>{b<=0||confirm(`Delete sprite #${b}? It will be replaced with a blank sprite.`)&&I.getState().deleteSprite(b)},[]);H.useEffect(()=>{I.setState({selectedSlots:[]})},[o]),H.useEffect(()=>{if(l!=null&&l>0&&T.current&&i){p("");const b=l-1,V=Math.floor(b/Un);T.current.scrollTop=V*Yr,E(l),I.setState({focusSpriteId:null}),setTimeout(()=>E(null),2e3)}},[l,i]);const de=I(b=>b.editVersion),he=H.useMemo(()=>{if(!i)return[];if(h){const V=parseInt(h,10);if(!isNaN(V)){const Q=[];for(let ee=Math.max(1,V-50);ee<=Math.min(i.spriteCount,V+200);ee++)Q.push(ee);return Q}}const b=[];for(let V=1;V<=i.spriteCount;V++)b.push(V);return b},[i,h,de]),Se=Math.ceil(he.length/Un),Ee=Se*Yr,_e=H.useCallback(()=>{T.current&&(S(T.current.scrollTop),w(T.current.clientHeight))},[]);H.useEffect(()=>{_e();const b=T.current;if(b){const V=new ResizeObserver(_e);return V.observe(b),()=>V.disconnect()}},[_e]),H.useEffect(()=>{if(h&&T.current){const b=parseInt(h,10);if(!isNaN(b)){const V=he.indexOf(b);if(V>=0){const Q=Math.floor(V/Un);T.current.scrollTop=Q*Yr}}}},[h,he]);const Y=Math.max(0,Math.floor(v/Yr)-2),re=Math.min(Se,Math.ceil((v+g)/Yr)+2),ve=he.slice(Y*Un,re*Un),ge=H.useCallback((b,V)=>{if(!G)return;const Q=G.frameGroups[b.group];if(!Q)return;Q.sprites[b.index]=V,G.rawBytes=void 0,zn();const ee=I.getState(),K=new Set(ee.dirtyIds);K.add(G.id),I.setState({dirty:!0,dirtyIds:K,editVersion:ee.editVersion+1})},[G]),ie=H.useMemo(()=>{const b=new Set;if(!n)return b;for(const V of n.things.values())for(const Q of V.frameGroups)for(const ee of Q.sprites)ee>0&&b.add(ee);return b},[n,de]),X=H.useCallback(()=>{if(P.size===0)return;const b=Array.from(P).filter(ee=>ee>0);if(b.length===0)return;const V=b.filter(ee=>ie.has(ee));let Q=`Delete ${b.length} selected sprite(s)? They will be replaced with blank sprites.`;V.length>0&&(Q+=`

WARNING: ${V.length} of these sprites are referenced by objects and will appear blank in-game!`),confirm(Q)&&(I.getState().deleteSprites(b),k(new Set))},[P,ie]),ue=H.useCallback((b,V)=>{if(m.length>0&&G){for(const Q of m)ge(Q,V);I.setState({selectedSlots:[]});return}if(b.ctrlKey||b.metaKey)k(Q=>{const ee=new Set(Q);return ee.has(V)?ee.delete(V):ee.add(V),ee}),D(V);else if(b.shiftKey&&N!=null){const Q=he.indexOf(N),ee=he.indexOf(V);if(Q>=0&&ee>=0){const K=Math.min(Q,ee),oe=Math.max(Q,ee);k(ae=>{const Ce=new Set(ae);for(let Le=K;Le<=oe;Le++)Ce.add(he[Le]);return Ce})}}else k(Q=>Q.size===1&&Q.has(V)?new Set:new Set([V])),D(V)},[m,G,ge,N,he]),te=H.useCallback((b,V)=>{b.dataTransfer.setData("application/x-sprite-id",String(V)),b.dataTransfer.effectAllowed="copy"},[]);return i?u.jsx("div",{className:"flex flex-col h-full",children:u.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"px-2 py-1.5 border-b border-emperia-border flex items-center gap-1.5",children:[u.jsx("span",{className:"text-[10px] font-medium text-emperia-text uppercase tracking-wider shrink-0",children:"Sprite Atlas"}),u.jsxs("div",{className:"flex-1 relative",children:[u.jsx(Ii,{className:"absolute left-1.5 top-1/2 -translate-y-1/2 w-3 h-3 text-emperia-muted"}),u.jsx("input",{type:"text",value:h,onChange:b=>p(b.target.value),placeholder:"Go to ID...",className:"w-full pl-6 pr-2 py-0.5 bg-emperia-bg border border-emperia-border rounded text-[10px] text-emperia-text placeholder:text-emperia-muted/50 focus:outline-none focus:border-emperia-accent"})]}),u.jsx("input",{ref:A,type:"file",accept:"image/png,image/gif,image/bmp",multiple:!0,className:"hidden",onChange:b=>{b.target.files&&M(b.target.files),b.target.value=""}}),u.jsxs("div",{className:"flex items-center gap-0.5 shrink-0",children:[u.jsx("button",{onClick:()=>{var b;return(b=A.current)==null?void 0:b.click()},className:"p-1 rounded hover:bg-emperia-hover text-emperia-muted hover:text-green-400 transition-colors",title:`Add new sprites from PNG (3232 tiles${d>1?`, grouped ${d}${d} with row padding`:""})`,children:u.jsx(ys,{className:"w-3.5 h-3.5"})}),u.jsxs("div",{className:"relative group",children:[u.jsxs("button",{className:"flex items-center gap-0.5 px-1 py-0.5 rounded text-[9px] font-medium text-emperia-muted hover:text-emperia-text hover:bg-emperia-hover transition-colors border border-emperia-border",title:"Import grouping  pads atlas rows between NxN tile groups for visual clarity",children:[u.jsx(t0,{className:"w-3 h-3"}),(B=yf.find(b=>b.value===d))==null?void 0:B.label]}),u.jsx("div",{className:"absolute right-0 top-full mt-0.5 z-50 hidden group-hover:block bg-emperia-panel border border-emperia-border rounded shadow-lg py-0.5 min-w-[90px]",children:yf.map(b=>u.jsxs("button",{onClick:()=>I.setState({importTileSize:b.value}),className:`w-full text-left px-2 py-0.5 text-[10px] transition-colors ${d===b.value?"text-emperia-accent bg-emperia-accent/10":"text-emperia-text hover:bg-emperia-hover"}`,children:[b.label," ",u.jsxs("span",{className:"text-emperia-muted",children:["(",b.desc,")"]})]},b.value))})]})]}),u.jsx("button",{onClick:()=>{const b=I.getState().compactSpriteAtlas();b&&(b.removed===0?alert("Atlas is already compact  no blank or unreferenced sprites found."):(k(new Set),alert(`Compacted atlas: removed ${b.removed} blank/unreferenced sprites.
${b.oldCount}  ${b.newCount} sprites.

All references have been remapped.`)))},className:"p-1 rounded hover:bg-emperia-hover text-emperia-muted hover:text-amber-400 transition-colors shrink-0",title:"Compact atlas  remove blank/unreferenced sprites and remap all references",children:u.jsx(o0,{className:"w-3.5 h-3.5"})})]}),P.size>0&&u.jsxs("div",{className:"px-2 py-1 border-b border-emperia-border bg-emperia-accent/5 flex items-center gap-2",children:[u.jsxs("span",{className:"text-[10px] text-emperia-accent font-medium",children:[P.size," selected"]}),u.jsxs("button",{onClick:X,className:"flex items-center gap-0.5 px-1.5 py-0.5 rounded text-[10px] bg-red-500/10 text-red-400 hover:bg-red-500/20 transition-colors",title:"Delete selected sprites (replaces with blank)",children:[u.jsx(Di,{className:"w-3 h-3"}),"Delete"]}),u.jsxs("button",{onClick:()=>k(new Set),className:"flex items-center gap-0.5 px-1.5 py-0.5 rounded text-[10px] text-emperia-muted hover:text-emperia-text hover:bg-emperia-hover transition-colors ml-auto",title:"Clear selection",children:[u.jsx(Xo,{className:"w-3 h-3"}),"Clear"]})]}),u.jsx("div",{ref:T,onScroll:_e,className:"flex-1 overflow-y-auto",children:u.jsx("div",{style:{height:Ee,position:"relative"},children:u.jsx("div",{style:{position:"absolute",top:Y*Yr,left:0,right:0,display:"grid",gridTemplateColumns:`repeat(${Un}, 1fr)`},children:ve.map(b=>u.jsx(Jg,{spriteId:b,spriteData:i,spriteOverrides:a,isHighlighted:b===_,isAtlasSelected:P.has(b),hasSelectedSlot:m.length>0,onClick:V=>ue(V,b),onContextMenu:V=>{V.preventDefault(),P.size>1&&P.has(b)?X():Z(b)},onDragStart:V=>te(V,b),onDelete:()=>Z(b)},b))})})})]})}):u.jsx("div",{className:"p-3 text-emperia-muted text-xs",children:"Load files to browse sprites"})}const vf=40;function t1(){const o=I(g=>g.selectedThingId),n=I(g=>g.objectData),i=I(g=>g.spriteData),a=I(g=>g.spriteOverrides),l=I(g=>g.selectedSlots),d=I(g=>g.editVersion),m=o!=null?(n==null?void 0:n.things.get(o))??null:null,h=H.useRef(-1),p=H.useMemo(()=>{if(!m)return[];const g=[];return m.frameGroups.forEach((w,_)=>{w.sprites.forEach((E,P)=>{g.push({spriteId:E,group:_,index:P})})}),g},[m,d]),v=H.useCallback((g,w)=>l.some(_=>_.group===g&&_.index===w),[l]),S=H.useCallback((g,w,_,E)=>{const P={group:w,index:_};if(g.ctrlKey||g.metaKey){const N=v(w,_)?l.filter(D=>!(D.group===w&&D.index===_)):[...l,P];I.setState({selectedSlots:N}),h.current=E}else if(g.shiftKey&&h.current>=0){const k=Math.min(h.current,E),N=Math.max(h.current,E),D=p.slice(k,N+1).map(A=>({group:A.group,index:A.index})),T=[...l];for(const A of D)T.some(G=>G.group===A.group&&G.index===A.index)||T.push(A);I.setState({selectedSlots:T})}else v(w,_)&&l.length===1?I.setState({selectedSlots:[]}):I.setState({selectedSlots:[P]}),h.current=E},[l,v,p]);return!m||!i||p.length===0?null:u.jsxs("div",{className:"shrink-0 border-b border-emperia-border",children:[u.jsxs("div",{className:"px-2 py-1.5 flex items-center justify-between",children:[u.jsx("span",{className:"text-[10px] font-medium text-emperia-text uppercase tracking-wider",children:"Object Sprites"}),u.jsx("span",{className:"text-[10px] text-emperia-muted",children:l.length>0?`${l.length} selected`:p.length})]}),u.jsx("div",{className:"overflow-y-auto max-h-48 px-1.5 pb-1.5",children:u.jsx("div",{className:"grid grid-cols-6 gap-0.5",children:p.map(({spriteId:g,group:w,index:_},E)=>{const P=g>0?Yo(i,g,a):null,k=v(w,_),N=a.has(g);return u.jsxs("button",{onClick:D=>S(D,w,_,E),className:`relative flex items-center justify-center rounded border transition-colors
                  ${k?"border-emperia-accent bg-emperia-accent/20":N?"border-amber-500/50 bg-amber-500/10":"border-emperia-border/40 hover:border-emperia-muted"}
                `,style:{width:vf,height:vf},title:`Slot ${E}  Sprite #${g}${k?" (selected  click atlas sprite to assign)":`
Click to select, Ctrl+click multi-select, Shift+click range`}`,children:[P?u.jsx("img",{src:P,alt:"",className:"w-8 h-8",style:{imageRendering:"pixelated"}}):u.jsx("div",{className:"w-8 h-8 bg-emperia-border/20 rounded-sm"}),u.jsx("span",{className:"absolute bottom-0 right-0.5 text-[6px] text-emperia-muted/50 leading-none",children:g})]},`${w}-${_}`)})})}),l.length>0&&u.jsxs("div",{className:"px-2 pb-1.5 flex items-center gap-2",children:[u.jsxs("span",{className:"text-[10px] text-emperia-accent",children:["Click an atlas sprite to assign to ",l.length>1?`${l.length} slots`:"slot"]}),u.jsx("button",{onClick:()=>I.setState({selectedSlots:[]}),className:"text-[10px] text-emperia-muted hover:text-emperia-text ml-auto",children:"Clear"})]})]})}function n1(){const o=I(N=>N.selectedThingId),n=I(N=>N.objectData),i=I(N=>N.activeCategory);I(N=>N.editVersion);const a=I(N=>N.activeLayer),l=I(N=>N.blendLayers),d=I(N=>N.currentFrame),m=I(N=>N.playing),h=I(N=>N.outfitColors),p=I(N=>N.showColorPicker),v=o!=null?(n==null?void 0:n.things.get(o))??null:null,S=i==="outfit",g=(v==null?void 0:v.frameGroups[0])??null,w=g?g.layers>1:!1,_=g?g.animationLength>1:!1,E=S||((v==null?void 0:v.flags.hasDisplacement)??!1),P=S&&l&&((g==null?void 0:g.layers)??0)>=2,k=H.useCallback((N,D)=>{if(!v||!g)return;g[N]=D;const T=g.width*g.height*g.layers*g.patternX*g.patternY*g.patternZ*g.animationLength;if(g.sprites.length<T)for(;g.sprites.length<T;)g.sprites.push(0);else g.sprites.length>T&&(g.sprites.length=T);for(;g.animationLengths.length<g.animationLength;)g.animationLengths.push({min:100,max:100});g.animationLengths.length>g.animationLength&&(g.animationLengths.length=g.animationLength),v.rawBytes=void 0,zn();const A=I.getState(),G=new Set(A.dirtyIds);G.add(v.id),I.setState({dirty:!0,dirtyIds:G,editVersion:A.editVersion+1})},[v,g]);return!v||!w&&!E&&!_?null:u.jsxs("div",{className:"border-t border-emperia-border text-[10px] space-y-1",children:[w&&g&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"px-2 py-1 bg-purple-950/30 border-b border-emperia-border/40",children:u.jsx("span",{className:"text-[9px] font-semibold uppercase tracking-wider text-purple-400 opacity-80",children:"Layer"})}),u.jsxs("div",{className:"px-3 py-2 flex items-center gap-1",children:[u.jsx("span",{className:"text-emperia-muted shrink-0",children:"Layer:"}),u.jsx(pn,{onClick:()=>I.setState({activeLayer:Math.max(0,a-1),blendLayers:!1}),disabled:l,children:""}),u.jsx("span",{className:`font-mono w-8 text-center text-[9px] ${l?"text-emperia-muted":"text-emperia-text"}`,children:l?"All":`${a+1}/${g.layers}`}),u.jsx(pn,{onClick:()=>I.setState({activeLayer:Math.min(g.layers-1,a+1),blendLayers:!1}),disabled:l,children:""}),u.jsxs("label",{className:"flex items-center gap-0.5 cursor-pointer ml-1",children:[u.jsx("input",{type:"checkbox",checked:l,onChange:()=>I.setState({blendLayers:!l}),className:"w-2.5 h-2.5 accent-emperia-accent"}),u.jsx("span",{className:"text-emperia-muted text-[9px]",children:"Blend"})]})]})]}),_&&g&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"px-2 py-1 bg-emerald-950/30 border-y border-emperia-border/40",children:u.jsx("span",{className:"text-[9px] font-semibold uppercase tracking-wider text-emerald-400 opacity-80",children:"Animation"})}),u.jsxs("div",{className:"px-3 py-2.5 space-y-2.5",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"text-emperia-muted shrink-0",children:"Frame:"}),u.jsx(pn,{onClick:()=>{I.setState({currentFrame:(d-1+g.animationLength)%g.animationLength,playing:!1})},children:""}),u.jsxs("span",{className:"text-emperia-text font-mono w-10 text-center text-[9px]",children:[d+1,"/",g.animationLength]}),u.jsx(pn,{onClick:()=>{I.setState({currentFrame:(d+1)%g.animationLength,playing:!1})},children:""}),u.jsx("button",{onClick:()=>I.setState({playing:!m}),className:`ml-1 px-1.5 py-0.5 rounded text-[9px] transition-colors ${m?"bg-emperia-accent text-white":"bg-emperia-surface border border-emperia-border text-emperia-muted hover:text-emperia-text"}`,children:m?"Stop":"Play"})]}),u.jsxs("div",{className:"bg-emperia-surface/40 rounded px-2.5 py-2 space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"text-emperia-muted shrink-0",children:"Mode:"}),u.jsxs("select",{value:g.asynchronous,onChange:N=>k("asynchronous",Number(N.target.value)),className:"flex-1 px-1 py-0.5 bg-emperia-surface border border-emperia-border rounded text-[9px] text-emperia-text outline-none focus:border-emperia-accent",children:[u.jsx("option",{value:0,children:"Sync"}),u.jsx("option",{value:1,children:"Async"})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-x-3 gap-y-2",children:[u.jsx(tn,{label:"Loop count",value:g.nLoop,min:0,max:255,onChange:N=>k("nLoop",N)}),u.jsx(tn,{label:"Start frame",value:g.start,min:0,max:g.animationLength-1,onChange:N=>k("start",N)})]})]}),g.animationLengths[d]&&u.jsxs("div",{className:"bg-emerald-950/20 border border-emerald-500/10 rounded px-2.5 py-2 space-y-1.5",children:[u.jsxs("div",{className:"text-[8px] text-emerald-400/70 font-medium",children:["Frame ",d+1," duration (ms)"]}),u.jsxs("div",{className:"grid grid-cols-2 gap-x-3 gap-y-2",children:[u.jsx(tn,{label:"Min",value:g.animationLengths[d].min,min:0,max:65535,onChange:N=>{g.animationLengths[d].min=N,v.rawBytes=void 0;const D=I.getState(),T=new Set(D.dirtyIds);T.add(v.id),I.setState({dirty:!0,dirtyIds:T,editVersion:D.editVersion+1})}}),u.jsx(tn,{label:"Max",value:g.animationLengths[d].max,min:0,max:65535,onChange:N=>{g.animationLengths[d].max=N,v.rawBytes=void 0;const D=I.getState(),T=new Set(D.dirtyIds);T.add(v.id),I.setState({dirty:!0,dirtyIds:T,editVersion:D.editVersion+1})}})]})]})]})]}),E&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"px-2 py-1 bg-emperia-surface/60 border-y border-emperia-border/40",children:u.jsx("span",{className:"text-[9px] font-semibold uppercase tracking-wider text-emperia-muted",children:"Offset"})}),u.jsxs("div",{className:"px-3 py-2 grid grid-cols-2 gap-x-3 gap-y-1.5",children:[u.jsx(tn,{label:"X",value:v.flags.displacementX??0,min:-512,max:512,onChange:N=>{I.getState().updateThingFlags(v.id,{...v.flags,hasDisplacement:!0,displacementX:N})}}),u.jsx(tn,{label:"Y",value:v.flags.displacementY??0,min:-512,max:512,onChange:N=>{I.getState().updateThingFlags(v.id,{...v.flags,hasDisplacement:!0,displacementY:N})}})]})]}),P&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"px-2 py-1 bg-emperia-surface/60 border-y border-emperia-border/40",children:u.jsx("span",{className:"text-[9px] font-semibold uppercase tracking-wider text-emperia-muted",children:"Colors"})}),u.jsxs("div",{className:"px-3 py-2",children:[u.jsx("div",{className:"grid grid-cols-2 gap-x-3 gap-y-1.5",children:["head","body","legs","feet"].map(N=>u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{onClick:()=>I.setState({showColorPicker:p===N?null:N}),className:"w-4 h-4 rounded border border-emperia-border shrink-0",style:{backgroundColor:cf(h[N])},title:`${N}: ${h[N]}`}),u.jsx("span",{className:"text-emperia-muted capitalize text-[9px]",children:N}),u.jsx(pn,{onClick:()=>I.setState({outfitColors:{...h,[N]:Math.max(0,h[N]-1)}}),children:""}),u.jsx("span",{className:"text-emperia-text font-mono w-5 text-center text-[9px]",children:h[N]}),u.jsx(pn,{onClick:()=>I.setState({outfitColors:{...h,[N]:Math.min(Ni-1,h[N]+1)}}),children:""})]},N))}),p&&u.jsx("div",{className:"mt-1 p-1 bg-emperia-surface border border-emperia-border rounded grid gap-px",style:{gridTemplateColumns:"repeat(19, 14px)"},children:Qr.map((N,D)=>u.jsx("button",{onClick:()=>{I.setState({outfitColors:{...h,[p]:D},showColorPicker:null})},className:`w-3.5 h-3.5 rounded-sm border ${h[p]===D?"border-white":"border-transparent"}`,style:{backgroundColor:cf(D)},title:`${D}`},D))})]})]})]})}const r1=[{key:"name",label:"Name",type:"string"},{key:"article",label:"Article",type:"string",placeholder:"a / an"},{key:"description",label:"Description",type:"string"},{key:"type",label:"Type",type:"select",options:["","bed","container","corpse","depot","door","fluidContainer","key","magicfield","mailbox","readable","rune","splash","teleport","trashholder","window"]}],i1=[{key:"weaponType",label:"Weapon Type",type:"select",options:["","sword","axe","club","distance","shield","wand","orb","magical"]},{key:"slotType",label:"Slot Type",type:"select",options:["","left-hand","right-hand","hand","two-handed","head","body","legs","feet","ring","necklace","backpack","belt","ammo","quiver"]},{key:"ammoType",label:"Ammo Type",type:"string"},{key:"shootType",label:"Shoot Type",type:"string"},{key:"damageElement",label:"Damage Element",type:"select",options:["","fire","ice","energy","earth","death","holy","arcane","wind"]}],s1=[{key:"physicalAttack",label:"Physical Attack",type:"number"},{key:"magicalAttack",label:"Magical Attack",type:"number"},{key:"physicalDefense",label:"Physical Defense",type:"number"},{key:"magicalDefense",label:"Magical Defense",type:"number"},{key:"armor",label:"Armor",type:"number"},{key:"extradef",label:"Extra Def",type:"number"},{key:"hitChance",label:"Hit Chance",type:"number"},{key:"maxHitChance",label:"Max Hit Chance",type:"number"},{key:"range",label:"Range",type:"number"}],o1=[{key:"weight",label:"Weight",type:"number"},{key:"speed",label:"Speed",type:"number"},{key:"friction",label:"Friction",type:"number"},{key:"floorchange",label:"Floor Change",type:"select",options:["","down","north","south","east","west"]}],a1=[{key:"level",label:"Level",type:"number"},{key:"expertise",label:"Expertise",type:"number"}],l1=[{key:"containerSize",label:"Container Size",type:"number"},{key:"containerSizePotions",label:"Container Size (Potions)",type:"number"},{key:"weightReduction",label:"Weight Reduction",type:"number"}],c1=[{key:"charges",label:"Charges",type:"number"},{key:"duration",label:"Duration",type:"number"},{key:"decayTo",label:"Decay To (Item ID)",type:"number"},{key:"destroyTo",label:"Destroy To (Item ID)",type:"number"},{key:"rotateTo",label:"Rotate To (Item ID)",type:"number"},{key:"transformEquipTo",label:"Transform Equip To",type:"number"},{key:"transformDeEquipTo",label:"Transform DeEquip To",type:"number"}],u1=[{key:"fluidSource",label:"Fluid Source",type:"string"},{key:"field",label:"Field",type:"string"},{key:"readable",label:"Readable",type:"boolean"},{key:"writeable",label:"Writeable",type:"boolean"},{key:"maxTextLen",label:"Max Text Length",type:"number"}],d1=[{key:"healthGain",label:"Health Gain",type:"number"},{key:"healthTicks",label:"Health Ticks",type:"number"},{key:"manaGain",label:"Mana Gain",type:"number"},{key:"manaTicks",label:"Mana Ticks",type:"number"}],f1=[{key:"skillSword",label:"Skill Sword",type:"number"},{key:"skillAxe",label:"Skill Axe",type:"number"},{key:"skillClub",label:"Skill Club",type:"number"},{key:"skillDist",label:"Skill Distance",type:"number"},{key:"skillShield",label:"Skill Shield",type:"number"},{key:"skillFist",label:"Skill Fist",type:"number"},{key:"magiclevelpoints",label:"Magic Level Points",type:"number"}],h1=[{key:"absorbPercentPhysical",label:"Absorb Physical %",type:"number"},{key:"absorbPercentFire",label:"Absorb Fire %",type:"number"},{key:"absorbPercentIce",label:"Absorb Ice %",type:"number"},{key:"absorbPercentEnergy",label:"Absorb Energy %",type:"number"},{key:"absorbPercentEarth",label:"Absorb Earth %",type:"number"},{key:"absorbPercentDeath",label:"Absorb Death %",type:"number"},{key:"absorbPercentHoly",label:"Absorb Holy %",type:"number"}],p1=[{key:"bonusStrength",label:"Strength",type:"number"},{key:"bonusDexterity",label:"Dexterity",type:"number"},{key:"bonusEndurance",label:"Endurance",type:"number"},{key:"bonusAgility",label:"Agility",type:"number"},{key:"bonusIntelligence",label:"Intelligence",type:"number"},{key:"bonusWisdom",label:"Wisdom",type:"number"},{key:"bonusFocus",label:"Focus",type:"number"},{key:"bonusSpirit",label:"Spirit",type:"number"}],m1=[{key:"bonusCritChance",label:"Crit Chance",type:"number"},{key:"bonusCritDamage",label:"Crit Damage",type:"number"},{key:"bonusDodge",label:"Dodge",type:"number"},{key:"bonusCDR",label:"CDR",type:"number"},{key:"bonusHealingPower",label:"Healing Power",type:"number"},{key:"bonusAttackSpeed",label:"Attack Speed",type:"number"},{key:"bonusPhysicalHit",label:"Physical Hit",type:"number"},{key:"bonusSpellHit",label:"Spell Hit",type:"number"},{key:"bonusMaxHealth",label:"Max Health",type:"number"},{key:"bonusMaxMana",label:"Max Mana",type:"number"},{key:"bonusCapacity",label:"Capacity",type:"number"},{key:"bonusHealthRegen",label:"Health Regen",type:"number"},{key:"bonusManaRegen",label:"Mana Regen",type:"number"},{key:"bonusMaxStamina",label:"Max Stamina",type:"number"},{key:"bonusStaminaRegen",label:"Stamina Regen",type:"number"},{key:"bonusStatusResist",label:"Status Resist",type:"number"}],g1=[{value:0,label:"0  Normal"},{value:1,label:"1  Ground"},{value:2,label:"2  Container"},{value:3,label:"3  Weapon"},{value:4,label:"4  Ammunition"},{value:5,label:"5  Armor"},{value:6,label:"6  Charges"},{value:7,label:"7  Teleport"},{value:9,label:"9  Write"},{value:10,label:"10  Write Once"},{value:11,label:"11  Fluid (Splash)"},{value:12,label:"12  Fluid Container"}];function x1(){const o=I(E=>E.selectedThingId),n=I(E=>E.objectData),i=I(E=>E.activeCategory),a=I(E=>E.itemDefinitions),l=I(E=>E.clientToServerIds),d=I(E=>E.updateItemDefinition);I(E=>E.editVersion);const m=o!=null?(n==null?void 0:n.things.get(o))??null:null,h=o!=null?l.get(o):void 0,p=h!=null?a.get(h)??null:null,v=H.useMemo(()=>(p==null?void 0:p.properties)??{},[p]),S=H.useCallback((E,P)=>{if(o==null)return;const k=l.get(o),N=k!=null?a.get(k):void 0,D=N!=null&&N.properties?{...N.properties}:{};P===void 0||P===""||P===!1?delete D[E]:D[E]=P,d(o,{properties:Object.keys(D).length>0?D:null})},[o,a,d]);if(i!=="item")return u.jsx("div",{className:"flex items-center justify-center h-full text-emperia-muted text-sm p-4",children:"Server properties are only available for items."});if(!m)return u.jsx("div",{className:"flex items-center justify-center h-full text-emperia-muted text-sm p-4",children:"No item selected"});const g=(p==null?void 0:p.flags)??0,w=(p==null?void 0:p.group)??0;p==null||p.serverId;const _=Rm.filter((E,P)=>(g&1<<P)!==0).map(E=>E.replace("FLAG_",""));return u.jsxs("div",{className:"p-3 text-xs space-y-3 overflow-y-auto",children:[u.jsx(wh,{title:"OTB Flags & Group",children:u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"w-16 text-emperia-muted shrink-0",children:"Group"}),u.jsx("select",{value:w,onChange:E=>{const P=parseInt(E.target.value,10);o!=null&&d(o,{group:P})},className:"flex-1 bg-emperia-bg border border-emperia-border rounded px-2 py-0.5 text-emperia-text text-xs",children:g1.map(E=>u.jsx("option",{value:E.value,children:E.label},E.value))})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"w-16 text-emperia-muted shrink-0",children:"Flags"}),u.jsx("span",{className:"text-emperia-text font-mono text-[10px]",children:g})]}),u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx("span",{className:"w-16 text-emperia-muted shrink-0",children:"Active"}),u.jsx("span",{className:"text-emperia-text font-mono text-[10px] leading-relaxed",children:_.length>0?_.join(", "):u.jsx("span",{className:"text-emperia-muted/50",children:"none"})})]}),u.jsx("p",{className:"text-[9px] text-emperia-muted/50 mt-1",children:"Groups 1 (Ground), 2 (Container), 11 (Splash), 12 (Fluid) are used by the server for gameplay logic."})]})}),u.jsx(an,{title:"Identity",fields:r1,props:v,setProperty:S}),u.jsx(an,{title:"Equipment",fields:i1,props:v,setProperty:S}),u.jsx(an,{title:"Combat Stats",fields:s1,props:v,setProperty:S}),u.jsx(an,{title:"Weight / Speed",fields:o1,props:v,setProperty:S}),u.jsx(an,{title:"Requirements",fields:a1,props:v,setProperty:S}),u.jsx(an,{title:"Container",fields:l1,props:v,setProperty:S}),u.jsx(an,{title:"Decay / Transform",fields:c1,props:v,setProperty:S}),u.jsx(an,{title:"Special",fields:u1,props:v,setProperty:S}),u.jsx(an,{title:"Regeneration",fields:d1,props:v,setProperty:S}),u.jsx(an,{title:"Skill Bonuses",fields:f1,props:v,setProperty:S}),u.jsx(an,{title:"Absorb %",fields:h1,props:v,setProperty:S}),u.jsx(an,{title:"Stat Bonuses",fields:p1,props:v,setProperty:S}),u.jsx(an,{title:"Combat Bonuses",fields:m1,props:v,setProperty:S})]})}function wh({title:o,children:n}){return u.jsxs("div",{children:[u.jsx("h3",{className:"text-[10px] font-semibold text-emperia-muted uppercase tracking-wider mb-1",children:o}),n]})}function an({title:o,fields:n,props:i,setProperty:a}){return!n.some(m=>i[m.key]!==void 0&&i[m.key]!=="")&&!(o==="Identity")?u.jsxs("details",{children:[u.jsx("summary",{className:"text-[10px] font-semibold text-emperia-muted uppercase tracking-wider cursor-pointer hover:text-emperia-text select-none",children:o}),u.jsx("div",{className:"mt-1 space-y-1",children:n.map(m=>u.jsx(wf,{field:m,value:i[m.key],onChange:h=>a(m.key,h)},m.key))})]}):u.jsx(wh,{title:o,children:u.jsx("div",{className:"space-y-1",children:n.map(m=>u.jsx(wf,{field:m,value:i[m.key],onChange:h=>a(m.key,h)},m.key))})})}function wf({field:o,value:n,onChange:i}){const{label:a,type:l,options:d,placeholder:m}=o;return l==="boolean"?u.jsxs("label",{className:"flex items-center gap-2 py-[2px] px-1 rounded hover:bg-emperia-hover cursor-pointer select-none",children:[u.jsx("input",{type:"checkbox",checked:!!n,onChange:()=>i(!n),className:"accent-emperia-accent"}),u.jsx("span",{className:"text-emperia-text",children:a})]}):l==="select"?u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"w-28 text-emperia-muted shrink-0",children:a}),u.jsx("select",{value:n!=null?String(n):"",onChange:h=>i(h.target.value||void 0),className:"flex-1 bg-emperia-bg border border-emperia-border rounded px-2 py-0.5 text-emperia-text text-xs",children:d.map(h=>u.jsx("option",{value:h,children:h||""},h))})]}):l==="number"?u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"w-28 text-emperia-muted shrink-0",children:a}),u.jsx("input",{type:"number",value:n!=null?String(n):"",placeholder:m,onChange:h=>{const p=h.target.value;if(p===""){i(void 0);return}const v=parseFloat(p);isNaN(v)||i(v)},className:"flex-1 bg-emperia-bg border border-emperia-border rounded px-2 py-0.5 text-emperia-text text-xs w-0"})]}):u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"w-28 text-emperia-muted shrink-0",children:a}),u.jsx("input",{type:"text",value:n!=null?String(n):"",placeholder:m,onChange:h=>i(h.target.value||void 0),className:"flex-1 bg-emperia-bg border border-emperia-border rounded px-2 py-0.5 text-emperia-text text-xs w-0"})]})}const y1=[{value:"all",label:"All"},{value:"head",label:"Head"},{value:"body",label:"Body"},{value:"legs",label:"Legs"},{value:"feet",label:"Feet"},{value:"left-hand",label:"Left Hand"},{value:"right-hand",label:"Right Hand"},{value:"backpack",label:"Backpack"},{value:"belt",label:"Belt"}];function v1(o,n){const i=o.name.toLowerCase();return i.includes("left-hand")||i.includes("lefthand")||i.includes("left hand")?"left-hand":i.includes("right-hand")||i.includes("righthand")||i.includes("right hand")?"right-hand":n==="head"||i.includes("helmet")||i.includes("hat")||i.includes("crown helmet")?"head":n==="body"||i.includes("armor")||i.includes("armour")?"body":n==="legs"||i.includes(" legs")||i.includes(" leg")?"legs":n==="feet"||i.includes("boots")||i.includes("boot")||i.includes("shoes")?"feet":n==="backpack"||i.includes("backpack")||i.includes("cape")?"backpack":i.includes("belt")?"belt":i.includes("shield")||i.includes("orb")?"right-hand":i.includes("bow")||i.includes("crossbow")||i.includes("sword")||i.includes("axe")||i.includes("club")||i.includes("wand")?"left-hand":null}function bf(o,n,i,a,l,d,m,h){return(((((n*o.patternZ+l)*o.patternY+a)*o.patternX+i)*o.layers+d)*o.height+h)*o.width+m}const nc=new Map;function w1(){nc.clear()}function bh(o,n,i,a,l=2){const d=`${a}:${l}`,m=nc.get(d);if(m)return m;const h=o.things.get(a);if(!h)return null;const p=h.frameGroups[0];if(!p||p.sprites.length===0)return null;const v=p.width*32,S=p.height*32,g=document.createElement("canvas");g.width=v,g.height=S;const w=g.getContext("2d");w.clearRect(0,0,v,S);const _=Math.min(l,p.patternX-1),E=p.layers>=2,P={head:0,body:0,legs:0,feet:0};for(let N=0;N<p.height;N++)for(let D=0;D<p.width;D++){const T=bf(p,0,_,0,0,0,D,N);if(T>=p.sprites.length)continue;const A=p.sprites[T];if(A<=0)continue;const G=i.get(A)??mn(n,A);if(!G)continue;const M=new ImageData(new Uint8ClampedArray(G.data),32,32);if(E){const he=bf(p,0,_,0,0,1,D,N);if(he<p.sprites.length){const Se=p.sprites[he];if(Se>0){const Ee=i.get(Se)??mn(n,Se);Ee&&zo(M,Ee,P)}}}const Z=(p.width-1-D)*32,de=(p.height-1-N)*32;if(E){const he=document.createElement("canvas");he.width=32,he.height=32,he.getContext("2d").putImageData(M,0,0),w.drawImage(he,Z,de)}else w.putImageData(M,Z,de)}const k=g.toDataURL();return nc.set(d,k),k}function b1(o,n){return o.itemCount+n}function uc({onSelect:o,onClose:n}){const i=I(_=>_.objectData),a=I(_=>_.spriteData),l=I(_=>_.spriteOverrides),d=I(_=>_.getCategoryRange),[m,h]=H.useState(""),[p,v]=H.useState(2),S=H.useRef(null),g=d("outfit"),w=H.useMemo(()=>{if(!i||!g)return[];const _=m.trim().toLowerCase(),E=[];for(let P=g.start;P<=g.end;P++){if(!i.things.get(P))continue;const N=Hn(i,P);_&&!N.toString().includes(_)||E.push({id:P,displayId:N})}return E},[i,g,m]);return H.useEffect(()=>{const _=E=>{S.current&&!S.current.contains(E.target)&&n()};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[n]),u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",children:u.jsxs("div",{ref:S,className:"bg-emperia-surface border border-emperia-border rounded-lg shadow-2xl w-[520px] max-h-[80vh] flex flex-col",children:[u.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b border-emperia-border shrink-0",children:[u.jsx("h3",{className:"text-sm font-semibold text-emperia-text flex-1",children:"Select Outfit Sprite"}),u.jsx("div",{className:"flex items-center gap-1 text-[10px] text-emperia-muted",children:["N","E","S","W"].map((_,E)=>u.jsx("button",{onClick:()=>v(E),className:`px-1.5 py-0.5 rounded ${p===E?"bg-emperia-accent/30 text-emperia-accent":"hover:bg-emperia-hover"}`,children:_},_))}),u.jsx("button",{onClick:n,className:"p-1 rounded hover:bg-emperia-hover text-emperia-muted hover:text-emperia-text",children:u.jsx(Xo,{className:"w-4 h-4"})})]}),u.jsx("div",{className:"px-3 py-1.5 border-b border-emperia-border shrink-0",children:u.jsxs("div",{className:"relative",children:[u.jsx(Ii,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3 h-3 text-emperia-muted"}),u.jsx("input",{type:"text",value:m,onChange:_=>h(_.target.value),placeholder:"Search outfit ID...",className:"w-full pl-7 pr-2 py-1 bg-emperia-bg border border-emperia-border rounded text-xs text-emperia-text",autoFocus:!0})]})}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-2",children:[u.jsx("div",{className:"grid grid-cols-8 gap-1",children:w.map(({id:_,displayId:E})=>{if(!i||!a)return null;const P=bh(i,a,l,_,p);return u.jsxs("button",{onClick:()=>o(E),className:"flex flex-col items-center gap-0.5 p-1 rounded hover:bg-emperia-hover border border-transparent hover:border-emperia-accent/40 transition-colors",title:`Outfit #${E}`,children:[u.jsx("div",{className:"w-10 h-10 checkerboard rounded flex items-center justify-center overflow-hidden",children:P?u.jsx("img",{src:P,alt:"",className:"pixelated max-w-full max-h-full",style:{imageRendering:"pixelated"},draggable:!1}):u.jsx("div",{className:"w-10 h-10 bg-emperia-bg/50 rounded"})}),u.jsx("span",{className:"text-[9px] text-emperia-muted",children:E})]},_)})}),w.length===0&&u.jsx("p",{className:"text-center text-emperia-muted text-xs py-8",children:"No outfits found."})]})]})})}function Ro({outfitDisplayId:o,size:n=32,direction:i=2}){const a=I(v=>v.objectData),l=I(v=>v.spriteData),d=I(v=>v.spriteOverrides),m=I(v=>v.editVersion);if(H.useEffect(()=>{w1()},[m]),!a||!l||o<=0)return u.jsx("div",{className:"checkerboard rounded border border-emperia-border/50 flex items-center justify-center text-emperia-muted/30 text-[9px]",style:{width:n,height:n},children:""});const h=b1(a,o),p=bh(a,l,d,h,i);return u.jsx("div",{className:"checkerboard rounded border border-emperia-border/50 overflow-hidden flex items-center justify-center",style:{width:n,height:n},children:p?u.jsx("img",{src:p,alt:`outfit#${o}`,className:"pixelated max-w-full max-h-full",style:{imageRendering:"pixelated"},draggable:!1}):u.jsx("div",{className:"flex items-center justify-center text-emperia-muted/30 text-[9px]",style:{width:n,height:n},children:"?"})})}function kh({itemId:o,size:n=28}){var w;const i=I(_=>_.objectData),a=I(_=>_.spriteData),l=I(_=>_.spriteOverrides),d=I(_=>_.itemDefinitions);if(I(_=>_.editVersion),!i||!a||o<=0)return u.jsx("div",{className:"checkerboard rounded border border-emperia-border/50 flex items-center justify-center text-emperia-muted/30 text-[9px]",style:{width:n,height:n},children:""});const m=d.get(o),h=(m==null?void 0:m.id)??o,p=i.things.get(h),v=((w=p==null?void 0:p.frameGroups[0])==null?void 0:w.sprites[0])??0,S=v>0?Yo(a,v,l):null,g=()=>{if(!p)return;const{setCenterTab:_,setSelectedThingId:E}=I.getState();I.getState().activeCategory!=="item"&&I.setState({activeCategory:"item",searchQuery:"",filterGroup:-1}),E(h),_("texture")};return u.jsx("button",{onClick:g,className:"checkerboard rounded border border-emperia-border/50 overflow-hidden flex items-center justify-center hover:border-emperia-accent/60 transition-colors cursor-pointer shrink-0",style:{width:n,height:n},title:`Go to item #${h}`,children:S?u.jsx("img",{src:S,alt:`item#${o}`,className:"pixelated",style:{width:n,height:n,imageRendering:"pixelated"},draggable:!1}):u.jsx("div",{className:"flex items-center justify-center text-emperia-muted/30 text-[9px]",style:{width:n,height:n},children:"?"})})}function k1({onAdd:o,onCancel:n}){const[i,a]=H.useState(""),[l,d]=H.useState(""),[m,h]=H.useState(""),[p,v]=H.useState(!1),S=()=>{const g=parseInt(l,10),w=parseInt(m,10);!i.trim()||isNaN(g)||isNaN(w)||o({name:i.trim(),id:g,sprite_id:w})};return u.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-emperia-accent/5 border-t border-emperia-border",children:[u.jsx("input",{type:"text",value:i,onChange:g=>a(g.target.value),placeholder:"Name (e.g. Left-Hand (katana))",className:"flex-1 bg-emperia-bg border border-emperia-border rounded px-2 py-1 text-xs text-emperia-text min-w-0"}),u.jsx("input",{type:"number",value:l,onChange:g=>d(g.target.value),placeholder:"Item ID",className:"w-20 bg-emperia-bg border border-emperia-border rounded px-2 py-1 text-xs text-emperia-text"}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("input",{type:"number",value:m,onChange:g=>h(g.target.value),placeholder:"Sprite ID",className:"w-20 bg-emperia-bg border border-emperia-border rounded px-2 py-1 text-xs text-emperia-text"}),u.jsx("button",{onClick:()=>v(!0),className:"p-1 rounded hover:bg-emperia-hover text-emperia-muted hover:text-emperia-accent text-[10px] border border-emperia-border",title:"Pick from outfit sprites",children:"Pick"})]}),u.jsx("button",{onClick:S,className:"px-2 py-1 rounded bg-emperia-accent/20 text-emperia-accent text-xs font-medium hover:bg-emperia-accent/30",children:"Add"}),u.jsx("button",{onClick:n,className:"p-1 rounded hover:bg-emperia-hover text-emperia-muted",children:u.jsx(Xo,{className:"w-3.5 h-3.5"})}),p&&u.jsx(uc,{onSelect:g=>{h(g.toString()),v(!1)},onClose:()=>v(!1)})]})}function S1({entry:o,index:n,onUpdate:i,onRemove:a}){var k;const[l,d]=H.useState(!1),[m,h]=H.useState(!1),[p,v]=H.useState(o.name),S=I(N=>N.itemDefinitions),w=I(N=>N.clientToServerIds).get(o.id),_=w!=null?S.get(w):void 0,E=(k=_==null?void 0:_.properties)==null?void 0:k.name,P=()=>{h(!1),p.trim()!==o.name&&i(n,{...o,name:p.trim()})};return u.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 hover:bg-emperia-hover/50 group border-b border-emperia-border/30",children:[u.jsx(kh,{itemId:o.id,size:40}),u.jsx(Ro,{outfitDisplayId:o.sprite_id,size:40}),u.jsxs("div",{className:"flex-1 min-w-0",children:[m?u.jsx("input",{type:"text",value:p,onChange:N=>v(N.target.value),onBlur:P,onKeyDown:N=>{N.key==="Enter"&&P()},className:"w-full bg-emperia-bg border border-emperia-border rounded px-1.5 py-0.5 text-xs text-emperia-text",autoFocus:!0}):u.jsx("button",{onClick:()=>{h(!0),v(o.name)},className:"text-xs text-emperia-text truncate block text-left w-full hover:underline",title:o.name,children:o.name}),E&&u.jsx("span",{className:"text-[9px] text-emperia-muted/60 truncate block",children:E})]}),u.jsx("span",{className:"text-[10px] text-amber-400 font-mono w-12 text-right shrink-0",title:"Client Item ID",children:o.id}),u.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[u.jsx("span",{className:"text-[10px] text-cyan-400 font-mono w-12 text-right",title:"Outfit Sprite ID",children:o.sprite_id}),u.jsx("button",{onClick:()=>d(!0),className:"px-1.5 py-0.5 rounded text-[10px] bg-emperia-accent/10 text-emperia-accent hover:bg-emperia-accent/20 opacity-0 group-hover:opacity-100 transition-opacity",children:"Change"})]}),u.jsx("button",{onClick:()=>a(n),className:"p-0.5 rounded text-red-400/40 hover:text-red-400 hover:bg-red-400/10 opacity-0 group-hover:opacity-100 transition-opacity",title:"Remove entry",children:u.jsx(Di,{className:"w-3 h-3"})}),l&&u.jsx(uc,{onSelect:N=>{i(n,{...o,sprite_id:N}),d(!1)},onClose:()=>d(!1)})]})}function _1({group:o,onUpdate:n,onRemove:i}){var S;const[a,l]=H.useState(null),d=I(g=>g.itemDefinitions),h=I(g=>g.clientToServerIds).get(o.itemId),p=h!=null?d.get(h):void 0,v=(S=p==null?void 0:p.properties)==null?void 0:S.name;return u.jsxs("div",{className:"px-3 py-2 hover:bg-emperia-hover/50 border-b border-emperia-border/30 group",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[u.jsx(kh,{itemId:o.itemId,size:32}),u.jsx("span",{className:"text-xs text-emperia-text font-medium truncate flex-1",children:o.baseName}),v&&u.jsx("span",{className:"text-[9px] text-emperia-muted/60",children:v}),u.jsx("span",{className:"text-[10px] text-amber-400 font-mono",title:"Item ID",children:o.itemId})]}),u.jsxs("div",{className:"flex items-center gap-4 pl-2",children:[u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx("span",{className:"text-[9px] text-emperia-muted w-8",children:"Left"}),o.leftEntry?u.jsxs(u.Fragment,{children:[u.jsx(Ro,{outfitDisplayId:o.leftEntry.entry.sprite_id,size:36}),u.jsx("span",{className:"text-[10px] text-cyan-400 font-mono",children:o.leftEntry.entry.sprite_id}),u.jsx("button",{onClick:()=>l("left"),className:"px-1 py-0.5 rounded text-[9px] bg-emperia-accent/10 text-emperia-accent hover:bg-emperia-accent/20 opacity-0 group-hover:opacity-100 transition-opacity",children:"Change"}),u.jsx("button",{onClick:()=>i(o.leftEntry.index),className:"p-0.5 rounded text-red-400/40 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:u.jsx(Di,{className:"w-2.5 h-2.5"})})]}):u.jsx("button",{onClick:()=>l("left"),className:"text-[9px] text-emperia-muted/50 hover:text-emperia-accent underline",children:"Assign"})]}),u.jsx("div",{className:"w-px h-6 bg-emperia-border/40"}),u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx("span",{className:"text-[9px] text-emperia-muted w-8",children:"Right"}),o.rightEntry?u.jsxs(u.Fragment,{children:[u.jsx(Ro,{outfitDisplayId:o.rightEntry.entry.sprite_id,size:36}),u.jsx("span",{className:"text-[10px] text-cyan-400 font-mono",children:o.rightEntry.entry.sprite_id}),u.jsx("button",{onClick:()=>l("right"),className:"px-1 py-0.5 rounded text-[9px] bg-emperia-accent/10 text-emperia-accent hover:bg-emperia-accent/20 opacity-0 group-hover:opacity-100 transition-opacity",children:"Change"}),u.jsx("button",{onClick:()=>i(o.rightEntry.index),className:"p-0.5 rounded text-red-400/40 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:u.jsx(Di,{className:"w-2.5 h-2.5"})})]}):u.jsx("button",{onClick:()=>l("right"),className:"text-[9px] text-emperia-muted/50 hover:text-emperia-accent underline",children:"Assign"})]})]}),o.otherEntries.map(({entry:g,index:w})=>u.jsxs("div",{className:"flex items-center gap-2 pl-2 mt-1",children:[u.jsx("span",{className:"text-[9px] text-emperia-muted w-8 truncate",children:g.name}),u.jsx(Ro,{outfitDisplayId:g.sprite_id,size:32}),u.jsx("span",{className:"text-[10px] text-cyan-400 font-mono",children:g.sprite_id})]},w)),a&&u.jsx(uc,{onSelect:g=>{const w=I.getState().addSpriteMapEntry,_=I.getState().updateSpriteMapEntry,E=a==="left"?"Left-Hand":"Right-Hand";a==="left"&&o.leftEntry?_(o.leftEntry.index,{...o.leftEntry.entry,sprite_id:g}):a==="right"&&o.rightEntry?_(o.rightEntry.index,{...o.rightEntry.entry,sprite_id:g}):w({name:`${E} (${o.baseName})`,id:o.itemId,sprite_id:g}),l(null)},onClose:()=>l(null)})]})}function C1(){const o=I(D=>D.spriteMapEntries),n=I(D=>D.spriteMapLoaded),i=I(D=>D.itemDefinitions),a=I(D=>D.clientToServerIds),l=I(D=>D.updateSpriteMapEntry),d=I(D=>D.addSpriteMapEntry),m=I(D=>D.removeSpriteMapEntry);I(D=>D.editVersion);const[h,p]=H.useState("all"),[v,S]=H.useState(""),[g,w]=H.useState(!1),[_,E]=H.useState("list"),P=H.useCallback(D=>{var G;const T=a.get(D),A=T!=null?i.get(T):void 0;return(G=A==null?void 0:A.properties)==null?void 0:G.slotType},[a,i]),k=H.useMemo(()=>{const D=v.trim().toLowerCase();return o.map((T,A)=>({entry:T,index:A})).filter(({entry:T})=>{if(h!=="all"&&v1(T,P(T.id))!==h)return!1;if(D){const A=T.name.toLowerCase().includes(D),G=T.id.toString().includes(D),M=T.sprite_id.toString().includes(D);if(!A&&!G&&!M)return!1}return!0})},[o,h,v,P]),N=H.useMemo(()=>{if(_!=="weapons")return[];const D=new Map;for(const{entry:T,index:A}of k){const G=T.name.toLowerCase(),M=G.includes("left-hand")||G.includes("lefthand")||G.includes("left hand"),Z=G.includes("right-hand")||G.includes("righthand")||G.includes("right hand");if(!M&&!Z)continue;if(!D.has(T.id)){let he=T.name.replace(/left-hand|lefthand|left hand|right-hand|righthand|right hand/gi,"").replace(/\(|\)/g,"").trim();he||(he=`Item ${T.id}`),D.set(T.id,{itemId:T.id,baseName:he,leftEntry:null,rightEntry:null,otherEntries:[]})}const de=D.get(T.id);M&&!de.leftEntry?de.leftEntry={entry:T,index:A}:Z&&!de.rightEntry?de.rightEntry={entry:T,index:A}:de.otherEntries.push({entry:T,index:A})}return Array.from(D.values())},[k,_]);return n?u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 border-b border-emperia-border shrink-0",children:[u.jsxs("div",{className:"relative",children:[u.jsx("select",{value:h,onChange:D=>p(D.target.value),className:"appearance-none bg-emperia-bg border border-emperia-border rounded pl-2 pr-6 py-1 text-xs text-emperia-text cursor-pointer",children:y1.map(D=>u.jsx("option",{value:D.value,children:D.label},D.value))}),u.jsx(lc,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 text-emperia-muted pointer-events-none"})]}),u.jsxs("div",{className:"relative flex-1",children:[u.jsx(Ii,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3 h-3 text-emperia-muted"}),u.jsx("input",{type:"text",value:v,onChange:D=>S(D.target.value),placeholder:"Search by name, item ID, or sprite ID...",className:"w-full pl-7 pr-2 py-1 bg-emperia-bg border border-emperia-border rounded text-xs text-emperia-text"})]}),u.jsxs("div",{className:"flex items-center gap-0.5 border border-emperia-border rounded overflow-hidden",children:[u.jsx("button",{onClick:()=>E("list"),className:`px-2 py-1 text-[10px] ${_==="list"?"bg-emperia-accent/20 text-emperia-accent":"text-emperia-muted hover:text-emperia-text"}`,children:"List"}),u.jsx("button",{onClick:()=>E("weapons"),className:`px-2 py-1 text-[10px] ${_==="weapons"?"bg-emperia-accent/20 text-emperia-accent":"text-emperia-muted hover:text-emperia-text"}`,children:"Weapons"})]}),u.jsxs("button",{onClick:()=>w(!g),className:"flex items-center gap-1 px-2 py-1 rounded text-xs bg-emperia-accent/10 text-emperia-accent hover:bg-emperia-accent/20",children:[u.jsx(ys,{className:"w-3 h-3"}),"Add"]}),u.jsxs("span",{className:"text-[10px] text-emperia-muted shrink-0",children:[k.length," / ",o.length]})]}),g&&u.jsx(k1,{onAdd:D=>{d(D),w(!1)},onCancel:()=>w(!1)}),u.jsx("div",{className:"flex-1 overflow-y-auto",children:_==="list"?k.length===0?u.jsx("p",{className:"text-center text-emperia-muted text-xs py-8",children:"No entries match the current filter."}):k.map(({entry:D,index:T})=>u.jsx(S1,{entry:D,index:T,onUpdate:l,onRemove:m},`${T}-${D.id}-${D.sprite_id}`)):N.length===0?u.jsx("p",{className:"text-center text-emperia-muted text-xs py-8",children:"No weapon entries with left/right hand variants found."}):N.map(D=>u.jsx(_1,{group:D,onUpdate:l,onRemove:m},D.itemId))})]}):u.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-emperia-muted text-sm p-8 gap-3",children:[u.jsx("p",{children:"No equipment sprite map loaded."}),u.jsxs("p",{className:"text-[10px] text-emperia-muted/50",children:["Drop an ",u.jsx("code",{className:"text-emperia-accent",children:"item-to-sprite.json"})," file or open a folder containing one."]})]})}const Sh=[{flag:qr.Human,label:"Human"},{flag:qr.Demon,label:"Demon"},{flag:qr.Orc,label:"Orc"}],_h=[{flag:gs.Male,label:"Male"},{flag:gs.Female,label:"Female"}],Ch=[{flag:xs.Free,label:"Free"},{flag:xs.Noble,label:"Noble"}],E1={all:0,human:qr.Human,demon:qr.Demon,orc:qr.Orc},N1={all:0,male:gs.Male,female:gs.Female},D1={all:0,free:xs.Free,noble:xs.Noble};function kf(o,n,i,a,l,d,m,h){return(((((n*o.patternZ+l)*o.patternY+a)*o.patternX+i)*o.layers+d)*o.height+h)*o.width+m}const rc=new Map,Eh=134;function Go(o,n,i,a,l,d,m){const h=n.things.get(l);if(!h)return;const p=h.frameGroups[0];if(!p||p.sprites.length===0)return;const v=Math.min(d,p.patternX-1),S=p.layers>=2;for(let g=0;g<p.height;g++)for(let w=0;w<p.width;w++){const _=kf(p,0,v,0,0,0,w,g);if(_>=p.sprites.length)continue;const E=p.sprites[_];if(E<=0)continue;const P=a.get(E)??mn(i,E);if(!P)continue;const k=new ImageData(new Uint8ClampedArray(P.data),32,32);if(S){const A=kf(p,0,v,0,0,1,w,g);if(A<p.sprites.length){const G=p.sprites[A];if(G>0){const M=a.get(G)??mn(i,G);M&&zo(k,M,m)}}}const N=(p.width-1-w)*32,D=(p.height-1-g)*32,T=document.createElement("canvas");T.width=32,T.height=32,T.getContext("2d").putImageData(k,0,0),o.drawImage(T,N,D)}}function ic(o,n,i,a,l,d=2){const m=`hair-comp:${a}:${l}:${d}`,h=rc.get(m);if(h)return h;const p=o.itemCount+l,v=o.things.get(p),S=v==null?void 0:v.frameGroups[0],g=S?S.width*32:64,w=S?S.height*32:64,_=document.createElement("canvas");_.width=g,_.height=w;const E=_.getContext("2d");E.clearRect(0,0,g,w);const P={head:0,body:0,legs:0,feet:0};if(Go(E,o,n,i,p,d,P),a>0){const N=o.itemCount+a;Go(E,o,n,i,N,d,P)}const k=_.toDataURL();return rc.set(m,k),k}function j1({outfitDisplayId:o,size:n=40,showBase:i=!1}){const a=I(p=>p.objectData),l=I(p=>p.spriteData),d=I(p=>p.spriteOverrides),m=I(p=>p.editVersion);if(H.useEffect(()=>{rc.clear()},[m]),!a||!l||o<=0)return u.jsx("div",{className:"checkerboard rounded border border-emperia-border/50 flex items-center justify-center text-emperia-muted/30 text-[9px]",style:{width:n,height:n},children:""});const h=i?ic(a,l,d,o,Eh,2):ic(a,l,d,o,0,2);return u.jsx("div",{className:"checkerboard rounded border border-emperia-border/50 overflow-hidden flex items-center justify-center",style:{width:n,height:n},children:h?u.jsx("img",{src:h,alt:`outfit#${o}`,className:"pixelated max-w-full max-h-full",style:{imageRendering:"pixelated"},draggable:!1}):u.jsx("div",{className:"flex items-center justify-center text-emperia-muted/30 text-[9px]",style:{width:n,height:n},children:"?"})})}function Ul({label:o,options:n,value:i,onChange:a}){return u.jsxs("div",{children:[u.jsx("label",{className:"text-[10px] text-emperia-muted block mb-1",children:o}),u.jsx("div",{className:"flex flex-wrap gap-1.5",children:n.map(l=>{const d=(i&l.flag)!==0;return u.jsx("button",{onClick:()=>a(d?i&~l.flag:i|l.flag),className:`px-2 py-0.5 rounded text-[10px] font-medium border transition-colors ${d?"bg-emperia-accent/20 border-emperia-accent/40 text-emperia-accent":"bg-emperia-bg border-emperia-border text-emperia-muted/60 hover:text-emperia-muted"}`,children:l.label},l.flag)})})]})}function A1({hair:o}){const n=[],i=[],a=[];for(const l of Sh)o.races&l.flag&&n.push(l.label);for(const l of _h)o.genders&l.flag&&i.push(l.label);if(o.tiers!==ac)for(const l of Ch)o.tiers&l.flag&&a.push(l.label);return u.jsxs("div",{className:"flex flex-wrap items-center gap-0.5",children:[i.map(l=>u.jsx("span",{className:"px-1 py-px rounded text-[8px] font-medium text-pink-400/80 bg-pink-400/10",children:l},`g-${l}`)),n.length>0&&i.length>0&&u.jsx("span",{className:"w-px h-2.5 bg-emperia-border/50 mx-0.5"}),n.map(l=>u.jsx("span",{className:"px-1 py-px rounded text-[8px] font-medium text-cyan-400/80 bg-cyan-400/10",children:l},`r-${l}`)),a.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"w-px h-2.5 bg-emperia-border/50 mx-0.5"}),a.map(l=>u.jsx("span",{className:"px-1 py-px rounded text-[8px] font-medium text-amber-400/80 bg-amber-400/10",children:l},`t-${l}`))]})]})}function I1({onSelect:o,onClose:n}){const i=I(g=>g.objectData),a=I(g=>g.spriteData),l=I(g=>g.spriteOverrides),d=I(g=>g.getCategoryRange),[m,h]=H.useState(""),p=H.useRef(null),v=d("outfit"),S=H.useMemo(()=>{if(!i||!v)return[];const g=m.trim().toLowerCase(),w=[];for(let _=v.start;_<=v.end;_++){if(!i.things.get(_))continue;const P=Hn(i,_);g&&!P.toString().includes(g)||w.push({id:_,displayId:P})}return w},[i,v,m]);return H.useEffect(()=>{const g=w=>{p.current&&!p.current.contains(w.target)&&n()};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[n]),u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",children:u.jsxs("div",{ref:p,className:"bg-emperia-surface border border-emperia-border rounded-lg shadow-2xl w-[520px] max-h-[80vh] flex flex-col",children:[u.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b border-emperia-border shrink-0",children:[u.jsx("h3",{className:"text-sm font-semibold text-emperia-text flex-1",children:"Select Hair Outfit Sprite"}),u.jsx("button",{onClick:n,className:"p-1 rounded hover:bg-emperia-hover text-emperia-muted hover:text-emperia-text text-xs",children:"Close"})]}),u.jsx("div",{className:"px-3 py-1.5 border-b border-emperia-border shrink-0",children:u.jsxs("div",{className:"relative",children:[u.jsx(Ii,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3 h-3 text-emperia-muted"}),u.jsx("input",{type:"text",value:m,onChange:g=>h(g.target.value),placeholder:"Search outfit ID...",className:"w-full pl-7 pr-2 py-1 bg-emperia-bg border border-emperia-border rounded text-xs text-emperia-text",autoFocus:!0})]})}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-2",children:[u.jsx("div",{className:"grid grid-cols-8 gap-1",children:S.map(({id:g,displayId:w})=>{if(!i||!a)return null;const _=ic(i,a,l,w,0,2);return u.jsxs("button",{onClick:()=>o(w),className:"flex flex-col items-center gap-0.5 p-1 rounded hover:bg-emperia-hover border border-transparent hover:border-emperia-accent/40 transition-colors",title:`Outfit #${w}`,children:[u.jsx("div",{className:"w-10 h-10 checkerboard rounded flex items-center justify-center overflow-hidden",children:_?u.jsx("img",{src:_,alt:"",className:"pixelated max-w-full max-h-full",style:{imageRendering:"pixelated"},draggable:!1}):u.jsx("div",{className:"w-10 h-10 bg-emperia-bg/50 rounded"})}),u.jsx("span",{className:"text-[9px] text-emperia-muted",children:w})]},g)})}),S.length===0&&u.jsx("p",{className:"text-center text-emperia-muted text-xs py-8",children:"No outfits found."})]})]})})}function T1({outfitDisplayId:o}){const n=I(g=>g.objectData),i=I(g=>g.spriteData),a=I(g=>g.spriteOverrides),l=I(g=>g.editVersion),d=H.useRef(null),[m,h]=H.useState(4);H.useEffect(()=>{const g=d.current;if(!g||!n||!i)return;const w=n.itemCount+Eh,_=n.things.get(w),E=_==null?void 0:_.frameGroups[0],P=E?E.width*32:64,k=E?E.height*32:64;g.width=P,g.height=k;const N=g.getContext("2d");N.clearRect(0,0,P,k);const D={head:0,body:0,legs:0,feet:0};if(Go(N,n,i,a,w,2,D),o>0){const T=n.itemCount+o;Go(N,n,i,a,T,2,D)}},[o,n,i,a,l]);const p=d.current,v=(p==null?void 0:p.width)??64,S=(p==null?void 0:p.height)??64;return u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsxs("div",{className:"flex items-center gap-3 px-1",children:[u.jsx("span",{className:"text-[10px] text-emperia-muted",children:"Zoom:"}),u.jsx("input",{type:"range",min:1,max:8,value:m,onChange:g=>h(Number(g.target.value)),className:"flex-1 h-1 accent-emperia-accent"}),u.jsxs("span",{className:"text-[10px] text-emperia-muted w-6 text-right",children:[m,"x"]})]}),u.jsx("div",{className:"flex items-center justify-center overflow-auto",children:u.jsx("div",{className:"checkerboard rounded-lg border border-emperia-border",style:{padding:8},children:u.jsx("canvas",{ref:d,style:{width:v*m,height:S*m,imageRendering:"pixelated"}})})})]})}function L1({hair:o}){const n=I(h=>h.updateHairDefinition),i=I(h=>h.removeHairDefinition),a=I(h=>h.duplicateHairDefinition),[l,d]=H.useState(!1),m=H.useCallback(h=>{n(o.hairId,h)},[o.hairId,n]);return u.jsxs("div",{className:"p-3 flex flex-col gap-3",children:[u.jsx(T1,{outfitDisplayId:o.outfitId}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-sm font-semibold text-emperia-text",children:o.name}),u.jsxs("div",{className:"text-[10px] text-emperia-muted",children:["Hair #",o.hairId,"  Outfit #",o.outfitId]})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{onClick:()=>a(o.hairId),className:"p-1.5 rounded text-emperia-muted hover:text-emperia-accent hover:bg-emperia-hover",title:"Duplicate",children:u.jsx(jf,{className:"w-3.5 h-3.5"})}),u.jsx("button",{onClick:()=>i(o.hairId),className:"p-1.5 rounded text-red-400/50 hover:text-red-400 hover:bg-red-400/10",title:"Delete",children:u.jsx(Di,{className:"w-3.5 h-3.5"})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-[10px] text-emperia-muted block mb-1",children:"Name"}),u.jsx("input",{type:"text",value:o.name,onChange:h=>m({name:h.target.value}),className:"w-full bg-emperia-bg border border-emperia-border rounded px-2 py-1 text-xs text-emperia-text"})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"text-[10px] text-emperia-muted block mb-1",children:"Hair ID"}),u.jsx("input",{type:"number",value:o.hairId,readOnly:!0,className:"w-full bg-emperia-bg/50 border border-emperia-border/50 rounded px-2 py-1 text-xs text-emperia-muted cursor-not-allowed",title:"Hair ID is immutable after creation"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"text-[10px] text-emperia-muted block mb-1",children:"Outfit ID"}),u.jsxs("div",{className:"flex gap-1",children:[u.jsx("input",{type:"number",value:o.outfitId,onChange:h=>{const p=parseInt(h.target.value,10);!isNaN(p)&&p>=0&&m({outfitId:p})},className:"flex-1 bg-emperia-bg border border-emperia-border rounded px-2 py-1 text-xs text-emperia-text"}),u.jsx("button",{onClick:()=>d(!0),className:"px-2 py-1 rounded text-[10px] bg-emperia-accent/10 text-emperia-accent hover:bg-emperia-accent/20 border border-emperia-border whitespace-nowrap",children:"Pick"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-[10px] text-emperia-muted block mb-1",children:"Sort Order"}),u.jsx("input",{type:"number",value:o.sortOrder,onChange:h=>{const p=parseInt(h.target.value,10);isNaN(p)||m({sortOrder:p})},className:"w-24 bg-emperia-bg border border-emperia-border rounded px-2 py-1 text-xs text-emperia-text"})]}),u.jsx("div",{className:"w-full h-px bg-emperia-border"}),u.jsx(Ul,{label:"Races",options:Sh,value:o.races,onChange:h=>m({races:h||1})}),u.jsx(Ul,{label:"Gender",options:_h,value:o.genders,onChange:h=>m({genders:h||1})}),u.jsx(Ul,{label:"Account Tier",options:Ch,value:o.tiers,onChange:h=>m({tiers:h||1})}),o.outfitId<=0&&u.jsx("p",{className:"text-[10px] text-amber-400 bg-amber-400/10 rounded px-2 py-1",children:"Outfit ID must be a positive number."}),!o.name.trim()&&u.jsx("p",{className:"text-[10px] text-amber-400 bg-amber-400/10 rounded px-2 py-1",children:"Name is required."}),l&&u.jsx(I1,{onSelect:h=>{m({outfitId:h}),d(!1)},onClose:()=>d(!1)})]})}function B1(){const o=I(k=>k.hairDefinitions),n=I(k=>k.hairDefsLoaded),i=I(k=>k.selectedHairId),a=I(k=>k.setSelectedHairId),l=I(k=>k.addHairDefinition);I(k=>k.editVersion);const[d,m]=H.useState(""),[h,p]=H.useState("all"),[v,S]=H.useState("all"),[g,w]=H.useState("all"),_=H.useMemo(()=>{const k=d.trim().toLowerCase(),N=E1[h],D=N1[v],T=D1[g];return o.filter(A=>!(k&&!A.name.toLowerCase().includes(k)&&!A.hairId.toString().includes(k)&&!A.outfitId.toString().includes(k)||N&&!(A.races&N)||D&&!(A.genders&D)||T&&!(A.tiers&T)))},[o,d,h,v,g]),E=H.useMemo(()=>o.find(k=>k.hairId===i)??null,[o,i]),P=H.useCallback(()=>{const k=new Set(o.map(D=>D.hairId));let N=1;for(;k.has(N);)N++;l({hairId:N,name:`New Hair ${N}`,outfitId:0,races:Cf,genders:Ef,tiers:ac,sortOrder:o.length})},[o,l]);return n?u.jsxs("div",{className:"flex h-full",children:[u.jsxs("div",{className:"w-72 border-r border-emperia-border flex flex-col shrink-0",children:[u.jsxs("div",{className:"flex flex-col gap-1.5 px-2 py-1.5 border-b border-emperia-border shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx(Ii,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3 h-3 text-emperia-muted"}),u.jsx("input",{type:"text",value:d,onChange:k=>m(k.target.value),placeholder:"Search...",className:"w-full pl-7 pr-2 py-1 bg-emperia-bg border border-emperia-border rounded text-xs text-emperia-text"})]}),u.jsxs("button",{onClick:P,className:"flex items-center gap-1 px-2 py-1 rounded text-xs bg-emperia-accent/10 text-emperia-accent hover:bg-emperia-accent/20 shrink-0",children:[u.jsx(ys,{className:"w-3 h-3"})," Add"]})]}),u.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[u.jsx(zl,{label:"Race",value:h,onChange:k=>p(k),options:[{value:"all",label:"All Races"},{value:"human",label:"Human"},{value:"demon",label:"Demon"},{value:"orc",label:"Orc"}]}),u.jsx(zl,{label:"Gender",value:v,onChange:k=>S(k),options:[{value:"all",label:"All"},{value:"male",label:"Male"},{value:"female",label:"Female"}]}),u.jsx(zl,{label:"Tier",value:g,onChange:k=>w(k),options:[{value:"all",label:"All"},{value:"free",label:"Free"},{value:"noble",label:"Noble"}]}),u.jsxs("span",{className:"text-[10px] text-emperia-muted ml-auto shrink-0",children:[_.length,"/",o.length]})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto",children:_.length===0?u.jsx("p",{className:"text-center text-emperia-muted text-xs py-8",children:"No entries match filters."}):_.map(k=>u.jsxs("button",{onClick:()=>a(k.hairId),className:`w-full flex items-center gap-2 px-2 py-1.5 text-left border-b border-emperia-border/30 transition-colors ${k.hairId===i?"bg-emperia-accent/10":"hover:bg-emperia-hover/50"}`,children:[u.jsx(j1,{outfitDisplayId:k.outfitId,size:32,showBase:!0}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-xs text-emperia-text truncate",children:k.name}),u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsxs("span",{className:"text-[9px] text-emperia-muted font-mono",children:["#",k.hairId]}),u.jsx(A1,{hair:k})]})]})]},k.hairId))})]}),u.jsx("div",{className:"flex-1 overflow-y-auto",children:E?u.jsx(L1,{hair:E},E.hairId):u.jsx("div",{className:"flex items-center justify-center h-full text-emperia-muted text-xs",children:"Select a hair entry from the list."})})]}):u.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-emperia-muted text-sm p-8 gap-3",children:[u.jsx("p",{children:"No hair definitions loaded."}),u.jsxs("p",{className:"text-[10px] text-emperia-muted/50",children:["Drop a ",u.jsx("code",{className:"text-emperia-accent",children:"hair-definitions.json"})," file or open a folder containing one."]}),u.jsxs("button",{onClick:P,className:"flex items-center gap-1.5 px-3 py-1.5 rounded text-xs bg-emperia-accent/10 text-emperia-accent hover:bg-emperia-accent/20 border border-emperia-accent/30",children:[u.jsx(ys,{className:"w-3 h-3"}),"Create First Hair"]})]})}function zl({label:o,value:n,onChange:i,options:a}){return u.jsxs("div",{className:"relative",children:[u.jsx("select",{value:n,onChange:l=>i(l.target.value),className:"appearance-none bg-emperia-bg border border-emperia-border rounded pl-1.5 pr-5 py-0.5 text-[10px] text-emperia-text cursor-pointer",children:a.map(l=>u.jsx("option",{value:l.value,children:l.label},l.value))}),u.jsx(lc,{className:"absolute right-1 top-1/2 -translate-y-1/2 w-2.5 h-2.5 text-emperia-muted pointer-events-none"})]})}const F1={texture:"Texture",properties:"Properties",attributes:"Attributes",server:"Server",equipment:"Equipment",hair:"Hair"};function P1(){const o=I(m=>m.selectedThingId),n=I(m=>m.objectData),i=I(m=>m.clientToServerIds);I(m=>m.editVersion);const a=o!=null?(n==null?void 0:n.things.get(o))??null:null;if(!a||!n)return null;const l=Hn(n,a.id),d=i.get(a.id);return u.jsxs("div",{className:"flex items-center gap-3 text-[11px] font-mono",children:[u.jsxs("span",{className:"flex items-center gap-1.5",children:[u.jsx("span",{className:"text-emperia-muted",children:"Client"}),u.jsx("span",{className:"text-cyan-400 font-semibold",children:l})]}),d!=null&&u.jsxs("span",{className:"flex items-center gap-1.5",children:[u.jsx("span",{className:"text-emperia-muted",children:"Server"}),u.jsx("span",{className:"text-amber-400 font-semibold",children:d})]}),u.jsx("span",{className:"text-emperia-muted/60 capitalize text-[10px]",children:a.category})]})}function M1(){const o=I(a=>a.loaded),n=I(a=>a.centerTab),i=I(a=>a.setCenterTab);return o?u.jsxs("div",{className:"h-full flex flex-col",children:[u.jsx(V0,{}),u.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[u.jsxs("div",{className:"w-64 flex flex-col border-r border-emperia-border bg-emperia-bg",children:[u.jsx(J0,{}),u.jsx(eg,{})]}),u.jsxs("div",{className:"flex-1 flex flex-col bg-emperia-bg overflow-hidden",children:[u.jsxs("div",{className:"flex items-center border-b border-emperia-border shrink-0",children:[["texture","properties","attributes","server","equipment","hair"].map(a=>u.jsx("button",{onClick:()=>i(a),className:`px-4 py-2 text-xs font-medium transition-colors
                  ${n===a?"text-emperia-accent border-b-2 border-emperia-accent":"text-emperia-muted hover:text-emperia-text"}
                `,children:F1[a]},a)),u.jsx("div",{className:"flex-1"}),u.jsx("div",{className:"pr-3",children:u.jsx(P1,{})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto",children:[n==="texture"&&u.jsx(Zg,{}),n==="properties"&&u.jsx(mf,{}),n==="attributes"&&u.jsx(mf,{showAttributesOnly:!0}),n==="server"&&u.jsx(x1,{}),n==="equipment"&&u.jsx(C1,{}),n==="hair"&&u.jsx(B1,{})]})]}),u.jsxs("div",{className:"w-[260px] border-l border-emperia-border bg-emperia-bg overflow-y-auto flex flex-col",children:[u.jsx(t1,{}),u.jsx(n1,{})]}),u.jsx("div",{className:"w-72 border-l border-emperia-border bg-emperia-bg overflow-hidden flex flex-col",children:u.jsx(e1,{})})]})]}):u.jsx(E0,{})}_m.createRoot(document.getElementById("root")).render(u.jsx(hs.StrictMode,{children:u.jsx(M1,{})}));
